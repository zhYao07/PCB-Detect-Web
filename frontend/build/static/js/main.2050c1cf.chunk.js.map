{"version":3,"sources":["components/Login.js","App.js","index.js"],"names":["TabPane","Tabs","Login","_ref","onLoginSuccess","activeTab","setActiveTab","useState","loading","setLoading","loginForm","Form","useForm","registerForm","useEffect","resetFields","_jsx","className","style","backgroundImage","backgroundRepeat","backgroundPosition","backgroundSize","children","_jsxs","activeKey","onChange","centered","tab","SafetyOutlined","form","name","onFinish","async","data","axios","post","values","status","message","success","localStorage","setItem","token","JSON","stringify","user","error","_error$response","_error$response$data","errMsg","response","layout","size","Item","rules","required","Input","prefix","UserOutlined","placeholder","suffix","Tooltip","title","InfoCircleOutlined","color","Password","LockOutlined","Button","type","htmlType","block","username","password","email","phone","setFieldsValue","_error$response2","_error$response2$data","MailOutlined","pattern","PhoneOutlined","min","dependencies","_ref2","getFieldValue","validator","_","value","Promise","reject","Error","resolve","API_BASE_URL","hostname","window","location","protocol","defaults","baseURL","withCredentials","Header","Sider","Content","Layout","App","systemStatus","setSystemStatus","cpuUsage","memoryUsage","uptime","detectionResults","setDetectionResults","defects","statistics","defect_types","selectedImage","setSelectedImage","detectionProgress","setDetectionProgress","zoomLevel","setZoomLevel","imageList","setImageList","currentImageIndex","setCurrentImageIndex","isBatchProcessing","setIsBatchProcessing","batchProgress","setBatchProgress","showNavigation","setShowNavigation","detectionHistory","setDetectionHistory","previewUrls","setPreviewUrls","isUploading","setIsUploading","isDragging","setIsDragging","dragStart","setDragStart","x","y","imagePosition","setImagePosition","scale","setScale","position","setPosition","imageWrapperRef","useRef","isPaused","setIsPaused","defectFilter","setDefectFilter","processedResults","setProcessedResults","defectTypes","setDefectTypes","isPausedRef","isCameraActive","setIsCameraActive","videoStream","setVideoStream","videoRef","isCapturing","setIsCapturing","captureInterval","setCaptureInterval","currentRunTime","setCurrentRunTime","runTimeInterval","setRunTimeInterval","defectsListRef","defectsListHover","setDefectsListHover","isLoggedIn","setIsLoggedIn","currentUser","setCurrentUser","imageDimensions","setImageDimensions","startTimeRef","fetchSystemStatus","get","cpu_usage","memory_usage","server_ip","ip","newBaseUrl","console","log","updateApiBaseUrl","statusInterval","setInterval","clearInterval","current","srcObject","play","then","catch","err","forEach","url","URL","revokeObjectURL","getTracks","track","stop","getItem","parse","resetImageAndDetectionStates","e","toggleContinuousCapture","setStartTime","setEndTime","end","Date","now","finalDuration","Math","floor","hours","minutes","info","warning","paused","ended","start","timeInterval","duration","readyState","interval","warn","playErr","capturedFrame","captureVideoFrame","videoWidth","videoHeight","newWidth","newHeight","round","captureCanvas","document","createElement","width","height","getContext","drawImage","scaleCanvas","toBlob","blob","file","File","toLocaleTimeString","result","processImage","length","resetAllStates","filterDefects","filterType","filtered","filter","defect","toLowerCase","types","includes","push","getDefectColor","defectType","renderBoundingBoxes","videoPosition","left","top","scaleFactor","videoElement","videoRect","getComputedStyle","getBoundingClientRect","parentRect","parentElement","scaleX","scaleY","imageSize","boxOffset","map","index","bbox","x1","y1","x2","y2","offsetX","offsetY","wrapperRect","containerW","containerH","imgW","imgH","imgRatio","contentW","contentH","border","backgroundColor","pointerEvents","zIndex","background","padding","fontSize","whiteSpace","confidence","boxWidth","boxHeight","handleImageUpload","img","Image","onload","canvas","resizedFile","imageUrl","createObjectURL","onerror","src","debouncedHandleFolderUpload","debounce","func","delay","debounceTimer","_len","arguments","args","Array","_key","context","this","clearTimeout","setTimeout","apply","fileList","newFiles","fileObj","originFileObj","startsWith","urls","resetImagePosition","handleImageChange","selectedModel","setSelectedModel","iouThreshold","setIouThreshold","confThreshold","setConfThreshold","formData","FormData","append","params","vote_threshold","orientation_count","iou_threshold","conf_threshold","img_width","img_height","startTime","endTime","handleImageScrolling","targetElement","target","isInsideImageWrapper","preventDefault","addEventListener","passive","removeEventListener","body","overflow","documentElement","handleMouseLeave","handleLoginSuccess","resizeObserver","ResizeObserver","observe","disconnect","alt","SettingOutlined","BulbOutlined","onClick","handleLogout","removeItem","cursor","display","gap","minWidth","newPauseState","history","i","checkPauseInterval","progress","icon","LoadingOutlined","SearchOutlined","alignItems","flexDirection","marginTop","borderRadius","textAlign","max","marginLeft","Progress","percent","showInfo","strokeColor","justifyContent","calculateUptime","Upload","accept","showUploadList","beforeUpload","disabled","UploadOutlined","directory","multiple","FolderOutlined","VideoCameraOutlined","CameraOutlined","navigator","mediaDevices","getUserMedia","stream","video","ideal","showDirectoryPicker","directoryHandle","annotatedImagesFolder","getDirectoryHandle","create","jsonFolder","_detectionHistory$i2","_detectionHistory$i2$","_detectionHistory$i3","_detectionHistory$i3$","imageName","split","slice","join","annotatedImageName","annotatedImageHandle","getFileHandle","writableStream","createWritable","image","_detectionHistory$i","_detectionHistory$i$r","strokeStyle","lineWidth","strokeRect","fillStyle","font","fillText","write","close","jsonFileName","jsonFileHandle","jsonWritableStream","jsonResult","FileTextOutlined","handleExportReport","reportContainer","appendChild","dateStr","toLocaleDateString","timeStr","batchStatistics","totalImages","totalDefects","defectTypeCounts","imagesWithDefects","averageDefectsPerImage","toFixed","batchStatsRows","Object","entries","count","percentage","currentImageDefectsRows","positionStr","innerHTML","html2canvasModule","html2canvas","default","useCORS","logging","jsPdfModule","jsPDF","imgData","toDataURL","pdf","orientation","unit","format","imgHeight","heightLeft","addImage","addPage","filename","getTime","save","removeChild","destroy","querySelector","onMouseEnter","onMouseLeave","_imageWrapperRef$curr2","imgRect","clientX","right","clientY","bottom","ref","autoPlay","playsInline","muted","objectFit","_Fragment","onMouseDown","button","onMouseMove","newX","newY","maxOffset","boundedX","boundedY","onMouseUp","handleMouseUp","onWheel","_imageWrapperRef$curr","delta","deltaY","newScale","rect","mouseX","mouseY","centerX","centerY","scaleChange","newPosition","maxWidth","maxHeight","transform","transformOrigin","transition","userSelect","draggable","LeftOutlined","handlePrevImage","RightOutlined","handleNextImage","onDrop","dataTransfer","files","marginBottom","flex","fontWeight","Pagination","total","pageSize","page","showQuickJumper","showSizeChanger","Select","Option","minHeight","keys","ReactECharts","option","getChartOption","_detectionResults$sta","tooltip","trigger","legend","show","series","defectNames","colors","colorKey","formatter","orient","itemGap","radius","center","label","alignTo","margin","lineHeight","rich","b","align","labelLine","length2","minTurnAngle","maxSurfaceAngle","emphasis","itemStyle","shadowBlur","shadowOffsetX","shadowColor","notMerge","InputNumber","step","controls","newValue","parseFloat","Slider","ReactDOM","render","React","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.2050c1cf.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Form, Input, Button, message, Tabs, Tooltip } from 'antd';\nimport { UserOutlined, LockOutlined, MailOutlined, PhoneOutlined, SafetyOutlined, InfoCircleOutlined } from '@ant-design/icons';\nimport './Login.css';\nimport axios from 'axios';\n\nconst { TabPane } = Tabs;\n\n// Remove mock user data; use backend APIs for auth\n\nconst Login = ({ onLoginSuccess }) => {\n      const [activeTab, setActiveTab] = useState('login');\n      const [loading, setLoading] = useState(false);\n      // Create separate form instances for login and register\n      const [loginForm] = Form.useForm();\n      const [registerForm] = Form.useForm();\n\n      // Reset form fields when switching tabs\n      useEffect(() => {\n            if (activeTab === 'login') {\n                  loginForm.resetFields();\n            } else {\n                  registerForm.resetFields();\n            }\n      }, [activeTab, loginForm, registerForm]);\n\n      // 使用本地图片\n      const pcbBackgroundUrl = '/output.png';\n\n      // Real backend login\n      const handleLogin = async (values) => {\n            setLoading(true);\n            try {\n                  const response = await axios.post('http://localhost:5000/api/login', values);\n                  const data = response.data;\n                  if (data.status === 'success') {\n                        message.success('登录成功！');\n                        localStorage.setItem('token', data.token);\n                        localStorage.setItem('user', JSON.stringify(data.user));\n                        onLoginSuccess(data.user);\n                  } else {\n                        message.error(data.error || '登录失败');\n                  }\n            } catch (error) {\n                  const errMsg = error.response?.data?.error || '登录失败，请重试';\n                  message.error(errMsg);\n            } finally {\n                  setLoading(false);\n            }\n      };\n\n      // Real backend registration\n      const handleRegister = async (values) => {\n            setLoading(true);\n            try {\n                  // 调用注册接口\n                  await axios.post('http://localhost:5000/api/register', {\n                        username: values.username,\n                        password: values.password,\n                        email: values.email,\n                        phone: values.phone\n                  });\n                  // 注册成功后跳转到登录标签\n                  message.success('注册成功！请登录');\n                  setActiveTab('login');\n                  // 在切换到登录标签后，预填充表单字段\n                  loginForm.setFieldsValue({ username: values.username, password: values.password });\n            } catch (error) {\n                  const errMsg = error.response?.data?.error || '注册失败，请重试';\n                  message.error(errMsg);\n            } finally {\n                  setLoading(false);\n            }\n      };\n\n      return (\n            <div className=\"login-container\" style={{\n                  backgroundImage: `url(${pcbBackgroundUrl})`,\n                  backgroundRepeat: 'no-repeat',\n                  backgroundPosition: 'center center',\n                  backgroundSize: 'cover'\n            }}>\n                  <div className=\"login-content\">\n                        <div className=\"login-header\">\n                              <h1>欢迎使用慧眼识瑕系统</h1>\n                              <p className=\"login-subtitle\">基于YOLOv11和投票融合的PCB缺陷检测系统</p>\n                        </div>\n\n                        <div className=\"login-box\">\n                              <div className=\"light-effect\"></div>\n                              <div className=\"light-effect\"></div>\n\n                              <Tabs activeKey={activeTab} onChange={setActiveTab} centered className=\"login-tabs\">\n                                    <TabPane tab=\"登录\" key=\"login\">\n                                          <div className=\"login-welcome\">\n                                                <SafetyOutlined className=\"login-welcome-icon\" />\n                                                <p>请输入您的账号信息，安全登录系统</p>\n                                          </div>\n                                          <Form\n                                                form={loginForm}\n                                                name=\"login\"\n                                                onFinish={handleLogin}\n                                                layout=\"vertical\"\n                                                size=\"large\"\n                                          >\n                                                <Form.Item\n                                                      name=\"username\"\n                                                      rules={[{ required: true, message: '请输入用户名' }]}\n                                                >\n                                                      <Input\n                                                            prefix={<UserOutlined />}\n                                                            placeholder=\"用户名\"\n                                                            suffix={\n                                                                  <Tooltip title=\"支持字母、数字和下划线组合\">\n                                                                        <InfoCircleOutlined style={{ color: 'rgba(0,0,0,.45)' }} />\n                                                                  </Tooltip>\n                                                            }\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"password\"\n                                                      rules={[{ required: true, message: '请输入密码' }]}\n                                                >\n                                                      <Input.Password\n                                                            prefix={<LockOutlined />}\n                                                            placeholder=\"密码\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item>\n                                                      <Button\n                                                            type=\"primary\"\n                                                            htmlType=\"submit\"\n                                                            block\n                                                            loading={loading}\n                                                            className=\"login-button\"\n                                                      >\n                                                            登录\n                                                      </Button>\n                                                </Form.Item>\n                                          </Form>\n                                    </TabPane>\n                                    <TabPane tab=\"注册\" key=\"register\">\n                                          <div className=\"login-welcome\">\n                                                <UserOutlined className=\"login-welcome-icon\" style={{ color: '#1890ff' }} />\n                                                <p>欢迎注册，请填写以下信息</p>\n                                          </div>\n                                          <Form\n                                                form={registerForm}\n                                                name=\"register\"\n                                                onFinish={handleRegister}\n                                                layout=\"vertical\"\n                                                size=\"large\"\n                                          >\n                                                <Form.Item\n                                                      name=\"username\"\n                                                      rules={[{ required: true, message: '请输入用户名' }]}\n                                                >\n                                                      <Input\n                                                            prefix={<UserOutlined />}\n                                                            placeholder=\"用户名\"\n                                                            suffix={\n                                                                  <Tooltip title=\"支持字母、数字和下划线组合\">\n                                                                        <InfoCircleOutlined style={{ color: 'rgba(0,0,0,.45)' }} />\n                                                                  </Tooltip>\n                                                            }\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"email\"\n                                                      rules={[\n                                                            { required: true, message: '请输入邮箱' },\n                                                            { type: 'email', message: '请输入有效的邮箱地址' }\n                                                      ]}\n                                                >\n                                                      <Input\n                                                            prefix={<MailOutlined />}\n                                                            placeholder=\"邮箱\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"phone\"\n                                                      rules={[\n                                                            { required: true, message: '请输入手机号' },\n                                                            { pattern: /^1[3-9]\\d{9}$/, message: '请输入有效的手机号' }\n                                                      ]}\n                                                >\n                                                      <Input\n                                                            prefix={<PhoneOutlined />}\n                                                            placeholder=\"手机号\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"password\"\n                                                      rules={[\n                                                            { required: true, message: '请输入密码' },\n                                                            { min: 6, message: '密码长度至少为6位' }\n                                                      ]}\n                                                >\n                                                      <Input.Password\n                                                            prefix={<LockOutlined />}\n                                                            placeholder=\"密码\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"confirmPassword\"\n                                                      dependencies={['password']}\n                                                      rules={[\n                                                            { required: true, message: '请确认密码' },\n                                                            ({ getFieldValue }) => ({\n                                                                  validator(_, value) {\n                                                                        if (!value || getFieldValue('password') === value) {\n                                                                              return Promise.resolve();\n                                                                        }\n                                                                        return Promise.reject(new Error('两次输入的密码不一致'));\n                                                                  },\n                                                            }),\n                                                      ]}\n                                                >\n                                                      <Input.Password\n                                                            prefix={<LockOutlined />}\n                                                            placeholder=\"确认密码\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item>\n                                                      <Button\n                                                            type=\"primary\"\n                                                            htmlType=\"submit\"\n                                                            block\n                                                            loading={loading}\n                                                            className=\"login-button\"\n                                                      >\n                                                            注册\n                                                      </Button>\n                                                </Form.Item>\n                                          </Form>\n                                    </TabPane>\n                              </Tabs>\n\n                              <div className=\"login-footer\">\n                                    <p>技术支持: <span>从零开始的代码生活</span></p>\n                                    <p>系统版本: <span>V2.3.1</span></p>\n                              </div>\n                        </div>\n                  </div>\n            </div>\n      );\n};\n\nexport default Login; ","import React, { useState, useEffect, useRef } from 'react';\nimport { Layout, Button, Card, Statistic, Progress, Tabs, Upload, message, Select, Slider, Pagination, InputNumber, Spin, Tooltip } from 'antd';\nimport { CameraOutlined, VideoCameraOutlined, UploadOutlined, ZoomInOutlined, ZoomOutOutlined, SettingOutlined, BulbOutlined, UserOutlined, SearchOutlined, FolderOutlined, LeftOutlined, RightOutlined, LoadingOutlined } from '@ant-design/icons';\nimport ReactECharts from 'echarts-for-react';\n// 在文件顶部添加图标导入\nimport { PlayCircleOutlined, PauseCircleOutlined, FileTextOutlined } from '@ant-design/icons';\nimport axios from 'axios';\nimport { jsPDF } from 'jspdf';\nimport 'jspdf-autotable';\nimport './App.css';\nimport Login from './components/Login';\n\n// 添加API基础URL配置\nconst API_BASE_URL = (() => {\n      const hostname = window.location.hostname;\n      const protocol = window.location.protocol;\n      // 如果是localhost，使用localhost:5000\n      if (hostname === 'localhost' || hostname === '127.0.0.1') {\n            return `${protocol}//localhost:5000`;\n      }\n      // 否则使用当前hostname:5000\n      return `${protocol}//${hostname}:5000`;\n})();\n\n// 配置axios默认值\naxios.defaults.baseURL = API_BASE_URL;\naxios.defaults.withCredentials = true; // 允许跨域请求携带凭证\n\n// 添加一个函数来更新API基础URL\nconst updateApiBaseUrl = (ip) => {\n      const newBaseUrl = `http://${ip}:5000`;\n      console.log(`更新API基础URL为: ${newBaseUrl}`);\n      axios.defaults.baseURL = newBaseUrl;\n};\n\nconst { Header, Sider, Content } = Layout;\nconst { TabPane } = Tabs;\n\nfunction App() {\n      const [systemStatus, setSystemStatus] = useState({\n            status: 'normal',\n            cpuUsage: 0,\n            memoryUsage: 0,\n            uptime: '0h 0m'\n      });\n\n      const [detectionResults, setDetectionResults] = useState({\n            defects: [],\n            statistics: {\n                  defect_types: {}\n            }\n      });\n\n      const [selectedImage, setSelectedImage] = useState(null);\n      const [loading, setLoading] = useState(false);\n      const [detectionProgress, setDetectionProgress] = useState(0);\n      const [zoomLevel, setZoomLevel] = useState(1);\n      const MIN_ZOOM = 0.5;\n      const MAX_ZOOM = 2;\n      const ZOOM_STEP = 0.1;\n\n      // 添加新的状态变量\n      const [imageList, setImageList] = useState([]); // 存储所有要处理的图片\n      const [currentImageIndex, setCurrentImageIndex] = useState(0); // 当前处理的图片索引\n      const [isBatchProcessing, setIsBatchProcessing] = useState(false); // 是否正在批量处理\n      const [batchProgress, setBatchProgress] = useState(0); // 批量处理进度\n      const [showNavigation, setShowNavigation] = useState(false);\n      const [detectionHistory, setDetectionHistory] = useState([]); // 存储所有图片的检测结果\n      const [previewUrls, setPreviewUrls] = useState([]); // 存储所有图片的URL\n      const [isUploading, setIsUploading] = useState(false);\n      const [isDragging, setIsDragging] = useState(false);\n      const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n      const [imagePosition, setImagePosition] = useState({ x: 0, y: 0 });\n      const [scale, setScale] = useState(1);\n      const [position, setPosition] = useState({ x: 0, y: 0 });\n      const imageWrapperRef = useRef(null);\n      const [isPaused, setIsPaused] = useState(false); // 是否暂停检测\n      // 添加缺陷过滤相关的状态变量\n      const [defectFilter, setDefectFilter] = useState('all');\n      const [processedResults, setProcessedResults] = useState([]);\n      const [defectTypes, setDefectTypes] = useState(['all', 'mouse_bite', 'open_circuit', 'short', 'spur', 'spurious_copper']);\n      const isPausedRef = useRef(false);\n\n      // 添加到其他state变量之后\n      const [isCameraActive, setIsCameraActive] = useState(false);\n      const [videoStream, setVideoStream] = useState(null);\n      const videoRef = useRef(null);\n      const [isCapturing, setIsCapturing] = useState(false);\n      const [captureInterval, setCaptureInterval] = useState(null);\n\n      const [currentRunTime, setCurrentRunTime] = useState('0秒');\n      const [runTimeInterval, setRunTimeInterval] = useState(null);\n\n      const prevOverflowStyle = useRef('');\n      // 添加一个防抖函数，确保同一时间只处理一次上传请求\n      const debounce = (func, delay) => {\n            let debounceTimer;\n            return function (...args) {\n                  const context = this;\n                  clearTimeout(debounceTimer);\n                  debounceTimer = setTimeout(() => func.apply(context, args), delay);\n            };\n      };\n\n      // 添加缺陷列表的ref\n      const defectsListRef = useRef(null);\n      // 添加一个标志控制缺陷列表是否可以滚动\n      const [defectsListHover, setDefectsListHover] = useState(false);\n\n      const [isLoggedIn, setIsLoggedIn] = useState(false);\n      const [currentUser, setCurrentUser] = useState(null);\n      // 添加图像尺寸状态\n      const [imageDimensions, setImageDimensions] = useState(null);\n\n      // Add this with the other refs near the top of the component\n      const startTimeRef = useRef(null);\n\n      useEffect(() => {\n            const fetchSystemStatus = async () => {\n                  try {\n                        const response = await axios.get('/api/system-status');\n                        setSystemStatus({\n                              status: response.data.status,\n                              cpuUsage: response.data.cpu_usage,\n                              memoryUsage: response.data.memory_usage,\n                              uptime: response.data.uptime\n                        });\n\n                        // 如果后端返回了服务器IP地址，并且不是localhost，则更新API基础URL\n                        if (response.data.server_ip && response.data.server_ip !== '127.0.0.1') {\n                              updateApiBaseUrl(response.data.server_ip);\n                        }\n                  } catch (error) {\n                        console.error('Error fetching system status:', error);\n                        message.error('系统状态更新失败');\n                  }\n            };\n\n            fetchSystemStatus();\n            const statusInterval = setInterval(fetchSystemStatus, 5000);\n            return () => clearInterval(statusInterval);\n      }, []);\n\n      useEffect(() => {\n            isPausedRef.current = isPaused;\n      }, [isPaused]);\n\n      useEffect(() => {\n            if (videoRef.current && videoStream) {\n                  console.log('videoStream变化，设置视频源...');\n                  videoRef.current.srcObject = videoStream;\n                  videoRef.current.play()\n                        .then(() => console.log('视频播放成功 [useEffect]'))\n                        .catch(err => {\n                              console.error('视频播放失败 [useEffect]:', err);\n                              message.error('视频播放失败: ' + err.message);\n                        });\n            }\n      }, [videoStream]);\n\n      // 添加useEffect清理资源\n      useEffect(() => {\n            return () => {\n                  previewUrls.forEach(url => URL.revokeObjectURL(url));\n            };\n      }, [previewUrls]);\n\n      // 清理视频和定时器资源\n      useEffect(() => {\n            return () => {\n                  if (runTimeInterval) {\n                        clearInterval(runTimeInterval);\n                  }\n                  if (videoStream) {\n                        videoStream.getTracks().forEach(track => track.stop());\n                  }\n                  if (captureInterval) {\n                        clearInterval(captureInterval);\n                  }\n            };\n      }, []);\n\n      useEffect(() => {\n            // Check if user is already logged in\n            const token = localStorage.getItem('token');\n            const user = localStorage.getItem('user');\n            if (token && user) {\n                  setIsLoggedIn(true);\n                  setCurrentUser(JSON.parse(user));\n            }\n      }, []);\n\n      // 打开摄像头\n      const handleOpenCamera = async () => {\n            try {\n                  console.log('开始打开/关闭摄像头操作, 当前状态:', { isCameraActive });\n\n                  if (isCameraActive) {\n                        // 关闭摄像头逻辑\n                        console.log('正在关闭摄像头...');\n                        if (videoStream) {\n                              videoStream.getTracks().forEach(track => track.stop());\n                        }\n                        setVideoStream(null);\n                        setIsCameraActive(false);\n\n                        // 停止实时检测\n                        if (isCapturing) {\n                              setIsCapturing(false);\n                              if (captureInterval) {\n                                    clearInterval(captureInterval);\n                                    setCaptureInterval(null);\n                              }\n                        }\n\n                        // 重置检测进度\n                        setDetectionProgress(0);\n\n                        // 重置所有图像相关状态\n                        setImageList([]);\n                        setPreviewUrls([]);\n                        setSelectedImage(null);\n                        setCurrentImageIndex(0);\n                        setDetectionHistory([]);\n                        setDetectionResults({\n                              defects: [],\n                              statistics: {\n                                    defect_types: {}\n                              }\n                        });\n                        setProcessedResults([]);\n                        setImageDimensions(null);\n                        setScale(1);\n                        setPosition({ x: 0, y: 0 });\n\n                        message.success('摄像头已关闭');\n                        return;\n                  }\n\n                  // 先重置图像状态，确保界面干净\n                  resetImageAndDetectionStates();\n\n                  // 检查浏览器是否支持摄像头API\n                  if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n                        message.error('您的浏览器不支持访问摄像头功能');\n                        return;\n                  }\n\n                  console.log('正在请求摄像头权限...');\n                  // 尝试访问摄像头\n                  const stream = await navigator.mediaDevices.getUserMedia({\n                        video: {\n                              width: { ideal: 1280 },\n                              height: { ideal: 720 }\n                        }\n                  });\n\n                  console.log('成功获取摄像头流');\n\n                  // 重要：先设置状态再处理视频元素\n                  setIsCameraActive(true);\n                  setVideoStream(stream);\n\n                  // 等待状态更新完成\n                  await new Promise(resolve => setTimeout(resolve, 50));\n\n                  // 直接设置视频源\n                  if (videoRef.current) {\n                        console.log('设置视频元素源...');\n                        videoRef.current.srcObject = stream;\n                        try {\n                              await videoRef.current.play();\n                              console.log('视频播放成功');\n                        } catch (err) {\n                              console.error('视频播放失败:', err);\n                        }\n                  }\n\n                  message.success('摄像头已打开');\n            } catch (error) {\n                  console.error('无法访问摄像头:', error);\n\n                  // 更详细的错误信息处理\n                  if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {\n                        message.error('摄像头访问被拒绝，请在浏览器中允许访问摄像头');\n                  } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {\n                        message.error('未找到摄像头设备，请确保您的设备已连接摄像头');\n                  } else if (error.name === 'NotReadableError' || error.name === 'TrackStartError') {\n                        message.error('无法读取摄像头，可能被其他应用程序占用');\n                  } else {\n                        message.error('无法访问摄像头: ' + error.message);\n                  }\n            }\n      };\n\n\n      const resetImageAndDetectionStates = () => {\n            console.log('重置图像和检测状态开始');\n\n            // 清理URL资源\n            previewUrls.forEach(url => {\n                  try {\n                        URL.revokeObjectURL(url);\n                  } catch (e) {\n                        console.error(\"撤销URL时出错:\", e);\n                  }\n            });\n\n            // 重置图像和检测相关状态，但保留摄像头状态\n            setImageList([]);\n            setPreviewUrls([]);\n            setSelectedImage(null);\n            setCurrentImageIndex(0);\n            setDetectionHistory([]);\n            setDetectionResults({\n                  defects: [],\n                  statistics: {\n                        defect_types: {}\n                  }\n            });\n            setProcessedResults([]);\n            setDetectionProgress(0);\n            setBatchProgress(0);\n            setScale(1);\n            setPosition({ x: 0, y: 0 });\n            // 重置图像尺寸\n            setImageDimensions(null);\n\n            console.log('重置图像和检测状态完成');\n      };\n\n      // 捕获视频帧并转换为文件\n      const captureVideoFrame = () => {\n            if (!videoRef.current || !isCameraActive) {\n                  console.error('视频元素不可用或摄像头未激活');\n                  return null;\n            }\n\n            // 检查视频是否在播放\n            if (videoRef.current.paused || videoRef.current.ended) {\n                  console.warn('视频已暂停或结束，尝试重新播放');\n                  videoRef.current.play().catch(err => {\n                        console.error('无法重新播放视频:', err);\n                  });\n                  return null;\n            }\n\n            // 确保视频尺寸有效\n            const videoWidth = videoRef.current.videoWidth;\n            const videoHeight = videoRef.current.videoHeight;\n\n            if (!videoWidth || !videoHeight) {\n                  console.warn('视频尺寸无效:', videoWidth, videoHeight);\n                  return null;\n            }\n\n            console.log('捕获视频帧，原始尺寸:', videoWidth, 'x', videoHeight);\n\n            // 计算等比例缩放后的尺寸\n            let newWidth, newHeight;\n\n            if (videoWidth > 600 || videoHeight > 600) {\n                  // 固定宽度为600, 高度按比例缩放\n                  newWidth = 600;\n                  newHeight = Math.round((videoHeight / videoWidth) * 600);\n            } else {\n                  // 小尺寸视频保持原始尺寸\n                  newWidth = videoWidth;\n                  newHeight = videoHeight;\n            }\n\n            console.log('捕获视频帧，缩放后尺寸:', newWidth, 'x', newHeight);\n\n            // 创建两个画布 - 一个用于捕获原始帧，一个用于缩放\n            const captureCanvas = document.createElement('canvas');\n            captureCanvas.width = videoWidth;\n            captureCanvas.height = videoHeight;\n\n            // 先在原始尺寸画布上绘制视频帧\n            const captureCtx = captureCanvas.getContext('2d');\n            captureCtx.drawImage(videoRef.current, 0, 0, videoWidth, videoHeight);\n\n            // 创建第二个画布用于缩放\n            const scaleCanvas = document.createElement('canvas');\n            scaleCanvas.width = newWidth;\n            scaleCanvas.height = newHeight;\n\n            // 在第二个画布上绘制缩放后的图像\n            const scaleCtx = scaleCanvas.getContext('2d');\n            scaleCtx.drawImage(captureCanvas, 0, 0, videoWidth, videoHeight, 0, 0, newWidth, newHeight);\n\n            // 保存缩放后的尺寸信息到state\n            setImageDimensions({ width: newWidth, height: newHeight });\n\n            // 将缩放后的画布转换为Blob\n            return new Promise((resolve) => {\n                  scaleCanvas.toBlob((blob) => {\n                        if (!blob) {\n                              console.error('无法创建Blob');\n                              resolve(null);\n                              return;\n                        }\n\n                        // 创建File对象\n                        const file = new File([blob], 'camera-capture.jpg', { type: 'image/jpeg' });\n                        resolve(file);\n                  }, 'image/jpeg', 0.95); // 高质量JPEG\n            });\n      };\n      // 开始或暂停实时检测\n      // 开始或暂停实时检测\n      const toggleContinuousCapture = async () => {\n            // Reset runtime variables at the start of continuous capture\n            setStartTime(null);\n            startTimeRef.current = null;\n            setEndTime(null);\n            setCurrentRunTime('0秒');\n            if (isCapturing) {\n                  // 如果正在捕获，则停止\n                  if (captureInterval) {\n                        clearInterval(captureInterval);\n                        setCaptureInterval(null);\n                  }\n\n                  // 停止运行时长计时\n                  if (runTimeInterval) {\n                        clearInterval(runTimeInterval);\n                        setRunTimeInterval(null);\n                  }\n\n                  // 设置结束时间\n                  if (startTimeRef.current) {\n                        const end = Date.now();\n                        setEndTime(end);\n\n                        // 计算最终运行时长\n                        const finalDuration = Math.floor((end - startTimeRef.current) / 1000);\n                        const hours = Math.floor(finalDuration / 3600);\n                        const minutes = Math.floor((finalDuration % 3600) / 60);\n                        const seconds = finalDuration % 60;\n                        setCurrentRunTime(`${hours}小时${minutes}分钟${seconds}秒`);\n                  }\n\n                  setIsCapturing(false);\n\n                  // 重置检测结果以清除边界框，但确保不影响视频流\n                  setDetectionResults({\n                        defects: [],\n                        statistics: {\n                              defect_types: {}\n                        }\n                  });\n\n                  message.info('已停止实时检测');\n                  return;\n            }\n\n            // 开始实时捕获\n            if (!isCameraActive) {\n                  message.warning('请先打开摄像头');\n                  return;\n            }\n\n            // 确保视频元素存在且正在播放\n            if (!videoRef.current || !videoRef.current.srcObject) {\n                  console.error('视频元素未准备就绪');\n                  message.error('视频未准备就绪，请重新打开摄像头');\n                  return;\n            }\n\n            // 检查视频流是否可用\n            try {\n                  if (videoRef.current.paused || videoRef.current.ended) {\n                        await videoRef.current.play();\n                        console.log('重新开始播放视频');\n                  }\n            } catch (err) {\n                  console.error('无法播放视频:', err);\n                  message.error('无法播放视频');\n                  return;\n            }\n\n            // 设置开始时间\n            const start = Date.now();\n            setStartTime(start);\n            startTimeRef.current = start;\n            setEndTime(null);\n\n            // 启动运行时长计时器\n            const timeInterval = setInterval(() => {\n                  const now = Date.now();\n                  // Use the ref instead of the closure value\n                  const duration = Math.floor((now - startTimeRef.current) / 1000); // 秒数\n                  const hours = Math.floor(duration / 3600);\n                  const minutes = Math.floor((duration % 3600) / 60);\n                  const seconds = duration % 60;\n                  setCurrentRunTime(`${hours}小时${minutes}分钟${seconds}秒`);\n            }, 1000);\n\n            setRunTimeInterval(timeInterval);\n\n            setIsCapturing(true);\n            message.info('开始实时检测');\n            console.log('开始实时检测，视频流状态:', videoRef.current.readyState);\n\n            // 设置定期捕获和检测\n            const interval = setInterval(async () => {\n                  try {\n                        // 检查视频状态，确保检测过程中摄像头未关闭\n                        if (!videoRef.current || !videoRef.current.srcObject || !isCameraActive) {\n                              console.warn('视频元素不存在或摄像头已关闭，停止检测');\n                              clearInterval(interval);\n\n                              // 停止运行时长计时\n                              if (runTimeInterval) {\n                                    clearInterval(runTimeInterval);\n                                    setRunTimeInterval(null);\n                              }\n\n                              setIsCapturing(false);\n                              setCaptureInterval(null);\n                              message.warning('摄像头已断开，实时检测停止');\n                              return;\n                        }\n\n                        // 如果视频暂停，尝试重新播放\n                        if (videoRef.current.paused || videoRef.current.ended) {\n                              console.warn('视频暂停或结束，尝试重新播放');\n                              try {\n                                    await videoRef.current.play();\n                              } catch (playErr) {\n                                    console.error('无法重新播放视频:', playErr);\n                                    message.error('无法恢复视频播放，实时检测停止');\n                                    clearInterval(interval);\n\n                                    // 停止运行时长计时\n                                    if (runTimeInterval) {\n                                          clearInterval(runTimeInterval);\n                                          setRunTimeInterval(null);\n                                    }\n\n                                    setIsCapturing(false);\n                                    setCaptureInterval(null);\n                                    return;\n                              }\n                        }\n\n                        // 捕获视频帧\n                        const capturedFrame = await captureVideoFrame();\n                        if (capturedFrame) {\n                              console.log('成功捕获视频帧', new Date().toLocaleTimeString());\n                              setDetectionProgress(20);\n\n                              // 处理捕获的帧并检测缺陷\n                              const result = await processImage(capturedFrame);\n                              console.log('检测结果:', result.defects.length > 0 ? `发现${result.defects.length}个缺陷` : '未发现缺陷');\n\n                              // 确保在摄像头活动且视频元素存在时更新结果\n                              if (isCameraActive && videoRef.current) {\n                                    // 确认视频仍在播放\n                                    if (videoRef.current.paused) {\n                                          console.log('检测期间视频暂停，尝试恢复');\n                                          videoRef.current.play().catch(e => console.error('无法恢复视频:', e));\n                                    }\n\n                                    // 更新检测结果之前先清除之前的结果\n                                    setProcessedResults([]);\n\n                                    // 更新检测结果\n                                    setDetectionResults(result);\n                              }\n\n                              setDetectionProgress(100);\n                        } else {\n                              console.warn('未能捕获视频帧');\n                        }\n                  } catch (error) {\n                        console.error('实时检测错误:', error);\n                        message.error('实时检测出错: ' + error.message);\n                  }\n            }, 2000); // 每2秒捕获一次\n\n            setCaptureInterval(interval);\n      };\n      // 处理缺陷过滤的变化\n      const handleDefectFilterChange = (value) => {\n            setDefectFilter(value);\n            filterDefects(value);\n      };\n      const resetAllStates = () => {\n            console.log('重置所有状态开始，摄像头状态:', isCameraActive);\n            if (runTimeInterval) {\n                  clearInterval(runTimeInterval);\n                  setRunTimeInterval(null);\n            }\n\n            // 重置运行时长\n            setCurrentRunTime('0秒');\n            setStartTime(null);\n            startTimeRef.current = null;\n            setEndTime(null);\n\n            // 如果摄像头处于活动状态，只重置图像相关状态\n            if (isCameraActive) {\n                  resetImageAndDetectionStates();\n                  return;\n            }\n\n            // 否则重置所有状态包括摄像头\n            // 清理URL资源\n            previewUrls.forEach(url => {\n                  try {\n                        URL.revokeObjectURL(url);\n                  } catch (e) {\n                        console.error(\"撤销URL时出错:\", e);\n                  }\n            });\n\n            // 清理摄像头资源\n            if (videoStream) {\n                  videoStream.getTracks().forEach(track => track.stop());\n            }\n            setVideoStream(null);\n            setIsCameraActive(false);\n\n            if (captureInterval) {\n                  clearInterval(captureInterval);\n                  setCaptureInterval(null);\n            }\n\n            // 重置其他状态\n            setImageList([]);\n            setPreviewUrls([]);\n            setSelectedImage(null);\n            setCurrentImageIndex(0);\n            setDetectionHistory([]);\n            setDetectionResults({\n                  defects: [],\n                  statistics: {\n                        defect_types: {}\n                  }\n            });\n            setProcessedResults([]);\n            setDetectionProgress(0);\n            setBatchProgress(0);\n            setScale(1);\n            setPosition({ x: 0, y: 0 });\n\n            console.log('重置所有状态完成');\n      };\n      // 过滤缺陷基于选择\n      const filterDefects = (filterType) => {\n            if (!detectionResults || !detectionResults.defects) return;\n\n            if (filterType === 'all') {\n                  setProcessedResults(detectionResults.defects);\n            } else {\n                  const filtered = detectionResults.defects.filter(defect =>\n                        defect.type.toLowerCase() === filterType.toLowerCase()\n                  );\n                  setProcessedResults(filtered);\n            }\n      };\n\n      // 当检测结果改变时更新处理后的结果\n      useEffect(() => {\n            if (detectionResults && detectionResults.defects) {\n                  // 根据实际结果更新缺陷类型\n                  const types = ['all'];\n                  detectionResults.defects.forEach(defect => {\n                        if (!types.includes(defect.type.toLowerCase())) {\n                              types.push(defect.type.toLowerCase());\n                        }\n                  });\n                  setDefectTypes(types);\n\n                  // 应用当前过滤器\n                  filterDefects(defectFilter);\n            }\n      }, [detectionResults]);\n\n      // 获取每种缺陷类型的颜色\n      const getDefectColor = (defectType) => {\n            const colorMap = {\n                  'mouse_bite': '#ff7875',      // 适中红色\n                  'open_circuit': '#40a9ff',     // 适中蓝色\n                  'short': '#ffc53d',           // 适中黄色\n                  'spur': '#73d13d',           // 适中绿色\n                  'spurious_copper': '#9254de'  // 适中紫色\n            };\n\n            return colorMap[defectType.toLowerCase()] || '#ff7875'; // 默认使用适中红色\n      };\n\n      // 渲染边界框\n      const renderBoundingBoxes = () => {\n            // 修改条件判断，针对摄像头模式添加特殊处理\n            if ((!selectedImage && !isCameraActive) || !processedResults || processedResults.length === 0) {\n                  return null;\n            }\n\n            // 获取视频元素的实际位置和尺寸\n            let videoPosition = { left: 0, top: 0, width: 0, height: 0 };\n            let scaleFactor = 1;\n\n            if (isCameraActive && videoRef.current && imageDimensions) {\n                  // 获取视频元素的计算样式和几何信息\n                  const videoElement = videoRef.current;\n                  const videoComputedStyle = window.getComputedStyle(videoElement);\n                  const videoRect = videoElement.getBoundingClientRect();\n                  const parentRect = videoElement.parentElement.getBoundingClientRect();\n\n                  // 计算视频相对于父容器的位置（由于objectFit: contain会留白）\n                  // 视频元素的位置会因为居中显示而有偏移\n                  videoPosition = {\n                        width: videoRect.width,\n                        height: videoRect.height,\n                        // 计算相对于父容器的左偏移\n                        left: videoRect.left - parentRect.left,\n                        // 计算相对于父容器的顶部偏移\n                        top: videoRect.top - parentRect.top\n                  };\n\n                  // 视频显示尺寸与原始图像尺寸比例\n                  const scaleX = videoPosition.width / imageDimensions.width;\n                  const scaleY = videoPosition.height / imageDimensions.height;\n                  scaleFactor = Math.min(scaleX, scaleY);\n\n                  console.log('视频位置计算:', {\n                        videoPosition,\n                        imageSize: imageDimensions,\n                        scale: scaleFactor,\n                        boxOffset: { x: videoPosition.left, y: videoPosition.top }\n                  });\n            }\n\n            return processedResults.map((defect, index) => {\n                  // 检查是否有实际的边界框数据\n                  if (defect.bbox) {\n                        let { x1, y1, x2, y2 } = defect.bbox;\n\n                        // 应用视频帧中的缩放因子和偏移\n                        if (isCameraActive && imageDimensions) {\n                              // 基于imageWrapperRef计算视频内容的实际显示区域\n                              let scale = 1;\n                              let offsetX = 0;\n                              let offsetY = 0;\n                              if (isCameraActive && imageDimensions && imageWrapperRef.current) {\n                                    const wrapperRect = imageWrapperRef.current.getBoundingClientRect();\n                                    const containerW = wrapperRect.width;\n                                    const containerH = wrapperRect.height;\n                                    const { width: imgW, height: imgH } = imageDimensions;\n                                    const imgRatio = imgW / imgH;\n                                    const containerRatio = containerW / containerH;\n                                    let contentW, contentH;\n                                    if (imgRatio > containerRatio) {\n                                          contentW = containerW;\n                                          contentH = contentW / imgRatio;\n                                    } else {\n                                          contentH = containerH;\n                                          contentW = contentH * imgRatio;\n                                    }\n                                    // 计算内容区域的偏移量（居中留白）\n                                    offsetX = (containerW - contentW) / 2;\n                                    offsetY = (containerH - contentH) / 2;\n                                    // 计算缩放比例\n                                    scale = contentW / imgW;\n                              }\n                              x1 = x1 * scale + offsetX;\n                              y1 = y1 * scale + offsetY;\n                              x2 = x2 * scale + offsetX;\n                              y2 = y2 * scale + offsetY;\n                        }\n\n                        const width = x2 - x1;\n                        const height = y2 - y1;\n\n                        return (\n                              <div\n                                    key={index}\n                                    style={{\n                                          position: 'absolute',\n                                          left: `${x1}px`,\n                                          top: `${y1}px`,\n                                          width: `${width}px`,\n                                          height: `${height}px`,\n                                          border: `2px solid ${getDefectColor(defect.type)}`,\n                                          backgroundColor: 'rgba(255, 255, 255, 0.1)',\n                                          pointerEvents: 'none',\n                                          zIndex: 100,\n                                    }}\n                              >\n                                    <div style={{\n                                          position: 'absolute',\n                                          top: '-20px',\n                                          left: '0',\n                                          background: getDefectColor(defect.type),\n                                          color: 'white',\n                                          padding: '0 4px',\n                                          fontSize: '10px',\n                                          whiteSpace: 'nowrap'\n                                    }}>\n                                          {defect.type} {defect.confidence ? `(${defect.confidence}%)` : ''}\n                                    </div>\n                              </div>\n                        );\n                  } else if (defect.position) {\n                        // 使用位置数据的后备选项\n                        const boxWidth = 60;\n                        const boxHeight = 40;\n                        let x = defect.position.x - (boxWidth / 2);\n                        let y = defect.position.y - (boxHeight / 2);\n\n                        // 应用视频帧中的缩放因子和偏移\n                        if (isCameraActive && imageDimensions) {\n                              x = x * scaleFactor + videoPosition.left;\n                              y = y * scaleFactor + videoPosition.top;\n                        }\n\n                        return (\n                              <div\n                                    key={index}\n                                    style={{\n                                          position: 'absolute',\n                                          left: `${x}px`,\n                                          top: `${y}px`,\n                                          width: `${boxWidth}px`,\n                                          height: `${boxHeight}px`,\n                                          border: `2px solid ${getDefectColor(defect.type)}`,\n                                          backgroundColor: 'rgba(255, 255, 255, 0.1)',\n                                          pointerEvents: 'none',\n                                          zIndex: 100,\n                                    }}\n                              >\n                                    <div style={{\n                                          position: 'absolute',\n                                          top: '-20px',\n                                          left: '0',\n                                          background: getDefectColor(defect.type),\n                                          color: 'white',\n                                          padding: '0 4px',\n                                          fontSize: '10px',\n                                          whiteSpace: 'nowrap'\n                                    }}>\n                                          {defect.type} {defect.confidence ? `(${defect.confidence}%)` : ''}\n                                    </div>\n                              </div>\n                        );\n                  }\n                  return null;\n            });\n      };\n\n\n      // 处理单个图片上传\n      const handleImageUpload = (file) => {\n            if (!file) {\n                  return false;\n            }\n\n            setIsUploading(true);\n\n            // 使用Image API预加载图片并计算尺寸\n            const img = new Image();\n            img.onload = () => {\n                  // 计算等比例缩放后的尺寸\n                  let newWidth, newHeight;\n\n                  if (img.width > 600 || img.height > 600) {\n                        // 固定宽度为600, 高度按比例缩放\n                        newWidth = 600;\n                        newHeight = Math.round((img.height / img.width) * 600);\n                  } else {\n                        // 小图维持原尺寸\n                        newWidth = img.width;\n                        newHeight = img.height;\n                  }\n\n                  // 创建canvas进行缩放\n                  const canvas = document.createElement('canvas');\n                  canvas.width = newWidth;\n                  canvas.height = newHeight;\n                  const ctx = canvas.getContext('2d');\n                  ctx.drawImage(img, 0, 0, newWidth, newHeight);\n\n                  // 转换为blob并上传\n                  canvas.toBlob(async (blob) => {\n                        try {\n                              // 将缩放后的图像尺寸保存到状态中\n                              setImageDimensions({ width: newWidth, height: newHeight });\n\n                              // 创建新的File对象并处理\n                              const resizedFile = new File([blob], file.name, { type: file.type });\n\n                              // 在UI上显示缩放后的图\n                              const imageUrl = URL.createObjectURL(blob);\n\n                              // 更新状态\n                              setImageList([resizedFile]);\n                              setPreviewUrls([imageUrl]);\n                              setSelectedImage(imageUrl);\n                              setCurrentImageIndex(0);\n\n                              // 重置检测历史\n                              setDetectionHistory([]);\n\n                              // 重置检测结果\n                              setDetectionResults({\n                                    defects: [],\n                                    statistics: {\n                                          defect_types: {}\n                                    }\n                              });\n\n                              // 重置处理后的结果\n                              setProcessedResults([]);\n\n                              setDetectionProgress(0);\n                              setBatchProgress(0);\n                              message.success('图片导入成功');\n                        } catch (error) {\n                              console.error('图片处理错误:', error);\n                              message.error('图片处理失败');\n                        } finally {\n                              setIsUploading(false);\n                        }\n                  }, file.type, 0.95); // 高质量\n            };\n\n            img.onerror = () => {\n                  console.error('图片加载失败');\n                  message.error('图片加载失败');\n                  setIsUploading(false);\n            };\n\n            img.src = URL.createObjectURL(file);\n            return false; // 阻止默认上传行为\n      };\n\n      // 处理文件夹上传的防抖版本\n      // 处理文件夹上传的防抖版本\n      const debouncedHandleFolderUpload = debounce((info) => {\n            console.log(\"文件夹上传信息 (防抖处理):\", info);\n            setIsUploading(true);\n\n            try {\n                  // 先重置所有状态，确保干净的开始\n                  resetAllStates();\n\n                  // 确保文件列表存在且不为空\n                  if (!info || !info.fileList || info.fileList.length === 0) {\n                        message.warning('未找到文件');\n                        setIsUploading(false);\n                        return;\n                  }\n\n                  // 处理新文件\n                  const newFiles = [];\n                  info.fileList.forEach(file => {\n                        const fileObj = file.originFileObj || file;\n                        if (fileObj && fileObj.type && fileObj.type.startsWith('image/')) {\n                              newFiles.push(fileObj);\n                        }\n                  });\n\n                  console.log(\"导入的图片文件数量:\", newFiles.length);\n\n                  if (newFiles.length === 0) {\n                        message.warning('未找到图片文件');\n                        setIsUploading(false);\n                        return;\n                  }\n\n                  // 创建新URL\n                  const urls = [];\n                  for (const file of newFiles) {\n                        try {\n                              const url = URL.createObjectURL(file);\n                              urls.push(url);\n                        } catch (e) {\n                              console.error(\"无法为文件创建URL:\", file.name, e);\n                        }\n                  }\n\n                  if (urls.length === 0) {\n                        message.error('无法处理图片文件');\n                        setIsUploading(false);\n                        return;\n                  }\n\n                  // 设置新的状态\n                  setImageList(newFiles);\n                  setPreviewUrls(urls);\n                  setSelectedImage(urls[0]);\n\n                  message.success(`成功导入 ${newFiles.length} 张图片`);\n            } catch (error) {\n                  console.error('文件夹导入错误:', error);\n                  message.error('文件夹导入失败');\n                  // 出错时也重置状态\n                  resetAllStates();\n            } finally {\n                  setIsUploading(false);\n            }\n      }, 300); // 300ms的防抖延迟\n\n      // 重置图片位置（在切换图片时调用）\n      const resetImagePosition = () => {\n            setScale(1);\n            setPosition({ x: 0, y: 0 });\n      };\n\n      // 处理图片切换\n      const handleImageChange = (index) => {\n            if (index >= 0 && index < imageList.length) {\n                  setCurrentImageIndex(index);\n                  setSelectedImage(previewUrls[index]);\n                  resetImagePosition(); // 重置缩放和位置\n                  // 如果有检测结果，显示对应结果\n                  if (detectionHistory[index]) {\n                        setDetectionResults(detectionHistory[index].result);\n                  }\n            }\n      };\n\n      // 处理上一张图片\n      const handlePrevImage = () => {\n            handleImageChange(currentImageIndex - 1);\n      };\n\n      // 处理下一张图片\n      const handleNextImage = () => {\n            handleImageChange(currentImageIndex + 1);\n      };\n\n      // 处理页码变化\n      const handlePageChange = (page) => {\n            handleImageChange(page - 1);\n      };\n\n      const [selectedModel, setSelectedModel] = useState('yolov11'); // 默认选择Yolov11模型\n\n      const handleModelChange = (value) => {\n            setSelectedModel(value);\n            switch (value) {\n                  case 'yolov11':\n                        message.info('切换到 Yolov11 模型');\n                        break;\n                  case 'yolov11-vote2':\n                        message.info('切换到 Yolov11-vote2 模型');\n                        break;\n                  case 'yolov11-vote4':\n                        message.info('切换到 Yolov11-vote4 模型');\n                        break;\n                  default:\n                        message.warning('未知模型选择');\n            }\n      };\n\n      const [iouThreshold, setIouThreshold] = useState(0.45); // 默认值为 0.45\n      const [confThreshold, setConfThreshold] = useState(0.4); // 默认值为 0.4\n\n      // 修改单个图片检测逻辑，传递 iou_threshold 和 conf_threshold 参数\n      const processImage = async (file) => {\n            try {\n                  const formData = new FormData();\n                  formData.append('image', file);\n\n                  // 添加图像尺寸信息到请求参数中\n                  const params = {\n                        vote_threshold: selectedModel === 'yolov11-vote2' ? 1 : selectedModel === 'yolov11-vote4' ? 2 : 1,\n                        orientation_count: selectedModel === 'yolov11-vote2' ? 2 : selectedModel === 'yolov11-vote4' ? 4 : 1,\n                        iou_threshold: iouThreshold,\n                        conf_threshold: confThreshold,\n                  };\n\n                  // 如果有图像尺寸信息，也传递给后端\n                  if (imageDimensions) {\n                        params.img_width = imageDimensions.width;\n                        params.img_height = imageDimensions.height;\n                  }\n\n                  const detectResponse = await axios.post('/api/detect', formData, {\n                        params: params,\n                  });\n\n                  return detectResponse.data;\n            } catch (error) {\n                  throw new Error(`检测失败: ${error.message}`);\n            }\n      };\n\n      // 批量检测处理\n      const [startTime, setStartTime] = useState(null); // 检测开始时间\n      const [endTime, setEndTime] = useState(null); // 检测结束时间\n\n      // 计算运行时长\n      const calculateUptime = () => {\n            if (!startTime || !endTime) return 'N/A';\n            const duration = Math.floor((endTime - startTime) / 1000); // 秒数\n            const hours = Math.floor(duration / 3600);\n            const minutes = Math.floor((duration % 3600) / 60);\n            const seconds = duration % 60;\n            return `${hours}小时${minutes}分钟${seconds}秒`;\n      };\n\n      // 修改 handleBatchDetection 函数，记录开始和结束时间\n      const handleBatchDetection = async () => {\n            // Reset runtime variables at the start of batch detection\n            setStartTime(null);\n            startTimeRef.current = null;\n            setEndTime(null);\n            setCurrentRunTime('0秒');\n            if (isCameraActive) {\n                  toggleContinuousCapture();\n                  return;\n            }\n            if (imageList.length === 0) {\n                  message.warning('请先导入图片');\n                  return;\n            }\n\n            if (isBatchProcessing) {\n                  const newPauseState = !isPaused;\n                  setIsPaused(newPauseState);\n                  isPausedRef.current = newPauseState;\n                  message.info(newPauseState ? '暂停检测' : '继续检测');\n                  return;\n            }\n\n            setIsBatchProcessing(true);\n            setLoading(true);\n            setIsPaused(false);\n            isPausedRef.current = false;\n\n            // 记录检测开始时间\n            const start = Date.now();\n            setStartTime(start);\n            startTimeRef.current = start;\n            setEndTime(null);\n\n            // 启动运行时长计时器\n            const interval = setInterval(() => {\n                  const now = Date.now();\n                  // Use the ref instead of the closure value\n                  const duration = Math.floor((now - startTimeRef.current) / 1000); // 秒数\n                  const hours = Math.floor(duration / 3600);\n                  const minutes = Math.floor((duration % 3600) / 60);\n                  const seconds = duration % 60;\n                  setCurrentRunTime(`${hours}小时${minutes}分钟${seconds}秒`);\n            }, 1000);\n\n            setRunTimeInterval(interval);\n\n            let history = [];\n            let i = 0;\n\n            try {\n                  setDetectionProgress(1);\n\n                  while (i < imageList.length) {\n                        if (isPausedRef.current) {\n                              await new Promise(resolve => {\n                                    const checkPauseInterval = setInterval(() => {\n                                          if (!isPausedRef.current) {\n                                                clearInterval(checkPauseInterval);\n                                                resolve();\n                                          }\n                                    }, 100);\n                              });\n                              continue;\n                        }\n\n                        setDetectionResults({\n                              defects: [],\n                              statistics: {\n                                    defect_types: {}\n                              }\n                        });\n\n                        setProcessedResults([]);\n                        setCurrentImageIndex(i);\n                        setSelectedImage(previewUrls[i]);\n\n                        const progress = Math.round(((i + 1) / imageList.length) * 100);\n                        setBatchProgress(progress);\n                        setDetectionProgress(progress);\n\n                        const result = await processImage(imageList[i]);\n\n                        history.push({\n                              imageUrl: previewUrls[i],\n                              result: result\n                        });\n\n                        setDetectionResults(result);\n\n                        await new Promise(resolve => setTimeout(resolve, 1000));\n\n                        if (!isPausedRef.current) {\n                              i++;\n                        }\n                  }\n\n                  setDetectionHistory(history);\n\n                  // 停止计时器并记录结束时间\n                  clearInterval(runTimeInterval);\n                  setRunTimeInterval(null);\n                  const end = Date.now();\n                  setEndTime(end);\n\n                  // 计算并设置最终运行时长\n                  const finalDuration = Math.floor((end - startTimeRef.current) / 1000);\n                  const hours = Math.floor(finalDuration / 3600);\n                  const minutes = Math.floor((finalDuration % 3600) / 60);\n                  const seconds = finalDuration % 60;\n                  setCurrentRunTime(`${hours}小时${minutes}分钟${seconds}秒`);\n\n                  message.success('检测完成');\n                  setIsBatchProcessing(false);\n            } catch (error) {\n                  // 停止计时器\n                  clearInterval(runTimeInterval);\n                  setRunTimeInterval(null);\n\n                  message.error(error.message);\n                  setIsBatchProcessing(false);\n            } finally {\n                  setLoading(false);\n            }\n      };\n      // 修改useEffect中的全局滚轮事件处理\n      useEffect(() => {\n            if (selectedImage) {\n                  // 我们只需要为图片区域添加滚轮处理，不影响全局滚动\n                  const handleImageScrolling = (e) => {\n                        // 检查事件是否发生在图片容器内\n                        let targetElement = e.target;\n                        let isInsideImageWrapper = false;\n\n                        while (targetElement) {\n                              if (targetElement === imageWrapperRef.current) {\n                                    isInsideImageWrapper = true;\n                                    break;\n                              }\n                              targetElement = targetElement.parentElement;\n                        }\n\n                        // 仅当在图片区域内才阻止默认行为\n                        if (isInsideImageWrapper) {\n                              e.preventDefault();\n                        }\n                  };\n\n                  // 添加事件监听器到图片容器\n                  if (imageWrapperRef.current) {\n                        imageWrapperRef.current.addEventListener('wheel', handleImageScrolling, { passive: false });\n                  }\n\n                  return () => {\n                        // 移除事件监听器\n                        if (imageWrapperRef.current) {\n                              imageWrapperRef.current.removeEventListener('wheel', handleImageScrolling);\n                        }\n                  };\n            }\n      }, [selectedImage]);\n\n      // 移除之前的全局滚轮事件监听代码，改为下面的代码\n      // 这个处理只针对图片容器，允许其他区域正常滚动\n      useEffect(() => {\n            // 清理之前的样式\n            document.body.style.overflow = '';\n            document.documentElement.style.overflow = '';\n      }, []);\n\n      // 修改handleWheel函数，只处理图片缩放，不影响其他区域的滚动\n      const handleWheel = (e) => {\n            // 获取图片元素\n            const img = imageWrapperRef.current?.querySelector('img');\n            if (!img) return;\n\n            // 阻止默认行为，这样图片容器的滚轮操作不会引起页面滚动\n            e.preventDefault();\n\n            // 减小缩放系数，使缩放更平滑\n            const delta = e.deltaY * -0.005;\n            const newScale = Math.min(Math.max(scale + delta, MIN_ZOOM), MAX_ZOOM);\n\n            if (newScale === scale) return;\n\n            // 获取鼠标在图片容器中的相对位置\n            const rect = imageWrapperRef.current.getBoundingClientRect();\n            const mouseX = e.clientX - rect.left;\n            const mouseY = e.clientY - rect.top;\n\n            // 计算鼠标位置相对于图片中心的偏移\n            const centerX = rect.width / 2;\n            const centerY = rect.height / 2;\n\n            // 计算新的位置\n            const scaleChange = newScale - scale;\n            let newPosition = position;\n\n            if (delta > 0) { // 放大时\n                  // 以鼠标位置为中心进行放大\n                  newPosition = {\n                        x: position.x - (mouseX - centerX) * (scaleChange / scale),\n                        y: position.y - (mouseY - centerY) * (scaleChange / scale)\n                  };\n            } else { // 缩小时\n                  // 以图片中心为基准点进行缩小\n                  newPosition = {\n                        x: position.x * (newScale / scale),\n                        y: position.y * (newScale / scale)\n                  };\n            }\n\n            // 更新状态\n            setScale(newScale);\n            setPosition(newPosition);\n      };\n\n      // 处理鼠标拖动\n      const handleMouseDown = (e) => {\n            if (e.button === 0) {\n                  setIsDragging(true);\n                  setDragStart({\n                        x: e.clientX - position.x,\n                        y: e.clientY - position.y\n                  });\n            }\n      };\n\n      const handleMouseMove = (e) => {\n            if (isDragging) {\n                  const newX = e.clientX - dragStart.x;\n                  const newY = e.clientY - dragStart.y;\n\n                  // 限制拖动范围\n                  const maxOffset = 300 * (scale - 1);\n                  const boundedX = Math.max(Math.min(newX, maxOffset), -maxOffset);\n                  const boundedY = Math.max(Math.min(newY, maxOffset), -maxOffset);\n\n                  setPosition({\n                        x: boundedX,\n                        y: boundedY\n                  });\n            }\n      };\n\n      // 处理鼠标释放事件\n      const handleMouseUp = () => {\n            setIsDragging(false);\n      };\n\n      // 处理鼠标离开事件\n      const handleMouseLeave = () => {\n            setIsDragging(false);\n      };\n\n      // 修改缩放处理函数，添加位置重置\n      const handleZoomIn = () => {\n            setZoomLevel(prev => {\n                  const newZoom = Math.min(prev + ZOOM_STEP, MAX_ZOOM);\n                  if (newZoom === 1) {\n                        resetImagePosition();\n                  }\n                  return newZoom;\n            });\n      };\n\n      const handleZoomOut = () => {\n            setZoomLevel(prev => {\n                  const newZoom = Math.max(prev - ZOOM_STEP, MIN_ZOOM);\n                  if (newZoom === 1) {\n                        resetImagePosition();\n                  }\n                  return newZoom;\n            });\n      };\n\n      const handleExportResults = async () => {\n            if (!detectionResults.defects.length) {\n                  message.warning('没有可导出的检测结果');\n                  return;\n            }\n\n            try {\n                  // 检查浏览器是否支持文件系统访问 API\n                  if (!window.showDirectoryPicker) {\n                        message.error('当前浏览器不支持文件夹选择功能');\n                        return;\n                  }\n\n                  // 弹出文件夹选择器\n                  const directoryHandle = await window.showDirectoryPicker();\n\n                  // 创建子文件夹：标注图片和 JSON 文件\n                  const annotatedImagesFolder = await directoryHandle.getDirectoryHandle('Annotated_Images', { create: true });\n                  const jsonFolder = await directoryHandle.getDirectoryHandle('JSON_Files', { create: true });\n\n                  // 遍历所有图片，导出标注图片和对应的 JSON 文件\n                  for (let i = 0; i < imageList.length; i++) {\n                        const imageFile = imageList[i];\n                        const imageName = imageFile.name.split('.').slice(0, -1).join('.'); // 去掉文件扩展名\n\n                        // 导出标注图片\n                        const annotatedImageName = `${imageName}_annotated.png`;\n                        const annotatedImageHandle = await annotatedImagesFolder.getFileHandle(annotatedImageName, { create: true });\n                        const writableStream = await annotatedImageHandle.createWritable();\n\n                        // 创建标注图片的 Canvas\n                        const canvas = document.createElement('canvas');\n                        const context = canvas.getContext('2d');\n                        const image = new Image();\n\n                        // 加载图片并绘制到 Canvas 上\n                        image.src = previewUrls[i];\n                        await new Promise((resolve) => {\n                              image.onload = () => {\n                                    canvas.width = image.width;\n                                    canvas.height = image.height;\n                                    context.drawImage(image, 0, 0);\n\n                                    // 绘制检测框\n                                    detectionHistory[i]?.result?.defects.forEach((defect) => {\n                                          if (defect.bbox) {\n                                                const { x1, y1, x2, y2 } = defect.bbox;\n                                                context.strokeStyle = getDefectColor(defect.type);\n                                                context.lineWidth = 2;\n                                                context.strokeRect(x1, y1, x2 - x1, y2 - y1);\n\n                                                // 绘制缺陷类型标签\n                                                context.fillStyle = getDefectColor(defect.type);\n                                                context.font = '16px Arial';\n                                                context.fillText(defect.type, x1, y1 - 5);\n                                          }\n                                    });\n\n                                    resolve();\n                              };\n                        });\n\n                        // 将 Canvas 转换为 Blob 并写入文件\n                        const blob = await new Promise((resolve) => canvas.toBlob(resolve, 'image/png'));\n                        await writableStream.write(blob);\n                        await writableStream.close();\n\n                        // 导出对应的 JSON 文件\n                        const jsonFileName = `${imageName}_result.json`;\n                        const jsonFileHandle = await jsonFolder.getFileHandle(jsonFileName, { create: true });\n                        const jsonWritableStream = await jsonFileHandle.createWritable();\n\n                        const jsonResult = {\n                              image: imageName,\n                              defects: detectionHistory[i]?.result?.defects || [],\n                              statistics: detectionHistory[i]?.result?.statistics || {},\n                        };\n\n                        await jsonWritableStream.write(JSON.stringify(jsonResult, null, 2));\n                        await jsonWritableStream.close();\n                  }\n\n                  message.success('检测结果已成功导出');\n            } catch (error) {\n                  console.error('导出结果失败:', error);\n                  message.error('导出结果失败');\n            }\n      };\n\n      const handleExportReport = () => {\n            // 检查是否有检测结果可供导出\n            if (!detectionHistory || detectionHistory.length === 0) {\n                  message.warning('没有检测结果可供导出');\n                  return;\n            }\n\n            message.loading('正在生成报告...', 0);\n\n            try {\n                  // 创建一个临时的隐藏div来渲染HTML内容\n                  const reportContainer = document.createElement('div');\n                  reportContainer.style.position = 'absolute';\n                  reportContainer.style.left = '-9999px';\n                  reportContainer.style.top = '-9999px';\n                  reportContainer.style.width = '794px'; // A4宽度 (mm到px的近似值)\n                  document.body.appendChild(reportContainer);\n\n                  // 获取当前日期和时间\n                  const now = new Date();\n                  const dateStr = now.toLocaleDateString('zh-CN');\n                  const timeStr = now.toLocaleTimeString('zh-CN');\n\n                  // 计算批次统计数据\n                  const batchStatistics = {\n                        totalImages: imageList.length,\n                        totalDefects: 0,\n                        defectTypeCounts: {},\n                        imagesWithDefects: 0,\n                        averageDefectsPerImage: 0\n                  };\n\n                  // 遍历所有检测历史计算统计数据\n                  detectionHistory.forEach(history => {\n                        if (history.result && history.result.defects) {\n                              const defects = history.result.defects;\n                              if (defects.length > 0) {\n                                    batchStatistics.imagesWithDefects++;\n                              }\n                              batchStatistics.totalDefects += defects.length;\n\n                              defects.forEach(defect => {\n                                    if (!batchStatistics.defectTypeCounts[defect.type]) {\n                                          batchStatistics.defectTypeCounts[defect.type] = 0;\n                                    }\n                                    batchStatistics.defectTypeCounts[defect.type]++;\n                              });\n                        }\n                  });\n\n                  // 计算平均每张图片的缺陷数\n                  batchStatistics.averageDefectsPerImage = (batchStatistics.totalDefects / batchStatistics.totalImages).toFixed(2);\n\n                  // 准备批次统计表格\n                  let batchStatsRows = '';\n                  Object.entries(batchStatistics.defectTypeCounts).forEach(([type, count]) => {\n                        const percentage = ((count / batchStatistics.totalDefects) * 100).toFixed(1);\n                        batchStatsRows += `\n                  <tr>\n                        <td>${type}</td>\n                        <td>${count}</td>\n                        <td>${percentage}%</td>\n                  </tr>`;\n                  });\n\n                  // 准备当前图片的检测结果表格\n                  let currentImageDefectsRows = '';\n                  if (detectionResults && detectionResults.defects) {\n                        detectionResults.defects.forEach((defect, index) => {\n                              const positionStr = defect.bbox ?\n                                    `(${defect.bbox.x1.toFixed(0)},${defect.bbox.y1.toFixed(0)},${defect.bbox.x2.toFixed(0)},${defect.bbox.y2.toFixed(0)})` :\n                                    '未知';\n                              const confidence = defect.confidence ? `${defect.confidence}%` : '未知';\n\n                              currentImageDefectsRows += `\n                  <tr>\n                        <td>${index + 1}</td>\n                        <td>${defect.type}</td>\n                        <td>${positionStr}</td>\n                        <td>${confidence}</td>\n                  </tr>`;\n                        });\n                  }\n\n                  // 使用HTML创建报告内容\n                  reportContainer.innerHTML = `\n                  <div style=\"font-family: 'Microsoft YaHei', 'SimHei', sans-serif; padding: 20px; color: #333;\">\n                        <style>\n                              table {\n                                    width: 100%;\n                                    border-collapse: collapse;\n                                    margin: 15px 0;\n                              }\n                              th, td {\n                                    border: 1px solid #ddd;\n                                    padding: 8px;\n                                    text-align: center;\n                              }\n                              th {\n                                    background-color: #00539c;\n                                    color: white;\n                                    font-weight: bold;\n                              }\n                              tr:nth-child(even) {\n                                    background-color: #f2f2f2;\n                              }\n                              h1, h2, h3 {\n                                    color: #00539c;\n                                    margin-bottom: 10px;\n                              }\n                              .report-header {\n                                    text-align: center;\n                                    margin-bottom: 20px;\n                              }\n                              .report-date {\n                                    text-align: right;\n                                    color: #666;\n                                    font-size: 12px;\n                                    margin-bottom: 15px;\n                              }\n                              .section {\n                                    margin-bottom: 25px;\n                              }\n                              .footer {\n                                    text-align: center;\n                                    margin-top: 30px;\n                                    font-size: 10px;\n                                    color: #999;\n                                    position: absolute;\n                                    bottom: 20px;\n                                    width: 100%;\n                              }\n                              hr {\n                                    border: 0;\n                                    height: 1px;\n                                    background: #ddd;\n                                    margin: 20px 0;\n                              }\n                              .stats-card {\n                                    background: #f8f9fa;\n                                    border-radius: 8px;\n                                    padding: 15px;\n                                    margin: 10px 0;\n                                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n                              }\n                              .stats-grid {\n                                    display: grid;\n                                    grid-template-columns: repeat(3, 1fr);\n                                    gap: 15px;\n                                    margin: 15px 0;\n                              }\n                              .stat-item {\n                                    background: white;\n                                    padding: 10px;\n                                    border-radius: 6px;\n                                    text-align: center;\n                              }\n                              .stat-value {\n                                    font-size: 24px;\n                                    font-weight: bold;\n                                    color: #00539c;\n                              }\n                              .stat-label {\n                                    font-size: 14px;\n                                    color: #666;\n                              }\n                        </style>\n                        \n                        <div class=\"report-header\">\n                              <h1>PCB缺陷检测报告</h1>\n                        </div>\n                        \n                        <div class=\"report-date\">\n                              报告生成时间: ${dateStr} ${timeStr}\n                        </div>\n                        \n                        <hr>\n                        \n                        <div class=\"section\">\n                              <h2>批次检测概述</h2>\n                              <div class=\"stats-grid\">\n                                    <div class=\"stat-item\">\n                                          <div class=\"stat-value\">${batchStatistics.totalImages}</div>\n                                          <div class=\"stat-label\">检测总图片数</div>\n                                    </div>\n                                    <div class=\"stat-item\">\n                                          <div class=\"stat-value\">${batchStatistics.totalDefects}</div>\n                                          <div class=\"stat-label\">检出总缺陷数</div>\n                                    </div>\n                                    <div class=\"stat-item\">\n                                          <div class=\"stat-value\">${batchStatistics.averageDefectsPerImage}</div>\n                                          <div class=\"stat-label\">平均每图缺陷数</div>\n                                    </div>\n                              </div>\n                              \n                              <div class=\"stats-card\">\n                                    <h3>批次缺陷类型分布</h3>\n                                    <table>\n                                          <thead>\n                                                <tr>\n                                                      <th>缺陷类型</th>\n                                                      <th>数量</th>\n                                                      <th>占比</th>\n                                                </tr>\n                                          </thead>\n                                          <tbody>\n                                                ${batchStatsRows}\n                                          </tbody>\n                                    </table>\n                              </div>\n                        </div>\n                        \n                        <hr>\n                        \n                        <div class=\"section\">\n                              <h2>当前图片检测详情</h2>\n                              <p>图片序号: ${currentImageIndex + 1}/${imageList.length}</p>\n                              <table>\n                                    <thead>\n                                          <tr>\n                                                <th>缺陷ID</th>\n                                                <th>缺陷类型</th>\n                                                <th>位置坐标(x1,y1,x2,y2)</th>\n                                                <th>置信度</th>\n                                          </tr>\n                                    </thead>\n                                    <tbody>\n                                          ${currentImageDefectsRows}\n                                    </tbody>\n                              </table>\n                        </div>\n                        \n                        <div class=\"footer\">\n                              PCB缺陷检测系统\n                        </div>\n                  </div>\n                  `;\n\n                  // 使用html2canvas将HTML转换为canvas\n                  import('html2canvas').then(html2canvasModule => {\n                        const html2canvas = html2canvasModule.default;\n                        html2canvas(reportContainer, {\n                              scale: 2, // 提高清晰度\n                              useCORS: true,\n                              logging: false\n                        }).then(canvas => {\n                              // 创建PDF\n                              import('jspdf').then(jsPdfModule => {\n                                    const { jsPDF } = jsPdfModule;\n\n                                    const imgData = canvas.toDataURL('image/png');\n                                    const pdf = new jsPDF({\n                                          orientation: 'portrait',\n                                          unit: 'mm',\n                                          format: 'a4'\n                                    });\n\n                                    // 计算合适的图像尺寸以适合A4页面\n                                    const imgWidth = 210; // A4宽度，单位mm\n                                    const pageHeight = 297; // A4高度，单位mm\n                                    const imgHeight = canvas.height * imgWidth / canvas.width;\n\n                                    let heightLeft = imgHeight;\n                                    let position = 0;\n\n                                    // 添加第一页\n                                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n                                    heightLeft -= pageHeight;\n\n                                    // 如果内容超过一页，添加更多页面\n                                    while (heightLeft > 0) {\n                                          position = heightLeft - imgHeight;\n                                          pdf.addPage();\n                                          pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n                                          heightLeft -= pageHeight;\n                                    }\n\n                                    // 添加文件名，包含时间戳以避免重复\n                                    const timestamp = now.getTime();\n                                    const filename = `PCB缺陷检测报告_${timestamp}.pdf`;\n\n                                    // 保存PDF文件\n                                    pdf.save(filename);\n\n                                    // 清理临时DOM元素\n                                    document.body.removeChild(reportContainer);\n\n                                    // 关闭加载提示并显示成功消息\n                                    message.destroy();\n                                    message.success('报告已成功导出');\n                              });\n                        });\n                  });\n            } catch (error) {\n                  // 发生错误时关闭加载提示并显示错误消息\n                  message.destroy();\n                  console.error(\"导出报告出错:\", error);\n                  message.error('导出报告失败: ' + error.message);\n\n                  // 确保清理可能的临时DOM元素\n                  const reportContainer = document.querySelector('div[style*=\"-9999px\"]');\n                  if (reportContainer) {\n                        document.body.removeChild(reportContainer);\n                  }\n            }\n      };\n\n      const getChartOption = () => {\n            // 检查是否有有效的统计数据\n            const defectTypes = detectionResults?.statistics?.defect_types;\n            if (!defectTypes || Object.keys(defectTypes).length === 0) {\n                  return {\n                        tooltip: { trigger: 'item' },\n                        legend: { show: false },\n                        series: [] // 返回空的 series，避免绘制灰色圆\n                  };\n            }\n\n            // 获取所有缺陷类型\n            const defectNames = Object.keys(defectTypes);\n\n            // 为每种缺陷类型生成对应的颜色\n            const colors = defectNames.map(name => {\n                  // 将中文名称映射到英文键名以获取颜色\n                  const colorKey = (() => {\n                        switch (name) {\n                              case '鼠咬': return 'mouse_bite';\n                              case '开路': return 'open_circuit';\n                              case '短路': return 'short';\n                              case '毛刺': return 'spur';\n                              case '杂铜': return 'spurious_copper';\n                              default: return name.toLowerCase();\n                        }\n                  })();\n\n                  return getDefectColor(colorKey);\n            });\n\n            return {\n                  tooltip: {\n                        trigger: 'item',\n                        formatter: '{a} <br/>{b}: {c} ({d}%)'\n                  },\n                  legend: {\n                        orient: 'horizontal',\n                        bottom: 10,\n                        left: 'center',\n                        data: defectNames,\n                        itemGap: 15,\n                        height: 50\n                  },\n                  color: colors,\n                  series: [\n                        {\n                              name: '缺陷类型',\n                              type: 'pie',\n                              radius: '65%',\n                              center: ['50%', '40%'],\n                              data: Object.entries(defectTypes).map(([name, value]) => ({\n                                    value,\n                                    name\n                              })),\n                              label: {\n                                    show: true,\n                                    position: 'outside',\n                                    alignTo: 'labelLine',\n                                    margin: 20,\n                                    formatter: '{b}\\n{c} ({d}%)',\n                                    lineHeight: 15,\n                                    rich: {\n                                          b: {\n                                                width: 60,\n                                                align: 'left'\n                                          }\n                                    }\n                              },\n                              labelLine: {\n                                    show: true,\n                                    length: 15,\n                                    length2: 20,\n                                    minTurnAngle: 120,\n                                    maxSurfaceAngle: 80\n                              },\n                              emphasis: {\n                                    itemStyle: {\n                                          shadowBlur: 10,\n                                          shadowOffsetX: 0,\n                                          shadowColor: 'rgba(0, 0, 0, 0.5)'\n                                    }\n                              }\n                        }\n                  ]\n            };\n      };\n      const handleImageWrapperClick = (e) => {\n            // 获取图片元素\n            const img = imageWrapperRef.current?.querySelector('img');\n            if (!img) return;\n\n            // 获取图片元素的位置和尺寸\n            const imgRect = img.getBoundingClientRect();\n\n            // 检查点击是否在图片区域外\n            const isOutsideImage = (\n                  e.clientX < imgRect.left ||\n                  e.clientX > imgRect.right ||\n                  e.clientY < imgRect.top ||\n                  e.clientY > imgRect.bottom\n            );\n\n            if (isOutsideImage) {\n                  // 重置缩放和位置\n                  setScale(1);\n                  setPosition({ x: 0, y: 0 });\n            }\n      };\n\n      const handleLoginSuccess = (user) => {\n            setIsLoggedIn(true);\n            setCurrentUser(user);\n      };\n\n      const handleLogout = () => {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            setIsLoggedIn(false);\n            setCurrentUser(null);\n      };\n\n      // 添加在其他useEffect之后\n      // 监听imageDimensions的变化，确保在渲染边界框前已获取图像尺寸\n      useEffect(() => {\n            // 当imageDimensions变化时，重新计算和应用边界框\n            if (imageDimensions && detectionResults && detectionResults.defects) {\n                  console.log('图像尺寸更新，重新应用边界框:', imageDimensions);\n                  // 触发边界框重新应用\n                  filterDefects(defectFilter);\n            }\n      }, [imageDimensions]);\n\n      // 添加一个useEffect来监听视频元素的大小和位置变化\n      useEffect(() => {\n            if (isCameraActive && videoRef.current) {\n                  // 创建一个ResizeObserver来监听视频元素的大小变化\n                  const resizeObserver = new ResizeObserver(() => {\n                        // 触发边界框重新渲染\n                        if (processedResults && processedResults.length > 0) {\n                              console.log('视频元素尺寸变化，重新应用边界框');\n                              // 创建一个新的过滤结果副本以触发渲染\n                              setProcessedResults([...processedResults]);\n                        }\n                  });\n\n                  // 开始观察视频元素\n                  resizeObserver.observe(videoRef.current);\n\n                  // 清理函数\n                  return () => {\n                        resizeObserver.disconnect();\n                  };\n            }\n      }, [isCameraActive, videoRef.current, processedResults]);\n\n      if (!isLoggedIn) {\n            return <Login onLoginSuccess={handleLoginSuccess} />;\n      }\n\n      return (\n            <Layout className=\"app-container\">\n                  <Header className=\"header\">\n                        <div className=\"header-left\">\n                              <img src=\"/logo.svg\" alt=\"logo\" className=\"logo\" />\n                              <h1>基于YOLOv11和投票融合的PCB缺陷检测系统</h1>\n                        </div>\n                        <div className=\"header-right\">\n                              <SettingOutlined className=\"header-icon\" />\n                              <BulbOutlined className=\"header-icon\" />\n                              <Tooltip title=\"退出登录\">\n                                    <UserOutlined className=\"header-icon\" onClick={handleLogout} style={{ cursor: 'pointer' }} />\n                              </Tooltip>\n                        </div>\n                  </Header>\n                  <Layout style={{ padding: '24px', background: '#f0f2f5' }}>\n                        <div style={{ display: 'flex', gap: '24px', minWidth: 'fit-content' }}>\n                              <div className=\"sidebar\">\n                                    <Button\n                                          type=\"primary\"\n                                          className=\"start-detection-button\"\n                                          style={{\n                                                background: (isBatchProcessing && !isPaused) || isCapturing ? '#f5222d' : '#37c537',\n                                                border: 'none',\n                                          }}\n                                          onClick={handleBatchDetection}\n                                          icon={isBatchProcessing && !isPaused ? <LoadingOutlined /> : <SearchOutlined />}\n                                    >\n                                          {isCameraActive && isCapturing ? '停止检测' :\n                                                isCameraActive ? '开始检测' :\n                                                      isBatchProcessing ? (isPaused ? '继续检测' : '暂停检测') : '开始检测'}\n                                    </Button>\n                                    <div className=\"system-status-section\">\n                                          <h3>系统状态</h3>\n                                          <div className=\"status-item status-cpu\" style={{ display: 'flex', alignItems: 'flex-start' }}>\n                                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '50px' }}>\n                                                      <div className=\"status-icon status-icon-cpu\"></div>\n                                                      <span className=\"status-value\" style={{\n                                                            marginTop: '5px',\n                                                            backgroundColor: 'rgba(24, 144, 255, 0.2)',\n                                                            padding: '2px 8px',\n                                                            borderRadius: '10px',\n                                                            fontSize: '12px',\n                                                            color: '#1890ff',\n                                                            textAlign: 'center'\n                                                      }}>\n                                                            {Math.min(Math.max(Math.round(systemStatus.cpuUsage || 0), 0), 100)}%\n                                                      </span>\n                                                </div>\n                                                <div className=\"status-content\" style={{ marginLeft: '10px', marginTop: '2px' }}>\n                                                      <div className=\"status-header\">\n                                                            <span className=\"status-label\">CPU使用率</span>\n                                                      </div>\n                                                      <div style={{ position: 'relative' }}>\n                                                            <Progress\n                                                                  percent={Math.min(Math.max(Math.round(systemStatus.cpuUsage || 0), 0), 100)}\n                                                                  size=\"small\"\n                                                                  status={systemStatus.cpuUsage > 80 ? 'exception' : 'normal'}\n                                                                  showInfo={false}\n                                                                  strokeColor={{\n                                                                        '0%': '#108ee9',\n                                                                        '100%': systemStatus.cpuUsage > 80 ? '#f5222d' : '#52c41a',\n                                                                  }}\n                                                            />\n                                                      </div>\n                                                </div>\n                                          </div>\n                                          <div className=\"status-item status-memory\" style={{ display: 'flex', alignItems: 'flex-start' }}>\n                                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '50px' }}>\n                                                      <div className=\"status-icon status-icon-memory\"></div>\n                                                      <span className=\"status-value\" style={{\n                                                            marginTop: '5px',\n                                                            backgroundColor: 'rgba(114, 46, 209, 0.2)',\n                                                            padding: '2px 8px',\n                                                            borderRadius: '10px',\n                                                            fontSize: '12px',\n                                                            color: '#722ed1',\n                                                            textAlign: 'center'\n                                                      }}>\n                                                            {Math.min(Math.max(Math.round(systemStatus.memoryUsage || 0), 0), 100)}%\n                                                      </span>\n                                                </div>\n                                                <div className=\"status-content\" style={{ marginLeft: '10px', marginTop: '2px' }}>\n                                                      <div className=\"status-header\">\n                                                            <span className=\"status-label\">内存使用率</span>\n                                                      </div>\n                                                      <div style={{ position: 'relative' }}>\n                                                            <Progress\n                                                                  percent={Math.min(Math.max(Math.round(systemStatus.memoryUsage || 0), 0), 100)}\n                                                                  size=\"small\"\n                                                                  status={systemStatus.memoryUsage > 80 ? 'exception' : 'normal'}\n                                                                  showInfo={false}\n                                                                  strokeColor={{\n                                                                        '0%': '#722ed1',\n                                                                        '100%': systemStatus.memoryUsage > 80 ? '#f5222d' : '#13c2c2',\n                                                                  }}\n                                                            />\n                                                      </div>\n                                                </div>\n                                          </div>\n                                          <div className=\"status-item status-time\" style={{ display: 'flex', alignItems: 'flex-start' }}>\n                                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '50px' }}>\n                                                      <div className=\"status-icon status-icon-time\"></div>\n                                                </div>\n                                                <div className=\"status-content\" style={{ marginLeft: '10px', marginTop: '2px' }}>\n                                                      <div className=\"status-header\">\n                                                            <span className=\"status-label\">运行时长</span>\n                                                      </div>\n                                                      <div style={{\n                                                            display: 'flex',\n                                                            justifyContent: 'center',\n                                                            marginTop: '5px'\n                                                      }}>\n                                                            <span className=\"status-time-value\" style={{\n                                                                  backgroundColor: 'rgba(250, 173, 20, 0.2)',\n                                                                  padding: '4px 12px',\n                                                                  borderRadius: '30px',\n                                                                  fontSize: '12px',\n                                                                  color: '#faad14',\n                                                                  whiteSpace: 'nowrap',\n                                                                  textAlign: 'center'\n                                                            }}>\n                                                                  {isBatchProcessing || isCapturing ? currentRunTime : (endTime && startTime ? calculateUptime() : '0秒')}\n                                                            </span>\n                                                      </div>\n                                                </div>\n                                          </div>\n                                    </div>\n                                    <div className=\"sidebar-actions\">\n                                          <Upload\n                                                accept=\"image/*\"\n                                                showUploadList={false}\n                                                beforeUpload={handleImageUpload}\n                                                disabled={isUploading || loading || isCameraActive}\n                                          >\n                                                <Button className=\"action-btn\" style={{ width: '160px' }} icon={<UploadOutlined className=\"btn-icon\" />} disabled={isUploading || loading || isCameraActive}>\n                                                      导入图像\n                                                </Button>\n                                          </Upload>\n                                          <Upload\n                                                directory\n                                                multiple\n                                                accept=\"image/*\"\n                                                showUploadList={false}\n                                                beforeUpload={() => false}\n                                                onChange={debouncedHandleFolderUpload}\n                                                disabled={isUploading || loading || isCameraActive}\n                                                fileList={[]}\n                                          >\n                                                <Button className=\"action-btn\" style={{ width: '160px' }} icon={<FolderOutlined className=\"btn-icon\" />} disabled={isUploading || loading || isCameraActive}>\n                                                      导入文件夹\n                                                </Button>\n                                          </Upload>\n                                          {/* 添加摄像头按钮 */}\n                                          <Button\n                                                className=\"action-btn\"\n                                                icon={isCameraActive ? <VideoCameraOutlined className=\"btn-icon\" /> : <CameraOutlined className=\"btn-icon\" />}\n                                                onClick={handleOpenCamera}\n                                                style={{ width: '160px', color: isCameraActive ? '#f5222d' : '' }}\n                                          >\n                                                {isCameraActive ? '关闭摄像头' : '打开摄像头'}\n                                          </Button>\n                                          <Button className=\"action-btn\" style={{ width: '160px' }} icon={<SearchOutlined className=\"btn-icon\" />} onClick={handleExportResults}>\n                                                导出结果\n                                          </Button>\n                                          <Button className=\"action-btn\" style={{ width: '160px' }} icon={<FileTextOutlined className=\"btn-icon\" />} onClick={handleExportReport}>\n                                                导出报告\n                                          </Button>\n                                    </div>\n                              </div>\n\n                              <div className=\"image-section\">\n                                    <div className=\"image-container\" style={\n                                          {\n                                                height: '100%',\n                                                width: '100%',\n                                                overflow: 'hidden'\n                                          }\n                                    }>\n                                          <div className=\"image-wrapper\"\n                                                onMouseEnter={() => setShowNavigation(true)}\n                                                onMouseLeave={() => {\n                                                      setShowNavigation(false);\n                                                      handleMouseLeave();\n                                                }}\n                                                onClick={handleImageWrapperClick}\n                                          >\n                                                {isCameraActive ? (\n                                                      // 摄像头模式保持不变\n                                                      <div\n                                                            ref={imageWrapperRef}\n                                                            className=\"image-scale-wrapper camera-active\"\n                                                            style={{\n                                                                  position: 'relative',\n                                                                  width: '100%',\n                                                                  height: '100%',\n                                                                  backgroundColor: '#000',\n                                                                  overflow: 'hidden'\n                                                            }}\n                                                      >\n                                                            {/* 视频元素 */}\n                                                            <video\n                                                                  ref={videoRef}\n                                                                  autoPlay\n                                                                  playsInline\n                                                                  muted\n                                                                  style={{\n                                                                        position: 'absolute',\n                                                                        top: 0,\n                                                                        left: 0,\n                                                                        width: '100%',\n                                                                        height: '100%',\n                                                                        objectFit: 'contain',\n                                                                        display: 'block',\n                                                                        zIndex: 10\n                                                                  }}\n                                                            />\n\n                                                            {/* 边界框层 */}\n                                                            <div\n                                                                  style={{\n                                                                        position: 'absolute',\n                                                                        top: 0,\n                                                                        left: 0,\n                                                                        width: '100%',\n                                                                        height: '100%',\n                                                                        pointerEvents: 'none',\n                                                                        zIndex: 20\n                                                                  }}\n                                                            >\n                                                                  {renderBoundingBoxes()}\n                                                            </div>\n\n                                                            {/* 检测状态指示 */}\n                                                            {isCapturing && (\n                                                                  <div\n                                                                        style={{\n                                                                              position: 'absolute',\n                                                                              top: 10,\n                                                                              right: 10,\n                                                                              backgroundColor: 'rgba(24, 144, 255, 0.8)',\n                                                                              color: 'white',\n                                                                              padding: '4px 8px',\n                                                                              borderRadius: '4px',\n                                                                              fontSize: '12px',\n                                                                              zIndex: 30\n                                                                        }}\n                                                                  >\n                                                                        实时检测中...\n                                                                  </div>\n                                                            )}\n                                                      </div>\n                                                ) : selectedImage ? (\n                                                      <>\n                                                            <div\n                                                                  ref={imageWrapperRef}\n                                                                  className=\"image-scale-wrapper\"\n                                                                  onMouseDown={handleMouseDown}\n                                                                  onMouseMove={handleMouseMove}\n                                                                  onMouseUp={handleMouseUp}\n                                                                  onMouseLeave={handleMouseLeave}\n                                                                  onWheel={handleWheel}\n                                                                  style={{\n                                                                        cursor: isDragging ? 'grabbing' : 'grab',\n                                                                        position: 'relative',\n                                                                        width: imageDimensions?.width || 'auto',\n                                                                        height: imageDimensions?.height || 'auto',\n                                                                        maxWidth: '600px',\n                                                                        maxHeight: '600px'\n                                                                  }}\n                                                            >\n                                                                  {/* 使用相对定位，并在transform中应用缩放和平移 */}\n                                                                  <div style={{\n                                                                        position: 'relative',\n                                                                        width: '100%',\n                                                                        height: '100%',\n                                                                        transform: `scale(${scale}) translate(${position.x / scale}px, ${position.y / scale}px)`,\n                                                                        transformOrigin: 'center',\n                                                                        transition: isDragging ? 'none' : 'transform 0.1s ease',\n                                                                  }}>\n                                                                        <img\n                                                                              src={selectedImage}\n                                                                              alt=\"PCB\"\n                                                                              style={{\n                                                                                    width: '100%',\n                                                                                    height: '100%',\n                                                                                    objectFit: 'contain',\n                                                                                    userSelect: 'none'\n                                                                              }}\n                                                                              draggable={false}\n                                                                        />\n                                                                        {/* 边界框相对于图像定位 */}\n                                                                        {renderBoundingBoxes()}\n                                                                  </div>\n                                                            </div>\n                                                            {imageList.length > 1 && showNavigation && (\n                                                                  <div className=\"image-navigation\">\n                                                                        <Button\n                                                                              icon={<LeftOutlined />}\n                                                                              onClick={handlePrevImage}\n                                                                              disabled={currentImageIndex === 0}\n                                                                        />\n                                                                        <Button\n                                                                              icon={<RightOutlined />}\n                                                                              onClick={handleNextImage}\n                                                                              disabled={currentImageIndex === imageList.length - 1}\n                                                                        />\n                                                                  </div>\n                                                            )}\n                                                      </>\n                                                ) : (\n                                                      <div className=\"upload-placeholder\">\n                                                            <Upload\n                                                                  accept=\"image/*\"\n                                                                  showUploadList={false}\n                                                                  beforeUpload={handleImageUpload} // 处理单个图片上传\n                                                                  onDrop={(e) => {\n                                                                        const file = e.dataTransfer.files[0];\n                                                                        if (file) {\n                                                                              handleImageUpload(file);\n                                                                        }\n                                                                  }}\n                                                            >\n                                                                  <div style={{ textAlign: 'center', cursor: 'pointer' }}>\n                                                                        <UploadOutlined style={{ fontSize: '24px', marginBottom: '8px' }} />\n                                                                        <p>点击或拖拽上传图片</p>\n                                                                  </div>\n                                                            </Upload>\n                                                      </div>\n                                                )}\n                                          </div>\n                                          <div className=\"detection-progress\">\n                                                <span>检测进度:</span>\n                                                <div style={{\n                                                      display: 'flex',\n                                                      alignItems: 'center',\n                                                      marginTop: '5px',\n                                                      gap: '10px'\n                                                }}>\n                                                      <div style={{ flex: 1, position: 'relative' }}>\n                                                            <Progress\n                                                                  percent={detectionProgress}\n                                                                  showInfo={false}\n                                                            />\n                                                      </div>\n                                                      <span style={{\n                                                            fontSize: '14px',\n                                                            color: '#1890ff',\n                                                            fontWeight: '500'\n                                                      }}>\n                                                            {detectionProgress}%\n                                                      </span>\n                                                </div>\n                                          </div>\n                                          {imageList.length > 1 && (\n                                                <div className=\"image-pagination\">\n                                                      <Pagination\n                                                            current={currentImageIndex + 1}\n                                                            total={imageList.length}\n                                                            pageSize={1}\n                                                            onChange={handlePageChange}\n                                                            size=\"small\"\n                                                            showQuickJumper\n                                                            showSizeChanger={false}\n                                                      />\n                                                </div>\n                                          )}\n                                    </div>\n                              </div>\n\n                              <div className=\"results-section\" >\n                                    <div className=\"results-header\">\n                                          <h2>检测结果</h2>\n                                          <Select\n                                                style={{ width: '100%', marginTop: '8px' }}\n                                                value={defectFilter}\n                                                onChange={handleDefectFilterChange}\n                                          >\n                                                {defectTypes.map(type => (\n                                                      <Select.Option key={type} value={type}>\n                                                            {type === 'all' ? '全部缺陷' : type}\n                                                      </Select.Option>\n                                                ))}\n                                          </Select>\n                                    </div>\n                                    {/* 检测结果列表部分 */}\n                                    <div\n                                          className=\"defects-container\"\n                                          style={{\n                                                height: '350px', // 固定高度\n                                                overflow: 'auto',\n                                                marginBottom: '16px',\n                                          }}\n                                    >\n                                          <div\n                                                className=\"defects-list\"\n                                                ref={defectsListRef}\n                                          >\n                                                {processedResults.length > 0 ? (\n                                                      processedResults.map((defect, index) => (\n                                                            <div key={index} className=\"defect-item\">\n                                                                  <div className=\"defect-info\">\n                                                                        <h4><span className=\"label-width\">类别:</span> {defect.type}</h4>\n                                                                        {defect.bbox && (\n                                                                              <p className=\"coordinates-info\">\n                                                                                    <span className=\"coord-row\">\n                                                                                          <span className=\"label-width\">坐标:</span>\n                                                                                          <span className=\"coord-pair\">x1={defect.bbox.x1}</span>\n                                                                                          <span className=\"coord-pair\">y1={defect.bbox.y1}</span>\n                                                                                    </span>\n                                                                                    <span className=\"coord-row\">\n                                                                                          <span className=\"label-width\"></span>\n                                                                                          <span className=\"coord-pair\">x2={defect.bbox.x2}</span>\n                                                                                          <span className=\"coord-pair\">y2={defect.bbox.y2}</span>\n                                                                                    </span>\n                                                                              </p>\n                                                                        )}\n                                                                        {defect.confidence && <p><span className=\"label-width\">置信度:</span> {defect.confidence}%</p>}\n                                                                  </div>\n                                                            </div>\n                                                      ))\n                                                ) : (\n                                                      <div className=\"defect-item empty-defect\">\n                                                            <div className=\"defect-info\">\n                                                                  <h4>暂无检测结果</h4>\n                                                                  <p>开始检测后将在此显示详细信息</p>\n                                                            </div>\n                                                      </div>\n                                                )}\n                                          </div>\n                                    </div>\n                                    {/* 饼图和图例部分 */}\n                                    <div className=\"statistics-section\" style={{ flex: '2', minHeight: '300px', display: 'flex', flexDirection: 'column' }}>\n                                          {detectionResults.statistics.defect_types && Object.keys(detectionResults.statistics.defect_types).length > 0 ? (\n                                                <ReactECharts\n                                                      option={getChartOption()}\n                                                      style={{ height: '100%', flex: 1 }}\n                                                      notMerge={true}\n                                                />\n                                          ) : (\n                                                <div style={{\n                                                      display: 'flex',\n                                                      flexDirection: 'column',\n                                                      justifyContent: 'center',\n                                                      alignItems: 'center',\n                                                      height: '100%',\n                                                      color: '#aaa'\n                                                }}>\n                                                      <p style={{ margin: 0 }}>检测完成后将在此显示统计数据</p>\n                                                      <p style={{ margin: 0 }}>\n                                                            可检测: 鼠咬, 开路, 短路, 毛刺和杂铜等\n                                                      </p>\n                                                </div>\n                                          )}\n                                    </div>\n                              </div>\n\n                              <div className=\"model-section\">\n                                    <div className=\"model-header\">\n                                          <h2>模型管理</h2>\n                                          <Select\n                                                value={selectedModel}\n                                                onChange={handleModelChange}\n                                                style={{ width: '100%' }}\n                                          >\n                                                <Select.Option value=\"yolov11\">Yolov11</Select.Option>\n                                                <Select.Option value=\"yolov11-vote2\">Yolov11-vote2</Select.Option>\n                                                <Select.Option value=\"yolov11-vote4\">Yolov11-vote4</Select.Option>\n                                          </Select>\n                                    </div>\n                                    <div className=\"metrics\">\n                                          <div className=\"metric-item\">\n                                                <span>Precision</span>\n                                                <span className=\"metric-value\">\n                                                      {selectedModel === 'yolov11' ? '97.72%' :\n                                                            selectedModel === 'yolov11-vote2' ? '97.45%' :\n                                                                  '96.99%'}\n                                                </span>\n                                          </div>\n                                          <div className=\"metric-item\">\n                                                <span>Recall</span>\n                                                <span className=\"metric-value\">\n                                                      {selectedModel === 'yolov11' ? '84.41%' :\n                                                            selectedModel === 'yolov11-vote2' ? '85.97%' :\n                                                                  '87.32%'}\n                                                </span>\n                                          </div>\n                                          <div className=\"metric-item\">\n                                                <span>mAP@0.5</span>\n                                                <span className=\"metric-value\">\n                                                      {selectedModel === 'yolov11' ? '92.39%' :\n                                                            selectedModel === 'yolov11-vote2' ? '93.02%' :\n                                                                  '93.58%'}\n                                                </span>\n                                          </div>\n                                          <div className=\"metric-item\">\n                                                <span>mAP@0.5:0.95</span>\n                                                <span className=\"metric-value\">\n                                                      {selectedModel === 'yolov11' ? '68.18%' :\n                                                            selectedModel === 'yolov11-vote2' ? '69.20%' :\n                                                                  '69.49%'}\n                                                </span>\n                                          </div>\n                                    </div>\n                                    <div className=\"threshold-settings\">\n                                          <h3>阈值设置</h3>\n                                          <div className=\"threshold-item\">\n                                                <span>IoU 阈值</span>\n                                                <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                                                      {/* 左侧显示当前值并支持用户输入 */}\n                                                      <div className=\"custom-input-number\">\n                                                            <InputNumber\n                                                                  min={0.1}\n                                                                  max={1.0}\n                                                                  step={0.01}\n                                                                  value={iouThreshold}\n                                                                  onChange={(value) => setIouThreshold(value || 0.1)} // 防止输入为空\n                                                                  style={{ width: '80px' }}\n                                                                  controls={false}\n                                                                  className=\"threshold-input\"\n                                                            />\n                                                            <div className=\"custom-controls\">\n                                                                  <div className=\"control-up\" onClick={() => {\n                                                                        const newValue = parseFloat((iouThreshold + 0.01).toFixed(2));\n                                                                        if (newValue <= 1.0) setIouThreshold(newValue);\n                                                                  }}>\n                                                                        <div className=\"control-icon\">+</div>\n                                                                  </div>\n                                                                  <div className=\"control-down\" onClick={() => {\n                                                                        const newValue = parseFloat((iouThreshold - 0.01).toFixed(2));\n                                                                        if (newValue >= 0.1) setIouThreshold(newValue);\n                                                                  }}>\n                                                                        <div className=\"control-icon\">-</div>\n                                                                  </div>\n                                                            </div>\n                                                      </div>\n                                                      {/* 右侧滑动条 */}\n                                                      <Slider\n                                                            min={0.1}\n                                                            max={1.0}\n                                                            step={0.01}\n                                                            value={iouThreshold}\n                                                            onChange={(value) => setIouThreshold(value)}\n                                                            tooltip={{ formatter: (value) => `IoU: ${value.toFixed(2)}` }}\n                                                            style={{ flex: 1 }}\n                                                      />\n                                                </div>\n                                          </div>\n                                          <div className=\"threshold-item\">\n                                                <span>置信度阈值</span>\n                                                <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                                                      {/* 左侧显示当前值并支持用户输入 */}\n                                                      <div className=\"custom-input-number\">\n                                                            <InputNumber\n                                                                  min={0.1}\n                                                                  max={1.0}\n                                                                  step={0.01}\n                                                                  value={confThreshold}\n                                                                  onChange={(value) => setConfThreshold(value || 0.1)} // 防止输入为空\n                                                                  style={{ width: '80px' }}\n                                                                  controls={false}\n                                                                  className=\"threshold-input\"\n                                                            />\n                                                            <div className=\"custom-controls\">\n                                                                  <div className=\"control-up\" onClick={() => {\n                                                                        const newValue = parseFloat((confThreshold + 0.01).toFixed(2));\n                                                                        if (newValue <= 1.0) setConfThreshold(newValue);\n                                                                  }}>\n                                                                        <div className=\"control-icon\">+</div>\n                                                                  </div>\n                                                                  <div className=\"control-down\" onClick={() => {\n                                                                        const newValue = parseFloat((confThreshold - 0.01).toFixed(2));\n                                                                        if (newValue >= 0.1) setConfThreshold(newValue);\n                                                                  }}>\n                                                                        <div className=\"control-icon\">-</div>\n                                                                  </div>\n                                                            </div>\n                                                      </div>\n                                                      {/* 右侧滑动条 */}\n                                                      <Slider\n                                                            min={0.1}\n                                                            max={1.0}\n                                                            step={0.01}\n                                                            value={confThreshold}\n                                                            onChange={(value) => setConfThreshold(value)}\n                                                            tooltip={{ formatter: (value) => `Conf: ${value.toFixed(2)}` }}\n                                                            style={{ flex: 1 }}\n                                                      />\n                                                </div>\n                                          </div>\n                                    </div>\n                              </div>\n                        </div>\n                  </Layout>\n            </Layout>\n      );\n}\n\nexport default App","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport 'antd/dist/antd.css';\r\n\r\nReactDOM.render(\r\n      <React.StrictMode>\r\n            <App />\r\n      </React.StrictMode>,\r\n      document.getElementById('root')\r\n);"],"sourceRoot":""}