{"version":3,"sources":["components/Login.js","App.js","index.js"],"names":["TabPane","Tabs","createAxiosInstance","hostname","window","location","baseURL","protocol","axios","create","withCredentials","Login","_ref","onLoginSuccess","activeTab","setActiveTab","useState","loading","setLoading","loginForm","Form","useForm","registerForm","useEffect","resetFields","_jsx","className","style","backgroundImage","backgroundRepeat","backgroundPosition","backgroundSize","children","_jsxs","activeKey","onChange","centered","tab","SafetyOutlined","form","name","onFinish","async","axiosInstance","data","post","values","timeout","status","message","success","localStorage","setItem","token","JSON","stringify","user","error","console","code","includes","defaults","response","layout","size","Item","rules","required","Input","prefix","UserOutlined","placeholder","suffix","Tooltip","title","InfoCircleOutlined","color","Password","LockOutlined","Button","type","htmlType","block","username","password","email","phone","setFieldsValue","MailOutlined","pattern","PhoneOutlined","min","dependencies","_ref2","getFieldValue","validator","_","value","Promise","reject","Error","resolve","API_BASE_URL","host","Header","Sider","Content","Layout","App","systemStatus","setSystemStatus","cpuUsage","memoryUsage","uptime","detectionResults","setDetectionResults","defects","statistics","defect_types","selectedImage","setSelectedImage","detectionProgress","setDetectionProgress","zoomLevel","setZoomLevel","imageList","setImageList","currentImageIndex","setCurrentImageIndex","isBatchProcessing","setIsBatchProcessing","batchProgress","setBatchProgress","showNavigation","setShowNavigation","detectionHistory","setDetectionHistory","previewUrls","setPreviewUrls","isUploading","setIsUploading","isDragging","setIsDragging","dragStart","setDragStart","x","y","imagePosition","setImagePosition","scale","setScale","position","setPosition","imageWrapperRef","useRef","isPaused","setIsPaused","defectFilter","setDefectFilter","processedResults","setProcessedResults","defectTypes","setDefectTypes","isPausedRef","isCameraActive","setIsCameraActive","videoStream","setVideoStream","videoRef","isCapturing","setIsCapturing","captureInterval","setCaptureInterval","currentRunTime","setCurrentRunTime","runTimeInterval","setRunTimeInterval","defectsListRef","defectsListHover","setDefectsListHover","isLoggedIn","setIsLoggedIn","currentUser","setCurrentUser","imageDimensions","setImageDimensions","startTimeRef","fetchSystemStatus","get","cpu_usage","memory_usage","statusInterval","setInterval","clearInterval","current","log","srcObject","play","then","catch","err","forEach","url","URL","revokeObjectURL","getTracks","track","stop","getItem","parse","resetImageAndDetectionStates","e","toggleContinuousCapture","setStartTime","setEndTime","end","Date","now","finalDuration","Math","floor","hours","minutes","info","warning","paused","ended","start","timeInterval","duration","readyState","interval","warn","playErr","capturedFrame","captureVideoFrame","videoWidth","videoHeight","newWidth","newHeight","round","captureCanvas","document","createElement","width","height","getContext","drawImage","scaleCanvas","toBlob","blob","file","File","toLocaleTimeString","result","processImage","length","resetAllStates","filterDefects","filterType","filtered","filter","defect","toLowerCase","types","push","getDefectColor","defectType","renderBoundingBoxes","videoPosition","left","top","scaleFactor","videoElement","videoRect","getComputedStyle","getBoundingClientRect","parentRect","parentElement","scaleX","scaleY","imageSize","boxOffset","map","index","bbox","x1","y1","x2","y2","offsetX","offsetY","wrapperRect","containerW","containerH","imgW","imgH","imgRatio","contentW","contentH","border","backgroundColor","pointerEvents","zIndex","background","padding","fontSize","whiteSpace","confidence","boxWidth","boxHeight","handleImageUpload","img","Image","onload","canvas","resizedFile","imageUrl","createObjectURL","onerror","src","debouncedHandleFolderUpload","debounce","func","delay","debounceTimer","_len","arguments","args","Array","_key","context","this","clearTimeout","setTimeout","apply","fileList","newFiles","fileObj","originFileObj","startsWith","urls","resetImagePosition","handleImageChange","selectedModel","setSelectedModel","iouThreshold","setIouThreshold","confThreshold","setConfThreshold","formData","FormData","append","params","vote_threshold","orientation_count","iou_threshold","conf_threshold","img_width","img_height","startTime","endTime","handleImageScrolling","targetElement","target","isInsideImageWrapper","preventDefault","addEventListener","passive","removeEventListener","body","overflow","documentElement","handleMouseLeave","handleLoginSuccess","resizeObserver","ResizeObserver","observe","disconnect","alt","SettingOutlined","BulbOutlined","onClick","handleLogout","removeItem","cursor","display","gap","minWidth","newPauseState","history","i","checkPauseInterval","progress","icon","LoadingOutlined","SearchOutlined","alignItems","flexDirection","marginTop","borderRadius","textAlign","max","marginLeft","Progress","percent","showInfo","strokeColor","justifyContent","calculateUptime","Upload","accept","showUploadList","beforeUpload","disabled","UploadOutlined","directory","multiple","FolderOutlined","VideoCameraOutlined","CameraOutlined","navigator","mediaDevices","getUserMedia","stream","video","ideal","showDirectoryPicker","directoryHandle","annotatedImagesFolder","getDirectoryHandle","jsonFolder","_detectionHistory$i2","_detectionHistory$i2$","_detectionHistory$i3","_detectionHistory$i3$","imageName","split","slice","join","annotatedImageName","annotatedImageHandle","getFileHandle","writableStream","createWritable","image","_detectionHistory$i","_detectionHistory$i$r","strokeStyle","lineWidth","strokeRect","fillStyle","font","fillText","write","close","jsonFileName","jsonFileHandle","jsonWritableStream","jsonResult","FileTextOutlined","handleExportReport","reportContainer","appendChild","dateStr","toLocaleDateString","timeStr","batchStatistics","totalImages","totalDefects","defectTypeCounts","imagesWithDefects","averageDefectsPerImage","toFixed","batchStatsRows","Object","entries","count","percentage","currentImageDefectsRows","positionStr","innerHTML","html2canvasModule","html2canvas","default","useCORS","logging","jsPdfModule","jsPDF","imgData","toDataURL","pdf","orientation","unit","format","imgHeight","heightLeft","addImage","addPage","filename","getTime","save","removeChild","destroy","querySelector","onMouseEnter","onMouseLeave","_imageWrapperRef$curr2","imgRect","clientX","right","clientY","bottom","ref","autoPlay","playsInline","muted","objectFit","_Fragment","onMouseDown","button","onMouseMove","newX","newY","maxOffset","boundedX","boundedY","onMouseUp","handleMouseUp","onWheel","_imageWrapperRef$curr","delta","deltaY","newScale","rect","mouseX","mouseY","centerX","centerY","scaleChange","newPosition","maxWidth","maxHeight","transform","transformOrigin","transition","userSelect","draggable","LeftOutlined","handlePrevImage","RightOutlined","handleNextImage","onDrop","dataTransfer","files","marginBottom","flex","fontWeight","Pagination","total","pageSize","page","showQuickJumper","showSizeChanger","Select","Option","minHeight","keys","ReactECharts","option","getChartOption","_detectionResults$sta","tooltip","trigger","legend","show","series","defectNames","colors","colorKey","formatter","orient","itemGap","radius","center","label","alignTo","margin","lineHeight","rich","b","align","labelLine","length2","minTurnAngle","maxSurfaceAngle","emphasis","itemStyle","shadowBlur","shadowOffsetX","shadowColor","notMerge","InputNumber","step","controls","newValue","parseFloat","Slider","ReactDOM","render","React","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.3ae5b672.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Form, Input, Button, message, Tabs, Tooltip } from 'antd';\nimport { UserOutlined, LockOutlined, MailOutlined, PhoneOutlined, SafetyOutlined, InfoCircleOutlined } from '@ant-design/icons';\nimport './Login.css';\nimport axios from 'axios';\n\nconst { TabPane } = Tabs;\n\n// 创建一个独立的axios实例，不受全局配置影响\nconst createAxiosInstance = () => {\n      const hostname = window.location.hostname;\n      const protocol = window.location.protocol;\n      const baseURL = `${protocol}//${hostname}:5000`;\n      // console.log('Login组件使用的API地址:', baseURL);\n\n      // 在UI上显示当前使用的API地址（调试用）\n      // window.currentApiUrl = baseURL;\n\n      return axios.create({\n            baseURL,\n            withCredentials: true\n      });\n};\n\n// Remove mock user data; use backend APIs for auth\n\nconst Login = ({ onLoginSuccess }) => {\n      const [activeTab, setActiveTab] = useState('login');\n      const [loading, setLoading] = useState(false);\n      // Create separate form instances for login and register\n      const [loginForm] = Form.useForm();\n      const [registerForm] = Form.useForm();\n\n      // 获取并显示API URL信息\n      useEffect(() => {\n      }, []);\n\n      // Reset form fields when switching tabs\n      useEffect(() => {\n            if (activeTab === 'login') {\n                  loginForm.resetFields();\n            } else {\n                  registerForm.resetFields();\n            }\n      }, [activeTab, loginForm, registerForm]);\n\n      // 使用本地图片\n      const pcbBackgroundUrl = '/output.png';\n\n      // Real backend login\n      const handleLogin = async (values) => {\n            setLoading(true);\n            let axiosInstance;\n            try {\n                  // 使用独立的axios实例发起请求\n                  axiosInstance = createAxiosInstance();\n                  // console.log('开始登录请求，API地址:', axiosInstance.defaults.baseURL);\n\n                  // 添加超时和错误处理\n                  const response = await axiosInstance.post('/api/login', values, {\n                        timeout: 10000  // 10秒超时\n                  });\n\n                  const data = response.data;\n                  if (data.status === 'success') {\n                        message.success('登录成功！');\n                        localStorage.setItem('token', data.token);\n                        localStorage.setItem('user', JSON.stringify(data.user));\n                        onLoginSuccess(data.user);\n                  } else {\n                        message.error(data.error || '登录失败');\n                  }\n            } catch (error) {\n                  console.error('登录请求出错:', error);\n\n                  // 详细的错误处理\n                  if (error.code === 'ECONNABORTED') {\n                        message.error('请求超时，服务器未响应');\n                  } else if (error.message && error.message.includes('Network Error')) {\n                        message.error(`网络错误: 无法连接到服务器 ${axiosInstance.defaults.baseURL}`);\n                  } else if (error.response) {\n                        // 服务器返回了错误状态码\n                        message.error(`服务器错误 (${error.response.status}): ${error.response.data.error || '未知错误'}`);\n                  } else {\n                        // 其他错误\n                        message.error(`登录失败: ${error.message || '未知错误'}`);\n                  }\n            } finally {\n                  setLoading(false);\n            }\n      };\n\n      // Real backend registration\n      const handleRegister = async (values) => {\n            setLoading(true);\n            let axiosInstance;\n            try {\n                  // 调用注册接口，使用独立的axios实例\n                  axiosInstance = createAxiosInstance();\n                  // console.log('开始注册请求，API地址:', axiosInstance.defaults.baseURL);\n\n                  // 添加超时和错误处理\n                  await axiosInstance.post('/api/register', {\n                        username: values.username,\n                        password: values.password,\n                        email: values.email,\n                        phone: values.phone\n                  }, {\n                        timeout: 10000 // 10秒超时\n                  });\n\n                  // 注册成功后跳转到登录标签\n                  message.success('注册成功！请登录');\n                  setActiveTab('login');\n                  // 在切换到登录标签后，预填充表单字段\n                  loginForm.setFieldsValue({ username: values.username, password: values.password });\n            } catch (error) {\n                  console.error('注册请求出错:', error);\n\n                  // 详细的错误处理\n                  if (error.code === 'ECONNABORTED') {\n                        message.error('请求超时，服务器未响应');\n                  } else if (error.message && error.message.includes('Network Error')) {\n                        message.error(`网络错误: 无法连接到服务器 ${axiosInstance.defaults.baseURL}`);\n                  } else if (error.response) {\n                        // 服务器返回了错误状态码\n                        message.error(`服务器错误 (${error.response.status}): ${error.response.data.error || '未知错误'}`);\n                  } else {\n                        // 其他错误\n                        message.error(`注册失败: ${error.message || '未知错误'}`);\n                  }\n            } finally {\n                  setLoading(false);\n            }\n      };\n\n      return (\n            <div className=\"login-container\" style={{\n                  backgroundImage: `url(${pcbBackgroundUrl})`,\n                  backgroundRepeat: 'no-repeat',\n                  backgroundPosition: 'center center',\n                  backgroundSize: 'cover'\n            }}>\n                  <div className=\"login-content\">\n                        <div className=\"login-header\">\n                              <h1>欢迎使用慧眼识瑕系统</h1>\n                              <p className=\"login-subtitle\">基于YOLOv11和投票融合的PCB缺陷检测系统</p>\n                        </div>\n\n                        <div className=\"login-box\">\n                              <div className=\"light-effect\"></div>\n                              <div className=\"light-effect\"></div>\n\n                              <Tabs activeKey={activeTab} onChange={setActiveTab} centered className=\"login-tabs\">\n                                    <TabPane tab=\"登录\" key=\"login\">\n                                          <div className=\"login-welcome\">\n                                                <SafetyOutlined className=\"login-welcome-icon\" />\n                                                <p>请输入您的账号信息，安全登录系统</p>\n                                          </div>\n                                          <Form\n                                                form={loginForm}\n                                                name=\"login\"\n                                                onFinish={handleLogin}\n                                                layout=\"vertical\"\n                                                size=\"large\"\n                                          >\n                                                <Form.Item\n                                                      name=\"username\"\n                                                      rules={[{ required: true, message: '请输入用户名' }]}\n                                                >\n                                                      <Input\n                                                            prefix={<UserOutlined />}\n                                                            placeholder=\"用户名\"\n                                                            suffix={\n                                                                  <Tooltip title=\"支持字母、数字和下划线组合\">\n                                                                        <InfoCircleOutlined style={{ color: 'rgba(0,0,0,.45)' }} />\n                                                                  </Tooltip>\n                                                            }\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"password\"\n                                                      rules={[{ required: true, message: '请输入密码' }]}\n                                                >\n                                                      <Input.Password\n                                                            prefix={<LockOutlined />}\n                                                            placeholder=\"密码\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item>\n                                                      <Button\n                                                            type=\"primary\"\n                                                            htmlType=\"submit\"\n                                                            block\n                                                            loading={loading}\n                                                            className=\"login-button\"\n                                                      >\n                                                            登录\n                                                      </Button>\n                                                </Form.Item>\n                                          </Form>\n                                    </TabPane>\n                                    <TabPane tab=\"注册\" key=\"register\">\n                                          <div className=\"login-welcome\">\n                                                <UserOutlined className=\"login-welcome-icon\" style={{ color: '#1890ff' }} />\n                                                <p>欢迎注册，请填写以下信息</p>\n                                          </div>\n                                          <Form\n                                                form={registerForm}\n                                                name=\"register\"\n                                                onFinish={handleRegister}\n                                                layout=\"vertical\"\n                                                size=\"large\"\n                                          >\n                                                <Form.Item\n                                                      name=\"username\"\n                                                      rules={[{ required: true, message: '请输入用户名' }]}\n                                                >\n                                                      <Input\n                                                            prefix={<UserOutlined />}\n                                                            placeholder=\"用户名\"\n                                                            suffix={\n                                                                  <Tooltip title=\"支持字母、数字和下划线组合\">\n                                                                        <InfoCircleOutlined style={{ color: 'rgba(0,0,0,.45)' }} />\n                                                                  </Tooltip>\n                                                            }\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"email\"\n                                                      rules={[\n                                                            { required: true, message: '请输入邮箱' },\n                                                            { type: 'email', message: '请输入有效的邮箱地址' }\n                                                      ]}\n                                                >\n                                                      <Input\n                                                            prefix={<MailOutlined />}\n                                                            placeholder=\"邮箱\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"phone\"\n                                                      rules={[\n                                                            { required: true, message: '请输入手机号' },\n                                                            { pattern: /^1[3-9]\\d{9}$/, message: '请输入有效的手机号' }\n                                                      ]}\n                                                >\n                                                      <Input\n                                                            prefix={<PhoneOutlined />}\n                                                            placeholder=\"手机号\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"password\"\n                                                      rules={[\n                                                            { required: true, message: '请输入密码' },\n                                                            { min: 6, message: '密码长度至少为6位' }\n                                                      ]}\n                                                >\n                                                      <Input.Password\n                                                            prefix={<LockOutlined />}\n                                                            placeholder=\"密码\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item\n                                                      name=\"confirmPassword\"\n                                                      dependencies={['password']}\n                                                      rules={[\n                                                            { required: true, message: '请确认密码' },\n                                                            ({ getFieldValue }) => ({\n                                                                  validator(_, value) {\n                                                                        if (!value || getFieldValue('password') === value) {\n                                                                              return Promise.resolve();\n                                                                        }\n                                                                        return Promise.reject(new Error('两次输入的密码不一致'));\n                                                                  },\n                                                            }),\n                                                      ]}\n                                                >\n                                                      <Input.Password\n                                                            prefix={<LockOutlined />}\n                                                            placeholder=\"确认密码\"\n                                                      />\n                                                </Form.Item>\n                                                <Form.Item>\n                                                      <Button\n                                                            type=\"primary\"\n                                                            htmlType=\"submit\"\n                                                            block\n                                                            loading={loading}\n                                                            className=\"login-button\"\n                                                      >\n                                                            注册\n                                                      </Button>\n                                                </Form.Item>\n                                          </Form>\n                                    </TabPane>\n                              </Tabs>\n\n                              <div className=\"login-footer\">\n                                    <p>技术支持: <span>从零开始的代码生活</span></p>\n                                    <p>系统版本: <span>V2.3.1</span></p>\n                              </div>\n                        </div>\n                  </div>\n            </div>\n      );\n};\n\nexport default Login; ","import React, { useState, useEffect, useRef } from 'react';\nimport { Layout, Button, Card, Statistic, Progress, Tabs, Upload, message, Select, Slider, Pagination, InputNumber, Spin, Tooltip } from 'antd';\nimport { CameraOutlined, VideoCameraOutlined, UploadOutlined, ZoomInOutlined, ZoomOutOutlined, SettingOutlined, BulbOutlined, UserOutlined, SearchOutlined, FolderOutlined, LeftOutlined, RightOutlined, LoadingOutlined } from '@ant-design/icons';\nimport ReactECharts from 'echarts-for-react';\n// 在文件顶部添加图标导入\nimport { PlayCircleOutlined, PauseCircleOutlined, FileTextOutlined } from '@ant-design/icons';\nimport axios from 'axios';\nimport { jsPDF } from 'jspdf';\nimport 'jspdf-autotable';\nimport './App.css';\nimport Login from './components/Login';\n\n// 添加API基础URL配置\nconst API_BASE_URL = `${window.location.protocol}//${window.location.host}`;\n\n// 配置axios默认值\naxios.defaults.baseURL = API_BASE_URL;\naxios.defaults.withCredentials = true; // 允许跨域请求携带凭证\n\n// 添加一个函数来更新API基础URL\n\n\nconst { Header, Sider, Content } = Layout;\nconst { TabPane } = Tabs;\n\nfunction App() {\n      const [systemStatus, setSystemStatus] = useState({\n            status: 'normal',\n            cpuUsage: 0,\n            memoryUsage: 0,\n            uptime: '0h 0m'\n      });\n\n      const [detectionResults, setDetectionResults] = useState({\n            defects: [],\n            statistics: {\n                  defect_types: {}\n            }\n      });\n\n      const [selectedImage, setSelectedImage] = useState(null);\n      const [loading, setLoading] = useState(false);\n      const [detectionProgress, setDetectionProgress] = useState(0);\n      const [zoomLevel, setZoomLevel] = useState(1);\n      const MIN_ZOOM = 0.5;\n      const MAX_ZOOM = 2;\n      const ZOOM_STEP = 0.1;\n\n      // 添加新的状态变量\n      const [imageList, setImageList] = useState([]); // 存储所有要处理的图片\n      const [currentImageIndex, setCurrentImageIndex] = useState(0); // 当前处理的图片索引\n      const [isBatchProcessing, setIsBatchProcessing] = useState(false); // 是否正在批量处理\n      const [batchProgress, setBatchProgress] = useState(0); // 批量处理进度\n      const [showNavigation, setShowNavigation] = useState(false);\n      const [detectionHistory, setDetectionHistory] = useState([]); // 存储所有图片的检测结果\n      const [previewUrls, setPreviewUrls] = useState([]); // 存储所有图片的URL\n      const [isUploading, setIsUploading] = useState(false);\n      const [isDragging, setIsDragging] = useState(false);\n      const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n      const [imagePosition, setImagePosition] = useState({ x: 0, y: 0 });\n      const [scale, setScale] = useState(1);\n      const [position, setPosition] = useState({ x: 0, y: 0 });\n      const imageWrapperRef = useRef(null);\n      const [isPaused, setIsPaused] = useState(false); // 是否暂停检测\n      // 添加缺陷过滤相关的状态变量\n      const [defectFilter, setDefectFilter] = useState('all');\n      const [processedResults, setProcessedResults] = useState([]);\n      const [defectTypes, setDefectTypes] = useState(['all', 'mouse_bite', 'open_circuit', 'short', 'spur', 'spurious_copper']);\n      const isPausedRef = useRef(false);\n\n      // 添加到其他state变量之后\n      const [isCameraActive, setIsCameraActive] = useState(false);\n      const [videoStream, setVideoStream] = useState(null);\n      const videoRef = useRef(null);\n      const [isCapturing, setIsCapturing] = useState(false);\n      const [captureInterval, setCaptureInterval] = useState(null);\n\n      const [currentRunTime, setCurrentRunTime] = useState('0秒');\n      const [runTimeInterval, setRunTimeInterval] = useState(null);\n\n      const prevOverflowStyle = useRef('');\n      // 添加一个防抖函数，确保同一时间只处理一次上传请求\n      const debounce = (func, delay) => {\n            let debounceTimer;\n            return function (...args) {\n                  const context = this;\n                  clearTimeout(debounceTimer);\n                  debounceTimer = setTimeout(() => func.apply(context, args), delay);\n            };\n      };\n\n      // 添加缺陷列表的ref\n      const defectsListRef = useRef(null);\n      // 添加一个标志控制缺陷列表是否可以滚动\n      const [defectsListHover, setDefectsListHover] = useState(false);\n\n      const [isLoggedIn, setIsLoggedIn] = useState(false);\n      const [currentUser, setCurrentUser] = useState(null);\n      // 添加图像尺寸状态\n      const [imageDimensions, setImageDimensions] = useState(null);\n\n      // Add this with the other refs near the top of the component\n      const startTimeRef = useRef(null);\n\n      useEffect(() => {\n            const fetchSystemStatus = async () => {\n                  try {\n                        const response = await axios.get('/api/system-status');\n                        setSystemStatus({\n                              status: response.data.status,\n                              cpuUsage: response.data.cpu_usage,\n                              memoryUsage: response.data.memory_usage,\n                              uptime: response.data.uptime\n                        });\n\n                        // 如果后端返回了服务器IP地址，并且不是localhost，则更新API基础URL\n                  } catch (error) {\n                        console.error('Error fetching system status:', error);\n                        message.error('系统状态更新失败');\n                  }\n            };\n\n            fetchSystemStatus();\n            const statusInterval = setInterval(fetchSystemStatus, 5000);\n            return () => clearInterval(statusInterval);\n      }, []);\n\n      useEffect(() => {\n            isPausedRef.current = isPaused;\n      }, [isPaused]);\n\n      useEffect(() => {\n            if (videoRef.current && videoStream) {\n                  console.log('videoStream变化，设置视频源...');\n                  videoRef.current.srcObject = videoStream;\n                  videoRef.current.play()\n                        .then(() => console.log('视频播放成功 [useEffect]'))\n                        .catch(err => {\n                              console.error('视频播放失败 [useEffect]:', err);\n                              message.error('视频播放失败: ' + err.message);\n                        });\n            }\n      }, [videoStream]);\n\n      // 添加useEffect清理资源\n      useEffect(() => {\n            return () => {\n                  previewUrls.forEach(url => URL.revokeObjectURL(url));\n            };\n      }, [previewUrls]);\n\n      // 清理视频和定时器资源\n      useEffect(() => {\n            return () => {\n                  if (runTimeInterval) {\n                        clearInterval(runTimeInterval);\n                  }\n                  if (videoStream) {\n                        videoStream.getTracks().forEach(track => track.stop());\n                  }\n                  if (captureInterval) {\n                        clearInterval(captureInterval);\n                  }\n            };\n      }, []);\n\n      useEffect(() => {\n            // Check if user is already logged in\n            const token = localStorage.getItem('token');\n            const user = localStorage.getItem('user');\n            if (token && user) {\n                  setIsLoggedIn(true);\n                  setCurrentUser(JSON.parse(user));\n            }\n      }, []);\n\n      // 打开摄像头\n      const handleOpenCamera = async () => {\n            try {\n                  console.log('开始打开/关闭摄像头操作, 当前状态:', { isCameraActive });\n\n                  if (isCameraActive) {\n                        // 关闭摄像头逻辑\n                        console.log('正在关闭摄像头...');\n                        if (videoStream) {\n                              videoStream.getTracks().forEach(track => track.stop());\n                        }\n                        setVideoStream(null);\n                        setIsCameraActive(false);\n\n                        // 停止实时检测\n                        if (isCapturing) {\n                              setIsCapturing(false);\n                              if (captureInterval) {\n                                    clearInterval(captureInterval);\n                                    setCaptureInterval(null);\n                              }\n                        }\n\n                        // 重置检测进度\n                        setDetectionProgress(0);\n\n                        // 重置所有图像相关状态\n                        setImageList([]);\n                        setPreviewUrls([]);\n                        setSelectedImage(null);\n                        setCurrentImageIndex(0);\n                        setDetectionHistory([]);\n                        setDetectionResults({\n                              defects: [],\n                              statistics: {\n                                    defect_types: {}\n                              }\n                        });\n                        setProcessedResults([]);\n                        setImageDimensions(null);\n                        setScale(1);\n                        setPosition({ x: 0, y: 0 });\n\n                        message.success('摄像头已关闭');\n                        return;\n                  }\n\n                  // 先重置图像状态，确保界面干净\n                  resetImageAndDetectionStates();\n\n                  // 检查浏览器是否支持摄像头API\n                  if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n                        message.error('您的浏览器不支持访问摄像头功能');\n                        return;\n                  }\n\n                  console.log('正在请求摄像头权限...');\n                  // 尝试访问摄像头\n                  const stream = await navigator.mediaDevices.getUserMedia({\n                        video: {\n                              width: { ideal: 1280 },\n                              height: { ideal: 720 }\n                        }\n                  });\n\n                  console.log('成功获取摄像头流');\n\n                  // 重要：先设置状态再处理视频元素\n                  setIsCameraActive(true);\n                  setVideoStream(stream);\n\n                  // 等待状态更新完成\n                  await new Promise(resolve => setTimeout(resolve, 50));\n\n                  // 直接设置视频源\n                  if (videoRef.current) {\n                        console.log('设置视频元素源...');\n                        videoRef.current.srcObject = stream;\n                        try {\n                              await videoRef.current.play();\n                              console.log('视频播放成功');\n                        } catch (err) {\n                              console.error('视频播放失败:', err);\n                        }\n                  }\n\n                  message.success('摄像头已打开');\n            } catch (error) {\n                  console.error('无法访问摄像头:', error);\n\n                  // 更详细的错误信息处理\n                  if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {\n                        message.error('摄像头访问被拒绝，请在浏览器中允许访问摄像头');\n                  } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {\n                        message.error('未找到摄像头设备，请确保您的设备已连接摄像头');\n                  } else if (error.name === 'NotReadableError' || error.name === 'TrackStartError') {\n                        message.error('无法读取摄像头，可能被其他应用程序占用');\n                  } else {\n                        message.error('无法访问摄像头: ' + error.message);\n                  }\n            }\n      };\n\n\n      const resetImageAndDetectionStates = () => {\n            console.log('重置图像和检测状态开始');\n\n            // 清理URL资源\n            previewUrls.forEach(url => {\n                  try {\n                        URL.revokeObjectURL(url);\n                  } catch (e) {\n                        console.error(\"撤销URL时出错:\", e);\n                  }\n            });\n\n            // 重置图像和检测相关状态，但保留摄像头状态\n            setImageList([]);\n            setPreviewUrls([]);\n            setSelectedImage(null);\n            setCurrentImageIndex(0);\n            setDetectionHistory([]);\n            setDetectionResults({\n                  defects: [],\n                  statistics: {\n                        defect_types: {}\n                  }\n            });\n            setProcessedResults([]);\n            setDetectionProgress(0);\n            setBatchProgress(0);\n            setScale(1);\n            setPosition({ x: 0, y: 0 });\n            // 重置图像尺寸\n            setImageDimensions(null);\n\n            console.log('重置图像和检测状态完成');\n      };\n\n      // 捕获视频帧并转换为文件\n      const captureVideoFrame = () => {\n            if (!videoRef.current || !isCameraActive) {\n                  console.error('视频元素不可用或摄像头未激活');\n                  return null;\n            }\n\n            // 检查视频是否在播放\n            if (videoRef.current.paused || videoRef.current.ended) {\n                  console.warn('视频已暂停或结束，尝试重新播放');\n                  videoRef.current.play().catch(err => {\n                        console.error('无法重新播放视频:', err);\n                  });\n                  return null;\n            }\n\n            // 确保视频尺寸有效\n            const videoWidth = videoRef.current.videoWidth;\n            const videoHeight = videoRef.current.videoHeight;\n\n            if (!videoWidth || !videoHeight) {\n                  console.warn('视频尺寸无效:', videoWidth, videoHeight);\n                  return null;\n            }\n\n            console.log('捕获视频帧，原始尺寸:', videoWidth, 'x', videoHeight);\n\n            // 计算等比例缩放后的尺寸\n            let newWidth, newHeight;\n\n            if (videoWidth > 600 || videoHeight > 600) {\n                  // 固定宽度为600, 高度按比例缩放\n                  newWidth = 600;\n                  newHeight = Math.round((videoHeight / videoWidth) * 600);\n            } else {\n                  // 小尺寸视频保持原始尺寸\n                  newWidth = videoWidth;\n                  newHeight = videoHeight;\n            }\n\n            console.log('捕获视频帧，缩放后尺寸:', newWidth, 'x', newHeight);\n\n            // 创建两个画布 - 一个用于捕获原始帧，一个用于缩放\n            const captureCanvas = document.createElement('canvas');\n            captureCanvas.width = videoWidth;\n            captureCanvas.height = videoHeight;\n\n            // 先在原始尺寸画布上绘制视频帧\n            const captureCtx = captureCanvas.getContext('2d');\n            captureCtx.drawImage(videoRef.current, 0, 0, videoWidth, videoHeight);\n\n            // 创建第二个画布用于缩放\n            const scaleCanvas = document.createElement('canvas');\n            scaleCanvas.width = newWidth;\n            scaleCanvas.height = newHeight;\n\n            // 在第二个画布上绘制缩放后的图像\n            const scaleCtx = scaleCanvas.getContext('2d');\n            scaleCtx.drawImage(captureCanvas, 0, 0, videoWidth, videoHeight, 0, 0, newWidth, newHeight);\n\n            // 保存缩放后的尺寸信息到state\n            setImageDimensions({ width: newWidth, height: newHeight });\n\n            // 将缩放后的画布转换为Blob\n            return new Promise((resolve) => {\n                  scaleCanvas.toBlob((blob) => {\n                        if (!blob) {\n                              console.error('无法创建Blob');\n                              resolve(null);\n                              return;\n                        }\n\n                        // 创建File对象\n                        const file = new File([blob], 'camera-capture.jpg', { type: 'image/jpeg' });\n                        resolve(file);\n                  }, 'image/jpeg', 0.95); // 高质量JPEG\n            });\n      };\n      // 开始或暂停实时检测\n      // 开始或暂停实时检测\n      const toggleContinuousCapture = async () => {\n            // Reset runtime variables at the start of continuous capture\n            setStartTime(null);\n            startTimeRef.current = null;\n            setEndTime(null);\n            setCurrentRunTime('0秒');\n            if (isCapturing) {\n                  // 如果正在捕获，则停止\n                  if (captureInterval) {\n                        clearInterval(captureInterval);\n                        setCaptureInterval(null);\n                  }\n\n                  // 停止运行时长计时\n                  if (runTimeInterval) {\n                        clearInterval(runTimeInterval);\n                        setRunTimeInterval(null);\n                  }\n\n                  // 设置结束时间\n                  if (startTimeRef.current) {\n                        const end = Date.now();\n                        setEndTime(end);\n\n                        // 计算最终运行时长\n                        const finalDuration = Math.floor((end - startTimeRef.current) / 1000);\n                        const hours = Math.floor(finalDuration / 3600);\n                        const minutes = Math.floor((finalDuration % 3600) / 60);\n                        const seconds = finalDuration % 60;\n                        setCurrentRunTime(`${hours}小时${minutes}分钟${seconds}秒`);\n                  }\n\n                  setIsCapturing(false);\n\n                  // 重置检测结果以清除边界框，但确保不影响视频流\n                  setDetectionResults({\n                        defects: [],\n                        statistics: {\n                              defect_types: {}\n                        }\n                  });\n\n                  message.info('已停止实时检测');\n                  return;\n            }\n\n            // 开始实时捕获\n            if (!isCameraActive) {\n                  message.warning('请先打开摄像头');\n                  return;\n            }\n\n            // 确保视频元素存在且正在播放\n            if (!videoRef.current || !videoRef.current.srcObject) {\n                  console.error('视频元素未准备就绪');\n                  message.error('视频未准备就绪，请重新打开摄像头');\n                  return;\n            }\n\n            // 检查视频流是否可用\n            try {\n                  if (videoRef.current.paused || videoRef.current.ended) {\n                        await videoRef.current.play();\n                        console.log('重新开始播放视频');\n                  }\n            } catch (err) {\n                  console.error('无法播放视频:', err);\n                  message.error('无法播放视频');\n                  return;\n            }\n\n            // 设置开始时间\n            const start = Date.now();\n            setStartTime(start);\n            startTimeRef.current = start;\n            setEndTime(null);\n\n            // 启动运行时长计时器\n            const timeInterval = setInterval(() => {\n                  const now = Date.now();\n                  // Use the ref instead of the closure value\n                  const duration = Math.floor((now - startTimeRef.current) / 1000); // 秒数\n                  const hours = Math.floor(duration / 3600);\n                  const minutes = Math.floor((duration % 3600) / 60);\n                  const seconds = duration % 60;\n                  setCurrentRunTime(`${hours}小时${minutes}分钟${seconds}秒`);\n            }, 1000);\n\n            setRunTimeInterval(timeInterval);\n\n            setIsCapturing(true);\n            message.info('开始实时检测');\n            console.log('开始实时检测，视频流状态:', videoRef.current.readyState);\n\n            // 设置定期捕获和检测\n            const interval = setInterval(async () => {\n                  try {\n                        // 检查视频状态，确保检测过程中摄像头未关闭\n                        if (!videoRef.current || !videoRef.current.srcObject || !isCameraActive) {\n                              console.warn('视频元素不存在或摄像头已关闭，停止检测');\n                              clearInterval(interval);\n\n                              // 停止运行时长计时\n                              if (runTimeInterval) {\n                                    clearInterval(runTimeInterval);\n                                    setRunTimeInterval(null);\n                              }\n\n                              setIsCapturing(false);\n                              setCaptureInterval(null);\n                              message.warning('摄像头已断开，实时检测停止');\n                              return;\n                        }\n\n                        // 如果视频暂停，尝试重新播放\n                        if (videoRef.current.paused || videoRef.current.ended) {\n                              console.warn('视频暂停或结束，尝试重新播放');\n                              try {\n                                    await videoRef.current.play();\n                              } catch (playErr) {\n                                    console.error('无法重新播放视频:', playErr);\n                                    message.error('无法恢复视频播放，实时检测停止');\n                                    clearInterval(interval);\n\n                                    // 停止运行时长计时\n                                    if (runTimeInterval) {\n                                          clearInterval(runTimeInterval);\n                                          setRunTimeInterval(null);\n                                    }\n\n                                    setIsCapturing(false);\n                                    setCaptureInterval(null);\n                                    return;\n                              }\n                        }\n\n                        // 捕获视频帧\n                        const capturedFrame = await captureVideoFrame();\n                        if (capturedFrame) {\n                              console.log('成功捕获视频帧', new Date().toLocaleTimeString());\n                              setDetectionProgress(20);\n\n                              // 处理捕获的帧并检测缺陷\n                              const result = await processImage(capturedFrame);\n                              console.log('检测结果:', result.defects.length > 0 ? `发现${result.defects.length}个缺陷` : '未发现缺陷');\n\n                              // 确保在摄像头活动且视频元素存在时更新结果\n                              if (isCameraActive && videoRef.current) {\n                                    // 确认视频仍在播放\n                                    if (videoRef.current.paused) {\n                                          console.log('检测期间视频暂停，尝试恢复');\n                                          videoRef.current.play().catch(e => console.error('无法恢复视频:', e));\n                                    }\n\n                                    // 更新检测结果之前先清除之前的结果\n                                    setProcessedResults([]);\n\n                                    // 更新检测结果\n                                    setDetectionResults(result);\n                              }\n\n                              setDetectionProgress(100);\n                        } else {\n                              console.warn('未能捕获视频帧');\n                        }\n                  } catch (error) {\n                        console.error('实时检测错误:', error);\n                        message.error('实时检测出错: ' + error.message);\n                  }\n            }, 2000); // 每2秒捕获一次\n\n            setCaptureInterval(interval);\n      };\n      // 处理缺陷过滤的变化\n      const handleDefectFilterChange = (value) => {\n            setDefectFilter(value);\n            filterDefects(value);\n      };\n      const resetAllStates = () => {\n            console.log('重置所有状态开始，摄像头状态:', isCameraActive);\n            if (runTimeInterval) {\n                  clearInterval(runTimeInterval);\n                  setRunTimeInterval(null);\n            }\n\n            // 重置运行时长\n            setCurrentRunTime('0秒');\n            setStartTime(null);\n            startTimeRef.current = null;\n            setEndTime(null);\n\n            // 如果摄像头处于活动状态，只重置图像相关状态\n            if (isCameraActive) {\n                  resetImageAndDetectionStates();\n                  return;\n            }\n\n            // 否则重置所有状态包括摄像头\n            // 清理URL资源\n            previewUrls.forEach(url => {\n                  try {\n                        URL.revokeObjectURL(url);\n                  } catch (e) {\n                        console.error(\"撤销URL时出错:\", e);\n                  }\n            });\n\n            // 清理摄像头资源\n            if (videoStream) {\n                  videoStream.getTracks().forEach(track => track.stop());\n            }\n            setVideoStream(null);\n            setIsCameraActive(false);\n\n            if (captureInterval) {\n                  clearInterval(captureInterval);\n                  setCaptureInterval(null);\n            }\n\n            // 重置其他状态\n            setImageList([]);\n            setPreviewUrls([]);\n            setSelectedImage(null);\n            setCurrentImageIndex(0);\n            setDetectionHistory([]);\n            setDetectionResults({\n                  defects: [],\n                  statistics: {\n                        defect_types: {}\n                  }\n            });\n            setProcessedResults([]);\n            setDetectionProgress(0);\n            setBatchProgress(0);\n            setScale(1);\n            setPosition({ x: 0, y: 0 });\n\n            console.log('重置所有状态完成');\n      };\n      // 过滤缺陷基于选择\n      const filterDefects = (filterType) => {\n            if (!detectionResults || !detectionResults.defects) return;\n\n            if (filterType === 'all') {\n                  setProcessedResults(detectionResults.defects);\n            } else {\n                  const filtered = detectionResults.defects.filter(defect =>\n                        defect.type.toLowerCase() === filterType.toLowerCase()\n                  );\n                  setProcessedResults(filtered);\n            }\n      };\n\n      // 当检测结果改变时更新处理后的结果\n      useEffect(() => {\n            if (detectionResults && detectionResults.defects) {\n                  // 根据实际结果更新缺陷类型\n                  const types = ['all'];\n                  detectionResults.defects.forEach(defect => {\n                        if (!types.includes(defect.type.toLowerCase())) {\n                              types.push(defect.type.toLowerCase());\n                        }\n                  });\n                  setDefectTypes(types);\n\n                  // 应用当前过滤器\n                  filterDefects(defectFilter);\n            }\n      }, [detectionResults]);\n\n      // 获取每种缺陷类型的颜色\n      const getDefectColor = (defectType) => {\n            const colorMap = {\n                  'mouse_bite': '#ff7875',      // 适中红色\n                  'open_circuit': '#40a9ff',     // 适中蓝色\n                  'short': '#ffc53d',           // 适中黄色\n                  'spur': '#73d13d',           // 适中绿色\n                  'spurious_copper': '#9254de'  // 适中紫色\n            };\n\n            return colorMap[defectType.toLowerCase()] || '#ff7875'; // 默认使用适中红色\n      };\n\n      // 渲染边界框\n      const renderBoundingBoxes = () => {\n            // 修改条件判断，针对摄像头模式添加特殊处理\n            if ((!selectedImage && !isCameraActive) || !processedResults || processedResults.length === 0) {\n                  return null;\n            }\n\n            // 获取视频元素的实际位置和尺寸\n            let videoPosition = { left: 0, top: 0, width: 0, height: 0 };\n            let scaleFactor = 1;\n\n            if (isCameraActive && videoRef.current && imageDimensions) {\n                  // 获取视频元素的计算样式和几何信息\n                  const videoElement = videoRef.current;\n                  const videoComputedStyle = window.getComputedStyle(videoElement);\n                  const videoRect = videoElement.getBoundingClientRect();\n                  const parentRect = videoElement.parentElement.getBoundingClientRect();\n\n                  // 计算视频相对于父容器的位置（由于objectFit: contain会留白）\n                  // 视频元素的位置会因为居中显示而有偏移\n                  videoPosition = {\n                        width: videoRect.width,\n                        height: videoRect.height,\n                        // 计算相对于父容器的左偏移\n                        left: videoRect.left - parentRect.left,\n                        // 计算相对于父容器的顶部偏移\n                        top: videoRect.top - parentRect.top\n                  };\n\n                  // 视频显示尺寸与原始图像尺寸比例\n                  const scaleX = videoPosition.width / imageDimensions.width;\n                  const scaleY = videoPosition.height / imageDimensions.height;\n                  scaleFactor = Math.min(scaleX, scaleY);\n\n                  console.log('视频位置计算:', {\n                        videoPosition,\n                        imageSize: imageDimensions,\n                        scale: scaleFactor,\n                        boxOffset: { x: videoPosition.left, y: videoPosition.top }\n                  });\n            }\n\n            return processedResults.map((defect, index) => {\n                  // 检查是否有实际的边界框数据\n                  if (defect.bbox) {\n                        let { x1, y1, x2, y2 } = defect.bbox;\n\n                        // 应用视频帧中的缩放因子和偏移\n                        if (isCameraActive && imageDimensions) {\n                              // 基于imageWrapperRef计算视频内容的实际显示区域\n                              let scale = 1;\n                              let offsetX = 0;\n                              let offsetY = 0;\n                              if (isCameraActive && imageDimensions && imageWrapperRef.current) {\n                                    const wrapperRect = imageWrapperRef.current.getBoundingClientRect();\n                                    const containerW = wrapperRect.width;\n                                    const containerH = wrapperRect.height;\n                                    const { width: imgW, height: imgH } = imageDimensions;\n                                    const imgRatio = imgW / imgH;\n                                    const containerRatio = containerW / containerH;\n                                    let contentW, contentH;\n                                    if (imgRatio > containerRatio) {\n                                          contentW = containerW;\n                                          contentH = contentW / imgRatio;\n                                    } else {\n                                          contentH = containerH;\n                                          contentW = contentH * imgRatio;\n                                    }\n                                    // 计算内容区域的偏移量（居中留白）\n                                    offsetX = (containerW - contentW) / 2;\n                                    offsetY = (containerH - contentH) / 2;\n                                    // 计算缩放比例\n                                    scale = contentW / imgW;\n                              }\n                              x1 = x1 * scale + offsetX;\n                              y1 = y1 * scale + offsetY;\n                              x2 = x2 * scale + offsetX;\n                              y2 = y2 * scale + offsetY;\n                        }\n\n                        const width = x2 - x1;\n                        const height = y2 - y1;\n\n                        return (\n                              <div\n                                    key={index}\n                                    style={{\n                                          position: 'absolute',\n                                          left: `${x1}px`,\n                                          top: `${y1}px`,\n                                          width: `${width}px`,\n                                          height: `${height}px`,\n                                          border: `2px solid ${getDefectColor(defect.type)}`,\n                                          backgroundColor: 'rgba(255, 255, 255, 0.1)',\n                                          pointerEvents: 'none',\n                                          zIndex: 100,\n                                    }}\n                              >\n                                    <div style={{\n                                          position: 'absolute',\n                                          top: '-20px',\n                                          left: '0',\n                                          background: getDefectColor(defect.type),\n                                          color: 'white',\n                                          padding: '0 4px',\n                                          fontSize: '10px',\n                                          whiteSpace: 'nowrap'\n                                    }}>\n                                          {defect.type} {defect.confidence ? `(${defect.confidence}%)` : ''}\n                                    </div>\n                              </div>\n                        );\n                  } else if (defect.position) {\n                        // 使用位置数据的后备选项\n                        const boxWidth = 60;\n                        const boxHeight = 40;\n                        let x = defect.position.x - (boxWidth / 2);\n                        let y = defect.position.y - (boxHeight / 2);\n\n                        // 应用视频帧中的缩放因子和偏移\n                        if (isCameraActive && imageDimensions) {\n                              x = x * scaleFactor + videoPosition.left;\n                              y = y * scaleFactor + videoPosition.top;\n                        }\n\n                        return (\n                              <div\n                                    key={index}\n                                    style={{\n                                          position: 'absolute',\n                                          left: `${x}px`,\n                                          top: `${y}px`,\n                                          width: `${boxWidth}px`,\n                                          height: `${boxHeight}px`,\n                                          border: `2px solid ${getDefectColor(defect.type)}`,\n                                          backgroundColor: 'rgba(255, 255, 255, 0.1)',\n                                          pointerEvents: 'none',\n                                          zIndex: 100,\n                                    }}\n                              >\n                                    <div style={{\n                                          position: 'absolute',\n                                          top: '-20px',\n                                          left: '0',\n                                          background: getDefectColor(defect.type),\n                                          color: 'white',\n                                          padding: '0 4px',\n                                          fontSize: '10px',\n                                          whiteSpace: 'nowrap'\n                                    }}>\n                                          {defect.type} {defect.confidence ? `(${defect.confidence}%)` : ''}\n                                    </div>\n                              </div>\n                        );\n                  }\n                  return null;\n            });\n      };\n\n\n      // 处理单个图片上传\n      const handleImageUpload = (file) => {\n            if (!file) {\n                  return false;\n            }\n\n            setIsUploading(true);\n\n            // 使用Image API预加载图片并计算尺寸\n            const img = new Image();\n            img.onload = () => {\n                  // 计算等比例缩放后的尺寸\n                  let newWidth, newHeight;\n\n                  if (img.width > 600 || img.height > 600) {\n                        // 固定宽度为600, 高度按比例缩放\n                        newWidth = 600;\n                        newHeight = Math.round((img.height / img.width) * 600);\n                  } else {\n                        // 小图维持原尺寸\n                        newWidth = img.width;\n                        newHeight = img.height;\n                  }\n\n                  // 创建canvas进行缩放\n                  const canvas = document.createElement('canvas');\n                  canvas.width = newWidth;\n                  canvas.height = newHeight;\n                  const ctx = canvas.getContext('2d');\n                  ctx.drawImage(img, 0, 0, newWidth, newHeight);\n\n                  // 转换为blob并上传\n                  canvas.toBlob(async (blob) => {\n                        try {\n                              // 将缩放后的图像尺寸保存到状态中\n                              setImageDimensions({ width: newWidth, height: newHeight });\n\n                              // 创建新的File对象并处理\n                              const resizedFile = new File([blob], file.name, { type: file.type });\n\n                              // 在UI上显示缩放后的图\n                              const imageUrl = URL.createObjectURL(blob);\n\n                              // 更新状态\n                              setImageList([resizedFile]);\n                              setPreviewUrls([imageUrl]);\n                              setSelectedImage(imageUrl);\n                              setCurrentImageIndex(0);\n\n                              // 重置检测历史\n                              setDetectionHistory([]);\n\n                              // 重置检测结果\n                              setDetectionResults({\n                                    defects: [],\n                                    statistics: {\n                                          defect_types: {}\n                                    }\n                              });\n\n                              // 重置处理后的结果\n                              setProcessedResults([]);\n\n                              setDetectionProgress(0);\n                              setBatchProgress(0);\n                              message.success('图片导入成功');\n                        } catch (error) {\n                              console.error('图片处理错误:', error);\n                              message.error('图片处理失败');\n                        } finally {\n                              setIsUploading(false);\n                        }\n                  }, file.type, 0.95); // 高质量\n            };\n\n            img.onerror = () => {\n                  console.error('图片加载失败');\n                  message.error('图片加载失败');\n                  setIsUploading(false);\n            };\n\n            img.src = URL.createObjectURL(file);\n            return false; // 阻止默认上传行为\n      };\n\n      // 处理文件夹上传的防抖版本\n      // 处理文件夹上传的防抖版本\n      const debouncedHandleFolderUpload = debounce((info) => {\n            console.log(\"文件夹上传信息 (防抖处理):\", info);\n            setIsUploading(true);\n\n            try {\n                  // 先重置所有状态，确保干净的开始\n                  resetAllStates();\n\n                  // 确保文件列表存在且不为空\n                  if (!info || !info.fileList || info.fileList.length === 0) {\n                        message.warning('未找到文件');\n                        setIsUploading(false);\n                        return;\n                  }\n\n                  // 处理新文件\n                  const newFiles = [];\n                  info.fileList.forEach(file => {\n                        const fileObj = file.originFileObj || file;\n                        if (fileObj && fileObj.type && fileObj.type.startsWith('image/')) {\n                              newFiles.push(fileObj);\n                        }\n                  });\n\n                  console.log(\"导入的图片文件数量:\", newFiles.length);\n\n                  if (newFiles.length === 0) {\n                        message.warning('未找到图片文件');\n                        setIsUploading(false);\n                        return;\n                  }\n\n                  // 创建新URL\n                  const urls = [];\n                  for (const file of newFiles) {\n                        try {\n                              const url = URL.createObjectURL(file);\n                              urls.push(url);\n                        } catch (e) {\n                              console.error(\"无法为文件创建URL:\", file.name, e);\n                        }\n                  }\n\n                  if (urls.length === 0) {\n                        message.error('无法处理图片文件');\n                        setIsUploading(false);\n                        return;\n                  }\n\n                  // 设置新的状态\n                  setImageList(newFiles);\n                  setPreviewUrls(urls);\n                  setSelectedImage(urls[0]);\n\n                  message.success(`成功导入 ${newFiles.length} 张图片`);\n            } catch (error) {\n                  console.error('文件夹导入错误:', error);\n                  message.error('文件夹导入失败');\n                  // 出错时也重置状态\n                  resetAllStates();\n            } finally {\n                  setIsUploading(false);\n            }\n      }, 300); // 300ms的防抖延迟\n\n      // 重置图片位置（在切换图片时调用）\n      const resetImagePosition = () => {\n            setScale(1);\n            setPosition({ x: 0, y: 0 });\n      };\n\n      // 处理图片切换\n      const handleImageChange = (index) => {\n            if (index >= 0 && index < imageList.length) {\n                  setCurrentImageIndex(index);\n                  setSelectedImage(previewUrls[index]);\n                  resetImagePosition(); // 重置缩放和位置\n                  // 如果有检测结果，显示对应结果\n                  if (detectionHistory[index]) {\n                        setDetectionResults(detectionHistory[index].result);\n                  }\n            }\n      };\n\n      // 处理上一张图片\n      const handlePrevImage = () => {\n            handleImageChange(currentImageIndex - 1);\n      };\n\n      // 处理下一张图片\n      const handleNextImage = () => {\n            handleImageChange(currentImageIndex + 1);\n      };\n\n      // 处理页码变化\n      const handlePageChange = (page) => {\n            handleImageChange(page - 1);\n      };\n\n      const [selectedModel, setSelectedModel] = useState('yolov11'); // 默认选择Yolov11模型\n\n      const handleModelChange = (value) => {\n            setSelectedModel(value);\n            switch (value) {\n                  case 'yolov11':\n                        message.info('切换到 Yolov11 模型');\n                        break;\n                  case 'yolov11-vote2':\n                        message.info('切换到 Yolov11-vote2 模型');\n                        break;\n                  case 'yolov11-vote4':\n                        message.info('切换到 Yolov11-vote4 模型');\n                        break;\n                  default:\n                        message.warning('未知模型选择');\n            }\n      };\n\n      const [iouThreshold, setIouThreshold] = useState(0.45); // 默认值为 0.45\n      const [confThreshold, setConfThreshold] = useState(0.4); // 默认值为 0.4\n\n      // 修改单个图片检测逻辑，传递 iou_threshold 和 conf_threshold 参数\n      const processImage = async (file) => {\n            try {\n                  const formData = new FormData();\n                  formData.append('image', file);\n\n                  // 添加图像尺寸信息到请求参数中\n                  const params = {\n                        vote_threshold: selectedModel === 'yolov11-vote2' ? 1 : selectedModel === 'yolov11-vote4' ? 2 : 1,\n                        orientation_count: selectedModel === 'yolov11-vote2' ? 2 : selectedModel === 'yolov11-vote4' ? 4 : 1,\n                        iou_threshold: iouThreshold,\n                        conf_threshold: confThreshold,\n                  };\n\n                  // 如果有图像尺寸信息，也传递给后端\n                  if (imageDimensions) {\n                        params.img_width = imageDimensions.width;\n                        params.img_height = imageDimensions.height;\n                  }\n\n                  const detectResponse = await axios.post('/api/detect', formData, {\n                        params: params,\n                  });\n\n                  return detectResponse.data;\n            } catch (error) {\n                  throw new Error(`检测失败: ${error.message}`);\n            }\n      };\n\n      // 批量检测处理\n      const [startTime, setStartTime] = useState(null); // 检测开始时间\n      const [endTime, setEndTime] = useState(null); // 检测结束时间\n\n      // 计算运行时长\n      const calculateUptime = () => {\n            if (!startTime || !endTime) return 'N/A';\n            const duration = Math.floor((endTime - startTime) / 1000); // 秒数\n            const hours = Math.floor(duration / 3600);\n            const minutes = Math.floor((duration % 3600) / 60);\n            const seconds = duration % 60;\n            return `${hours}小时${minutes}分钟${seconds}秒`;\n      };\n\n      // 修改 handleBatchDetection 函数，记录开始和结束时间\n      const handleBatchDetection = async () => {\n            // Reset runtime variables at the start of batch detection\n            setStartTime(null);\n            startTimeRef.current = null;\n            setEndTime(null);\n            setCurrentRunTime('0秒');\n            if (isCameraActive) {\n                  toggleContinuousCapture();\n                  return;\n            }\n            if (imageList.length === 0) {\n                  message.warning('请先导入图片');\n                  return;\n            }\n\n            if (isBatchProcessing) {\n                  const newPauseState = !isPaused;\n                  setIsPaused(newPauseState);\n                  isPausedRef.current = newPauseState;\n                  message.info(newPauseState ? '暂停检测' : '继续检测');\n                  return;\n            }\n\n            setIsBatchProcessing(true);\n            setLoading(true);\n            setIsPaused(false);\n            isPausedRef.current = false;\n\n            // 记录检测开始时间\n            const start = Date.now();\n            setStartTime(start);\n            startTimeRef.current = start;\n            setEndTime(null);\n\n            // 启动运行时长计时器\n            const interval = setInterval(() => {\n                  const now = Date.now();\n                  // Use the ref instead of the closure value\n                  const duration = Math.floor((now - startTimeRef.current) / 1000); // 秒数\n                  const hours = Math.floor(duration / 3600);\n                  const minutes = Math.floor((duration % 3600) / 60);\n                  const seconds = duration % 60;\n                  setCurrentRunTime(`${hours}小时${minutes}分钟${seconds}秒`);\n            }, 1000);\n\n            setRunTimeInterval(interval);\n\n            let history = [];\n            let i = 0;\n\n            try {\n                  setDetectionProgress(1);\n\n                  while (i < imageList.length) {\n                        if (isPausedRef.current) {\n                              await new Promise(resolve => {\n                                    const checkPauseInterval = setInterval(() => {\n                                          if (!isPausedRef.current) {\n                                                clearInterval(checkPauseInterval);\n                                                resolve();\n                                          }\n                                    }, 100);\n                              });\n                              continue;\n                        }\n\n                        setDetectionResults({\n                              defects: [],\n                              statistics: {\n                                    defect_types: {}\n                              }\n                        });\n\n                        setProcessedResults([]);\n                        setCurrentImageIndex(i);\n                        setSelectedImage(previewUrls[i]);\n\n                        const progress = Math.round(((i + 1) / imageList.length) * 100);\n                        setBatchProgress(progress);\n                        setDetectionProgress(progress);\n\n                        const result = await processImage(imageList[i]);\n\n                        history.push({\n                              imageUrl: previewUrls[i],\n                              result: result\n                        });\n\n                        setDetectionResults(result);\n\n                        await new Promise(resolve => setTimeout(resolve, 1000));\n\n                        if (!isPausedRef.current) {\n                              i++;\n                        }\n                  }\n\n                  setDetectionHistory(history);\n\n                  // 停止计时器并记录结束时间\n                  clearInterval(runTimeInterval);\n                  setRunTimeInterval(null);\n                  const end = Date.now();\n                  setEndTime(end);\n\n                  // 计算并设置最终运行时长\n                  const finalDuration = Math.floor((end - startTimeRef.current) / 1000);\n                  const hours = Math.floor(finalDuration / 3600);\n                  const minutes = Math.floor((finalDuration % 3600) / 60);\n                  const seconds = finalDuration % 60;\n                  setCurrentRunTime(`${hours}小时${minutes}分钟${seconds}秒`);\n\n                  message.success('检测完成');\n                  setIsBatchProcessing(false);\n            } catch (error) {\n                  // 停止计时器\n                  clearInterval(runTimeInterval);\n                  setRunTimeInterval(null);\n\n                  message.error(error.message);\n                  setIsBatchProcessing(false);\n            } finally {\n                  setLoading(false);\n            }\n      };\n      // 修改useEffect中的全局滚轮事件处理\n      useEffect(() => {\n            if (selectedImage) {\n                  // 我们只需要为图片区域添加滚轮处理，不影响全局滚动\n                  const handleImageScrolling = (e) => {\n                        // 检查事件是否发生在图片容器内\n                        let targetElement = e.target;\n                        let isInsideImageWrapper = false;\n\n                        while (targetElement) {\n                              if (targetElement === imageWrapperRef.current) {\n                                    isInsideImageWrapper = true;\n                                    break;\n                              }\n                              targetElement = targetElement.parentElement;\n                        }\n\n                        // 仅当在图片区域内才阻止默认行为\n                        if (isInsideImageWrapper) {\n                              e.preventDefault();\n                        }\n                  };\n\n                  // 添加事件监听器到图片容器\n                  if (imageWrapperRef.current) {\n                        imageWrapperRef.current.addEventListener('wheel', handleImageScrolling, { passive: false });\n                  }\n\n                  return () => {\n                        // 移除事件监听器\n                        if (imageWrapperRef.current) {\n                              imageWrapperRef.current.removeEventListener('wheel', handleImageScrolling);\n                        }\n                  };\n            }\n      }, [selectedImage]);\n\n      // 移除之前的全局滚轮事件监听代码，改为下面的代码\n      // 这个处理只针对图片容器，允许其他区域正常滚动\n      useEffect(() => {\n            // 清理之前的样式\n            document.body.style.overflow = '';\n            document.documentElement.style.overflow = '';\n      }, []);\n\n      // 修改handleWheel函数，只处理图片缩放，不影响其他区域的滚动\n      const handleWheel = (e) => {\n            // 获取图片元素\n            const img = imageWrapperRef.current?.querySelector('img');\n            if (!img) return;\n\n            // 阻止默认行为，这样图片容器的滚轮操作不会引起页面滚动\n            e.preventDefault();\n\n            // 减小缩放系数，使缩放更平滑\n            const delta = e.deltaY * -0.005;\n            const newScale = Math.min(Math.max(scale + delta, MIN_ZOOM), MAX_ZOOM);\n\n            if (newScale === scale) return;\n\n            // 获取鼠标在图片容器中的相对位置\n            const rect = imageWrapperRef.current.getBoundingClientRect();\n            const mouseX = e.clientX - rect.left;\n            const mouseY = e.clientY - rect.top;\n\n            // 计算鼠标位置相对于图片中心的偏移\n            const centerX = rect.width / 2;\n            const centerY = rect.height / 2;\n\n            // 计算新的位置\n            const scaleChange = newScale - scale;\n            let newPosition = position;\n\n            if (delta > 0) { // 放大时\n                  // 以鼠标位置为中心进行放大\n                  newPosition = {\n                        x: position.x - (mouseX - centerX) * (scaleChange / scale),\n                        y: position.y - (mouseY - centerY) * (scaleChange / scale)\n                  };\n            } else { // 缩小时\n                  // 以图片中心为基准点进行缩小\n                  newPosition = {\n                        x: position.x * (newScale / scale),\n                        y: position.y * (newScale / scale)\n                  };\n            }\n\n            // 更新状态\n            setScale(newScale);\n            setPosition(newPosition);\n      };\n\n      // 处理鼠标拖动\n      const handleMouseDown = (e) => {\n            if (e.button === 0) {\n                  setIsDragging(true);\n                  setDragStart({\n                        x: e.clientX - position.x,\n                        y: e.clientY - position.y\n                  });\n            }\n      };\n\n      const handleMouseMove = (e) => {\n            if (isDragging) {\n                  const newX = e.clientX - dragStart.x;\n                  const newY = e.clientY - dragStart.y;\n\n                  // 限制拖动范围\n                  const maxOffset = 300 * (scale - 1);\n                  const boundedX = Math.max(Math.min(newX, maxOffset), -maxOffset);\n                  const boundedY = Math.max(Math.min(newY, maxOffset), -maxOffset);\n\n                  setPosition({\n                        x: boundedX,\n                        y: boundedY\n                  });\n            }\n      };\n\n      // 处理鼠标释放事件\n      const handleMouseUp = () => {\n            setIsDragging(false);\n      };\n\n      // 处理鼠标离开事件\n      const handleMouseLeave = () => {\n            setIsDragging(false);\n      };\n\n      // 修改缩放处理函数，添加位置重置\n      const handleZoomIn = () => {\n            setZoomLevel(prev => {\n                  const newZoom = Math.min(prev + ZOOM_STEP, MAX_ZOOM);\n                  if (newZoom === 1) {\n                        resetImagePosition();\n                  }\n                  return newZoom;\n            });\n      };\n\n      const handleZoomOut = () => {\n            setZoomLevel(prev => {\n                  const newZoom = Math.max(prev - ZOOM_STEP, MIN_ZOOM);\n                  if (newZoom === 1) {\n                        resetImagePosition();\n                  }\n                  return newZoom;\n            });\n      };\n\n      const handleExportResults = async () => {\n            if (!detectionResults.defects.length) {\n                  message.warning('没有可导出的检测结果');\n                  return;\n            }\n\n            try {\n                  // 检查浏览器是否支持文件系统访问 API\n                  if (!window.showDirectoryPicker) {\n                        message.error('当前浏览器不支持文件夹选择功能');\n                        return;\n                  }\n\n                  // 弹出文件夹选择器\n                  const directoryHandle = await window.showDirectoryPicker();\n\n                  // 创建子文件夹：标注图片和 JSON 文件\n                  const annotatedImagesFolder = await directoryHandle.getDirectoryHandle('Annotated_Images', { create: true });\n                  const jsonFolder = await directoryHandle.getDirectoryHandle('JSON_Files', { create: true });\n\n                  // 遍历所有图片，导出标注图片和对应的 JSON 文件\n                  for (let i = 0; i < imageList.length; i++) {\n                        const imageFile = imageList[i];\n                        const imageName = imageFile.name.split('.').slice(0, -1).join('.'); // 去掉文件扩展名\n\n                        // 导出标注图片\n                        const annotatedImageName = `${imageName}_annotated.png`;\n                        const annotatedImageHandle = await annotatedImagesFolder.getFileHandle(annotatedImageName, { create: true });\n                        const writableStream = await annotatedImageHandle.createWritable();\n\n                        // 创建标注图片的 Canvas\n                        const canvas = document.createElement('canvas');\n                        const context = canvas.getContext('2d');\n                        const image = new Image();\n\n                        // 加载图片并绘制到 Canvas 上\n                        image.src = previewUrls[i];\n                        await new Promise((resolve) => {\n                              image.onload = () => {\n                                    canvas.width = image.width;\n                                    canvas.height = image.height;\n                                    context.drawImage(image, 0, 0);\n\n                                    // 绘制检测框\n                                    detectionHistory[i]?.result?.defects.forEach((defect) => {\n                                          if (defect.bbox) {\n                                                const { x1, y1, x2, y2 } = defect.bbox;\n                                                context.strokeStyle = getDefectColor(defect.type);\n                                                context.lineWidth = 2;\n                                                context.strokeRect(x1, y1, x2 - x1, y2 - y1);\n\n                                                // 绘制缺陷类型标签\n                                                context.fillStyle = getDefectColor(defect.type);\n                                                context.font = '16px Arial';\n                                                context.fillText(defect.type, x1, y1 - 5);\n                                          }\n                                    });\n\n                                    resolve();\n                              };\n                        });\n\n                        // 将 Canvas 转换为 Blob 并写入文件\n                        const blob = await new Promise((resolve) => canvas.toBlob(resolve, 'image/png'));\n                        await writableStream.write(blob);\n                        await writableStream.close();\n\n                        // 导出对应的 JSON 文件\n                        const jsonFileName = `${imageName}_result.json`;\n                        const jsonFileHandle = await jsonFolder.getFileHandle(jsonFileName, { create: true });\n                        const jsonWritableStream = await jsonFileHandle.createWritable();\n\n                        const jsonResult = {\n                              image: imageName,\n                              defects: detectionHistory[i]?.result?.defects || [],\n                              statistics: detectionHistory[i]?.result?.statistics || {},\n                        };\n\n                        await jsonWritableStream.write(JSON.stringify(jsonResult, null, 2));\n                        await jsonWritableStream.close();\n                  }\n\n                  message.success('检测结果已成功导出');\n            } catch (error) {\n                  console.error('导出结果失败:', error);\n                  message.error('导出结果失败');\n            }\n      };\n\n      const handleExportReport = () => {\n            // 检查是否有检测结果可供导出\n            if (!detectionHistory || detectionHistory.length === 0) {\n                  message.warning('没有检测结果可供导出');\n                  return;\n            }\n\n            message.loading('正在生成报告...', 0);\n\n            try {\n                  // 创建一个临时的隐藏div来渲染HTML内容\n                  const reportContainer = document.createElement('div');\n                  reportContainer.style.position = 'absolute';\n                  reportContainer.style.left = '-9999px';\n                  reportContainer.style.top = '-9999px';\n                  reportContainer.style.width = '794px'; // A4宽度 (mm到px的近似值)\n                  document.body.appendChild(reportContainer);\n\n                  // 获取当前日期和时间\n                  const now = new Date();\n                  const dateStr = now.toLocaleDateString('zh-CN');\n                  const timeStr = now.toLocaleTimeString('zh-CN');\n\n                  // 计算批次统计数据\n                  const batchStatistics = {\n                        totalImages: imageList.length,\n                        totalDefects: 0,\n                        defectTypeCounts: {},\n                        imagesWithDefects: 0,\n                        averageDefectsPerImage: 0\n                  };\n\n                  // 遍历所有检测历史计算统计数据\n                  detectionHistory.forEach(history => {\n                        if (history.result && history.result.defects) {\n                              const defects = history.result.defects;\n                              if (defects.length > 0) {\n                                    batchStatistics.imagesWithDefects++;\n                              }\n                              batchStatistics.totalDefects += defects.length;\n\n                              defects.forEach(defect => {\n                                    if (!batchStatistics.defectTypeCounts[defect.type]) {\n                                          batchStatistics.defectTypeCounts[defect.type] = 0;\n                                    }\n                                    batchStatistics.defectTypeCounts[defect.type]++;\n                              });\n                        }\n                  });\n\n                  // 计算平均每张图片的缺陷数\n                  batchStatistics.averageDefectsPerImage = (batchStatistics.totalDefects / batchStatistics.totalImages).toFixed(2);\n\n                  // 准备批次统计表格\n                  let batchStatsRows = '';\n                  Object.entries(batchStatistics.defectTypeCounts).forEach(([type, count]) => {\n                        const percentage = ((count / batchStatistics.totalDefects) * 100).toFixed(1);\n                        batchStatsRows += `\n                  <tr>\n                        <td>${type}</td>\n                        <td>${count}</td>\n                        <td>${percentage}%</td>\n                  </tr>`;\n                  });\n\n                  // 准备当前图片的检测结果表格\n                  let currentImageDefectsRows = '';\n                  if (detectionResults && detectionResults.defects) {\n                        detectionResults.defects.forEach((defect, index) => {\n                              const positionStr = defect.bbox ?\n                                    `(${defect.bbox.x1.toFixed(0)},${defect.bbox.y1.toFixed(0)},${defect.bbox.x2.toFixed(0)},${defect.bbox.y2.toFixed(0)})` :\n                                    '未知';\n                              const confidence = defect.confidence ? `${defect.confidence}%` : '未知';\n\n                              currentImageDefectsRows += `\n                  <tr>\n                        <td>${index + 1}</td>\n                        <td>${defect.type}</td>\n                        <td>${positionStr}</td>\n                        <td>${confidence}</td>\n                  </tr>`;\n                        });\n                  }\n\n                  // 使用HTML创建报告内容\n                  reportContainer.innerHTML = `\n                  <div style=\"font-family: 'Microsoft YaHei', 'SimHei', sans-serif; padding: 20px; color: #333;\">\n                        <style>\n                              table {\n                                    width: 100%;\n                                    border-collapse: collapse;\n                                    margin: 15px 0;\n                              }\n                              th, td {\n                                    border: 1px solid #ddd;\n                                    padding: 8px;\n                                    text-align: center;\n                              }\n                              th {\n                                    background-color: #00539c;\n                                    color: white;\n                                    font-weight: bold;\n                              }\n                              tr:nth-child(even) {\n                                    background-color: #f2f2f2;\n                              }\n                              h1, h2, h3 {\n                                    color: #00539c;\n                                    margin-bottom: 10px;\n                              }\n                              .report-header {\n                                    text-align: center;\n                                    margin-bottom: 20px;\n                              }\n                              .report-date {\n                                    text-align: right;\n                                    color: #666;\n                                    font-size: 12px;\n                                    margin-bottom: 15px;\n                              }\n                              .section {\n                                    margin-bottom: 25px;\n                              }\n                              .footer {\n                                    text-align: center;\n                                    margin-top: 30px;\n                                    font-size: 10px;\n                                    color: #999;\n                                    position: absolute;\n                                    bottom: 20px;\n                                    width: 100%;\n                              }\n                              hr {\n                                    border: 0;\n                                    height: 1px;\n                                    background: #ddd;\n                                    margin: 20px 0;\n                              }\n                              .stats-card {\n                                    background: #f8f9fa;\n                                    border-radius: 8px;\n                                    padding: 15px;\n                                    margin: 10px 0;\n                                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n                              }\n                              .stats-grid {\n                                    display: grid;\n                                    grid-template-columns: repeat(3, 1fr);\n                                    gap: 15px;\n                                    margin: 15px 0;\n                              }\n                              .stat-item {\n                                    background: white;\n                                    padding: 10px;\n                                    border-radius: 6px;\n                                    text-align: center;\n                              }\n                              .stat-value {\n                                    font-size: 24px;\n                                    font-weight: bold;\n                                    color: #00539c;\n                              }\n                              .stat-label {\n                                    font-size: 14px;\n                                    color: #666;\n                              }\n                        </style>\n                        \n                        <div class=\"report-header\">\n                              <h1>PCB缺陷检测报告</h1>\n                        </div>\n                        \n                        <div class=\"report-date\">\n                              报告生成时间: ${dateStr} ${timeStr}\n                        </div>\n                        \n                        <hr>\n                        \n                        <div class=\"section\">\n                              <h2>批次检测概述</h2>\n                              <div class=\"stats-grid\">\n                                    <div class=\"stat-item\">\n                                          <div class=\"stat-value\">${batchStatistics.totalImages}</div>\n                                          <div class=\"stat-label\">检测总图片数</div>\n                                    </div>\n                                    <div class=\"stat-item\">\n                                          <div class=\"stat-value\">${batchStatistics.totalDefects}</div>\n                                          <div class=\"stat-label\">检出总缺陷数</div>\n                                    </div>\n                                    <div class=\"stat-item\">\n                                          <div class=\"stat-value\">${batchStatistics.averageDefectsPerImage}</div>\n                                          <div class=\"stat-label\">平均每图缺陷数</div>\n                                    </div>\n                              </div>\n                              \n                              <div class=\"stats-card\">\n                                    <h3>批次缺陷类型分布</h3>\n                                    <table>\n                                          <thead>\n                                                <tr>\n                                                      <th>缺陷类型</th>\n                                                      <th>数量</th>\n                                                      <th>占比</th>\n                                                </tr>\n                                          </thead>\n                                          <tbody>\n                                                ${batchStatsRows}\n                                          </tbody>\n                                    </table>\n                              </div>\n                        </div>\n                        \n                        <hr>\n                        \n                        <div class=\"section\">\n                              <h2>当前图片检测详情</h2>\n                              <p>图片序号: ${currentImageIndex + 1}/${imageList.length}</p>\n                              <table>\n                                    <thead>\n                                          <tr>\n                                                <th>缺陷ID</th>\n                                                <th>缺陷类型</th>\n                                                <th>位置坐标(x1,y1,x2,y2)</th>\n                                                <th>置信度</th>\n                                          </tr>\n                                    </thead>\n                                    <tbody>\n                                          ${currentImageDefectsRows}\n                                    </tbody>\n                              </table>\n                        </div>\n                        \n                        <div class=\"footer\">\n                              PCB缺陷检测系统\n                        </div>\n                  </div>\n                  `;\n\n                  // 使用html2canvas将HTML转换为canvas\n                  import('html2canvas').then(html2canvasModule => {\n                        const html2canvas = html2canvasModule.default;\n                        html2canvas(reportContainer, {\n                              scale: 2, // 提高清晰度\n                              useCORS: true,\n                              logging: false\n                        }).then(canvas => {\n                              // 创建PDF\n                              import('jspdf').then(jsPdfModule => {\n                                    const { jsPDF } = jsPdfModule;\n\n                                    const imgData = canvas.toDataURL('image/png');\n                                    const pdf = new jsPDF({\n                                          orientation: 'portrait',\n                                          unit: 'mm',\n                                          format: 'a4'\n                                    });\n\n                                    // 计算合适的图像尺寸以适合A4页面\n                                    const imgWidth = 210; // A4宽度，单位mm\n                                    const pageHeight = 297; // A4高度，单位mm\n                                    const imgHeight = canvas.height * imgWidth / canvas.width;\n\n                                    let heightLeft = imgHeight;\n                                    let position = 0;\n\n                                    // 添加第一页\n                                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n                                    heightLeft -= pageHeight;\n\n                                    // 如果内容超过一页，添加更多页面\n                                    while (heightLeft > 0) {\n                                          position = heightLeft - imgHeight;\n                                          pdf.addPage();\n                                          pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n                                          heightLeft -= pageHeight;\n                                    }\n\n                                    // 添加文件名，包含时间戳以避免重复\n                                    const timestamp = now.getTime();\n                                    const filename = `PCB缺陷检测报告_${timestamp}.pdf`;\n\n                                    // 保存PDF文件\n                                    pdf.save(filename);\n\n                                    // 清理临时DOM元素\n                                    document.body.removeChild(reportContainer);\n\n                                    // 关闭加载提示并显示成功消息\n                                    message.destroy();\n                                    message.success('报告已成功导出');\n                              });\n                        });\n                  });\n            } catch (error) {\n                  // 发生错误时关闭加载提示并显示错误消息\n                  message.destroy();\n                  console.error(\"导出报告出错:\", error);\n                  message.error('导出报告失败: ' + error.message);\n\n                  // 确保清理可能的临时DOM元素\n                  const reportContainer = document.querySelector('div[style*=\"-9999px\"]');\n                  if (reportContainer) {\n                        document.body.removeChild(reportContainer);\n                  }\n            }\n      };\n\n      const getChartOption = () => {\n            // 检查是否有有效的统计数据\n            const defectTypes = detectionResults?.statistics?.defect_types;\n            if (!defectTypes || Object.keys(defectTypes).length === 0) {\n                  return {\n                        tooltip: { trigger: 'item' },\n                        legend: { show: false },\n                        series: [] // 返回空的 series，避免绘制灰色圆\n                  };\n            }\n\n            // 获取所有缺陷类型\n            const defectNames = Object.keys(defectTypes);\n\n            // 为每种缺陷类型生成对应的颜色\n            const colors = defectNames.map(name => {\n                  // 将中文名称映射到英文键名以获取颜色\n                  const colorKey = (() => {\n                        switch (name) {\n                              case '鼠咬': return 'mouse_bite';\n                              case '开路': return 'open_circuit';\n                              case '短路': return 'short';\n                              case '毛刺': return 'spur';\n                              case '杂铜': return 'spurious_copper';\n                              default: return name.toLowerCase();\n                        }\n                  })();\n\n                  return getDefectColor(colorKey);\n            });\n\n            return {\n                  tooltip: {\n                        trigger: 'item',\n                        formatter: '{a} <br/>{b}: {c} ({d}%)'\n                  },\n                  legend: {\n                        orient: 'horizontal',\n                        bottom: 10,\n                        left: 'center',\n                        data: defectNames,\n                        itemGap: 15,\n                        height: 50\n                  },\n                  color: colors,\n                  series: [\n                        {\n                              name: '缺陷类型',\n                              type: 'pie',\n                              radius: '65%',\n                              center: ['50%', '40%'],\n                              data: Object.entries(defectTypes).map(([name, value]) => ({\n                                    value,\n                                    name\n                              })),\n                              label: {\n                                    show: true,\n                                    position: 'outside',\n                                    alignTo: 'labelLine',\n                                    margin: 20,\n                                    formatter: '{b}\\n{c} ({d}%)',\n                                    lineHeight: 15,\n                                    rich: {\n                                          b: {\n                                                width: 60,\n                                                align: 'left'\n                                          }\n                                    }\n                              },\n                              labelLine: {\n                                    show: true,\n                                    length: 15,\n                                    length2: 20,\n                                    minTurnAngle: 120,\n                                    maxSurfaceAngle: 80\n                              },\n                              emphasis: {\n                                    itemStyle: {\n                                          shadowBlur: 10,\n                                          shadowOffsetX: 0,\n                                          shadowColor: 'rgba(0, 0, 0, 0.5)'\n                                    }\n                              }\n                        }\n                  ]\n            };\n      };\n      const handleImageWrapperClick = (e) => {\n            // 获取图片元素\n            const img = imageWrapperRef.current?.querySelector('img');\n            if (!img) return;\n\n            // 获取图片元素的位置和尺寸\n            const imgRect = img.getBoundingClientRect();\n\n            // 检查点击是否在图片区域外\n            const isOutsideImage = (\n                  e.clientX < imgRect.left ||\n                  e.clientX > imgRect.right ||\n                  e.clientY < imgRect.top ||\n                  e.clientY > imgRect.bottom\n            );\n\n            if (isOutsideImage) {\n                  // 重置缩放和位置\n                  setScale(1);\n                  setPosition({ x: 0, y: 0 });\n            }\n      };\n\n      const handleLoginSuccess = (user) => {\n            setIsLoggedIn(true);\n            setCurrentUser(user);\n      };\n\n      const handleLogout = () => {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            setIsLoggedIn(false);\n            setCurrentUser(null);\n      };\n\n      // 添加在其他useEffect之后\n      // 监听imageDimensions的变化，确保在渲染边界框前已获取图像尺寸\n      useEffect(() => {\n            // 当imageDimensions变化时，重新计算和应用边界框\n            if (imageDimensions && detectionResults && detectionResults.defects) {\n                  console.log('图像尺寸更新，重新应用边界框:', imageDimensions);\n                  // 触发边界框重新应用\n                  filterDefects(defectFilter);\n            }\n      }, [imageDimensions]);\n\n      // 添加一个useEffect来监听视频元素的大小和位置变化\n      useEffect(() => {\n            if (isCameraActive && videoRef.current) {\n                  // 创建一个ResizeObserver来监听视频元素的大小变化\n                  const resizeObserver = new ResizeObserver(() => {\n                        // 触发边界框重新渲染\n                        if (processedResults && processedResults.length > 0) {\n                              console.log('视频元素尺寸变化，重新应用边界框');\n                              // 创建一个新的过滤结果副本以触发渲染\n                              setProcessedResults([...processedResults]);\n                        }\n                  });\n\n                  // 开始观察视频元素\n                  resizeObserver.observe(videoRef.current);\n\n                  // 清理函数\n                  return () => {\n                        resizeObserver.disconnect();\n                  };\n            }\n      }, [isCameraActive, videoRef.current, processedResults]);\n\n      if (!isLoggedIn) {\n            return <Login onLoginSuccess={handleLoginSuccess} />;\n      }\n\n      return (\n            <Layout className=\"app-container\">\n                  <Header className=\"header\">\n                        <div className=\"header-left\">\n                              <img src=\"/logo.svg\" alt=\"logo\" className=\"logo\" />\n                              <h1>基于YOLOv11和投票融合的PCB缺陷检测系统</h1>\n                        </div>\n                        <div className=\"header-right\">\n                              <SettingOutlined className=\"header-icon\" />\n                              <BulbOutlined className=\"header-icon\" />\n                              <Tooltip title=\"退出登录\">\n                                    <UserOutlined className=\"header-icon\" onClick={handleLogout} style={{ cursor: 'pointer' }} />\n                              </Tooltip>\n                        </div>\n                  </Header>\n                  <Layout style={{ padding: '24px', background: '#f0f2f5' }}>\n                        <div style={{ display: 'flex', gap: '24px', minWidth: 'fit-content' }}>\n                              <div className=\"sidebar\">\n                                    <Button\n                                          type=\"primary\"\n                                          className=\"start-detection-button\"\n                                          style={{\n                                                background: (isBatchProcessing && !isPaused) || isCapturing ? '#f5222d' : '#37c537',\n                                                border: 'none',\n                                          }}\n                                          onClick={handleBatchDetection}\n                                          icon={isBatchProcessing && !isPaused ? <LoadingOutlined /> : <SearchOutlined />}\n                                    >\n                                          {isCameraActive && isCapturing ? '停止检测' :\n                                                isCameraActive ? '开始检测' :\n                                                      isBatchProcessing ? (isPaused ? '继续检测' : '暂停检测') : '开始检测'}\n                                    </Button>\n                                    <div className=\"system-status-section\">\n                                          <h3>系统状态</h3>\n                                          <div className=\"status-item status-cpu\" style={{ display: 'flex', alignItems: 'flex-start' }}>\n                                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '50px' }}>\n                                                      <div className=\"status-icon status-icon-cpu\"></div>\n                                                      <span className=\"status-value\" style={{\n                                                            marginTop: '5px',\n                                                            backgroundColor: 'rgba(24, 144, 255, 0.2)',\n                                                            padding: '2px 8px',\n                                                            borderRadius: '10px',\n                                                            fontSize: '12px',\n                                                            color: '#1890ff',\n                                                            textAlign: 'center'\n                                                      }}>\n                                                            {Math.min(Math.max(Math.round(systemStatus.cpuUsage || 0), 0), 100)}%\n                                                      </span>\n                                                </div>\n                                                <div className=\"status-content\" style={{ marginLeft: '10px', marginTop: '2px' }}>\n                                                      <div className=\"status-header\">\n                                                            <span className=\"status-label\">CPU使用率</span>\n                                                      </div>\n                                                      <div style={{ position: 'relative' }}>\n                                                            <Progress\n                                                                  percent={Math.min(Math.max(Math.round(systemStatus.cpuUsage || 0), 0), 100)}\n                                                                  size=\"small\"\n                                                                  status={systemStatus.cpuUsage > 80 ? 'exception' : 'normal'}\n                                                                  showInfo={false}\n                                                                  strokeColor={{\n                                                                        '0%': '#108ee9',\n                                                                        '100%': systemStatus.cpuUsage > 80 ? '#f5222d' : '#52c41a',\n                                                                  }}\n                                                            />\n                                                      </div>\n                                                </div>\n                                          </div>\n                                          <div className=\"status-item status-memory\" style={{ display: 'flex', alignItems: 'flex-start' }}>\n                                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '50px' }}>\n                                                      <div className=\"status-icon status-icon-memory\"></div>\n                                                      <span className=\"status-value\" style={{\n                                                            marginTop: '5px',\n                                                            backgroundColor: 'rgba(114, 46, 209, 0.2)',\n                                                            padding: '2px 8px',\n                                                            borderRadius: '10px',\n                                                            fontSize: '12px',\n                                                            color: '#722ed1',\n                                                            textAlign: 'center'\n                                                      }}>\n                                                            {Math.min(Math.max(Math.round(systemStatus.memoryUsage || 0), 0), 100)}%\n                                                      </span>\n                                                </div>\n                                                <div className=\"status-content\" style={{ marginLeft: '10px', marginTop: '2px' }}>\n                                                      <div className=\"status-header\">\n                                                            <span className=\"status-label\">内存使用率</span>\n                                                      </div>\n                                                      <div style={{ position: 'relative' }}>\n                                                            <Progress\n                                                                  percent={Math.min(Math.max(Math.round(systemStatus.memoryUsage || 0), 0), 100)}\n                                                                  size=\"small\"\n                                                                  status={systemStatus.memoryUsage > 80 ? 'exception' : 'normal'}\n                                                                  showInfo={false}\n                                                                  strokeColor={{\n                                                                        '0%': '#722ed1',\n                                                                        '100%': systemStatus.memoryUsage > 80 ? '#f5222d' : '#13c2c2',\n                                                                  }}\n                                                            />\n                                                      </div>\n                                                </div>\n                                          </div>\n                                          <div className=\"status-item status-time\" style={{ display: 'flex', alignItems: 'flex-start' }}>\n                                                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '50px' }}>\n                                                      <div className=\"status-icon status-icon-time\"></div>\n                                                </div>\n                                                <div className=\"status-content\" style={{ marginLeft: '10px', marginTop: '2px' }}>\n                                                      <div className=\"status-header\">\n                                                            <span className=\"status-label\">运行时长</span>\n                                                      </div>\n                                                      <div style={{\n                                                            display: 'flex',\n                                                            justifyContent: 'center',\n                                                            marginTop: '5px'\n                                                      }}>\n                                                            <span className=\"status-time-value\" style={{\n                                                                  backgroundColor: 'rgba(250, 173, 20, 0.2)',\n                                                                  padding: '4px 12px',\n                                                                  borderRadius: '30px',\n                                                                  fontSize: '12px',\n                                                                  color: '#faad14',\n                                                                  whiteSpace: 'nowrap',\n                                                                  textAlign: 'center'\n                                                            }}>\n                                                                  {isBatchProcessing || isCapturing ? currentRunTime : (endTime && startTime ? calculateUptime() : '0秒')}\n                                                            </span>\n                                                      </div>\n                                                </div>\n                                          </div>\n                                    </div>\n                                    <div className=\"sidebar-actions\">\n                                          <Upload\n                                                accept=\"image/*\"\n                                                showUploadList={false}\n                                                beforeUpload={handleImageUpload}\n                                                disabled={isUploading || loading || isCameraActive}\n                                          >\n                                                <Button className=\"action-btn\" style={{ width: '160px' }} icon={<UploadOutlined className=\"btn-icon\" />} disabled={isUploading || loading || isCameraActive}>\n                                                      导入图像\n                                                </Button>\n                                          </Upload>\n                                          <Upload\n                                                directory\n                                                multiple\n                                                accept=\"image/*\"\n                                                showUploadList={false}\n                                                beforeUpload={() => false}\n                                                onChange={debouncedHandleFolderUpload}\n                                                disabled={isUploading || loading || isCameraActive}\n                                                fileList={[]}\n                                          >\n                                                <Button className=\"action-btn\" style={{ width: '160px' }} icon={<FolderOutlined className=\"btn-icon\" />} disabled={isUploading || loading || isCameraActive}>\n                                                      导入文件夹\n                                                </Button>\n                                          </Upload>\n                                          {/* 添加摄像头按钮 */}\n                                          <Button\n                                                className=\"action-btn\"\n                                                icon={isCameraActive ? <VideoCameraOutlined className=\"btn-icon\" /> : <CameraOutlined className=\"btn-icon\" />}\n                                                onClick={handleOpenCamera}\n                                                style={{ width: '160px', color: isCameraActive ? '#f5222d' : '' }}\n                                          >\n                                                {isCameraActive ? '关闭摄像头' : '打开摄像头'}\n                                          </Button>\n                                          <Button className=\"action-btn\" style={{ width: '160px' }} icon={<SearchOutlined className=\"btn-icon\" />} onClick={handleExportResults}>\n                                                导出结果\n                                          </Button>\n                                          <Button className=\"action-btn\" style={{ width: '160px' }} icon={<FileTextOutlined className=\"btn-icon\" />} onClick={handleExportReport}>\n                                                导出报告\n                                          </Button>\n                                    </div>\n                              </div>\n\n                              <div className=\"image-section\">\n                                    <div className=\"image-container\" style={\n                                          {\n                                                height: '100%',\n                                                width: '100%',\n                                                overflow: 'hidden'\n                                          }\n                                    }>\n                                          <div className=\"image-wrapper\"\n                                                onMouseEnter={() => setShowNavigation(true)}\n                                                onMouseLeave={() => {\n                                                      setShowNavigation(false);\n                                                      handleMouseLeave();\n                                                }}\n                                                onClick={handleImageWrapperClick}\n                                          >\n                                                {isCameraActive ? (\n                                                      // 摄像头模式保持不变\n                                                      <div\n                                                            ref={imageWrapperRef}\n                                                            className=\"image-scale-wrapper camera-active\"\n                                                            style={{\n                                                                  position: 'relative',\n                                                                  width: '100%',\n                                                                  height: '100%',\n                                                                  backgroundColor: '#000',\n                                                                  overflow: 'hidden'\n                                                            }}\n                                                      >\n                                                            {/* 视频元素 */}\n                                                            <video\n                                                                  ref={videoRef}\n                                                                  autoPlay\n                                                                  playsInline\n                                                                  muted\n                                                                  style={{\n                                                                        position: 'absolute',\n                                                                        top: 0,\n                                                                        left: 0,\n                                                                        width: '100%',\n                                                                        height: '100%',\n                                                                        objectFit: 'contain',\n                                                                        display: 'block',\n                                                                        zIndex: 10\n                                                                  }}\n                                                            />\n\n                                                            {/* 边界框层 */}\n                                                            <div\n                                                                  style={{\n                                                                        position: 'absolute',\n                                                                        top: 0,\n                                                                        left: 0,\n                                                                        width: '100%',\n                                                                        height: '100%',\n                                                                        pointerEvents: 'none',\n                                                                        zIndex: 20\n                                                                  }}\n                                                            >\n                                                                  {renderBoundingBoxes()}\n                                                            </div>\n\n                                                            {/* 检测状态指示 */}\n                                                            {isCapturing && (\n                                                                  <div\n                                                                        style={{\n                                                                              position: 'absolute',\n                                                                              top: 10,\n                                                                              right: 10,\n                                                                              backgroundColor: 'rgba(24, 144, 255, 0.8)',\n                                                                              color: 'white',\n                                                                              padding: '4px 8px',\n                                                                              borderRadius: '4px',\n                                                                              fontSize: '12px',\n                                                                              zIndex: 30\n                                                                        }}\n                                                                  >\n                                                                        实时检测中...\n                                                                  </div>\n                                                            )}\n                                                      </div>\n                                                ) : selectedImage ? (\n                                                      <>\n                                                            <div\n                                                                  ref={imageWrapperRef}\n                                                                  className=\"image-scale-wrapper\"\n                                                                  onMouseDown={handleMouseDown}\n                                                                  onMouseMove={handleMouseMove}\n                                                                  onMouseUp={handleMouseUp}\n                                                                  onMouseLeave={handleMouseLeave}\n                                                                  onWheel={handleWheel}\n                                                                  style={{\n                                                                        cursor: isDragging ? 'grabbing' : 'grab',\n                                                                        position: 'relative',\n                                                                        width: imageDimensions?.width || 'auto',\n                                                                        height: imageDimensions?.height || 'auto',\n                                                                        maxWidth: '600px',\n                                                                        maxHeight: '600px'\n                                                                  }}\n                                                            >\n                                                                  {/* 使用相对定位，并在transform中应用缩放和平移 */}\n                                                                  <div style={{\n                                                                        position: 'relative',\n                                                                        width: '100%',\n                                                                        height: '100%',\n                                                                        transform: `scale(${scale}) translate(${position.x / scale}px, ${position.y / scale}px)`,\n                                                                        transformOrigin: 'center',\n                                                                        transition: isDragging ? 'none' : 'transform 0.1s ease',\n                                                                  }}>\n                                                                        <img\n                                                                              src={selectedImage}\n                                                                              alt=\"PCB\"\n                                                                              style={{\n                                                                                    width: '100%',\n                                                                                    height: '100%',\n                                                                                    objectFit: 'contain',\n                                                                                    userSelect: 'none'\n                                                                              }}\n                                                                              draggable={false}\n                                                                        />\n                                                                        {/* 边界框相对于图像定位 */}\n                                                                        {renderBoundingBoxes()}\n                                                                  </div>\n                                                            </div>\n                                                            {imageList.length > 1 && showNavigation && (\n                                                                  <div className=\"image-navigation\">\n                                                                        <Button\n                                                                              icon={<LeftOutlined />}\n                                                                              onClick={handlePrevImage}\n                                                                              disabled={currentImageIndex === 0}\n                                                                        />\n                                                                        <Button\n                                                                              icon={<RightOutlined />}\n                                                                              onClick={handleNextImage}\n                                                                              disabled={currentImageIndex === imageList.length - 1}\n                                                                        />\n                                                                  </div>\n                                                            )}\n                                                      </>\n                                                ) : (\n                                                      <div className=\"upload-placeholder\">\n                                                            <Upload\n                                                                  accept=\"image/*\"\n                                                                  showUploadList={false}\n                                                                  beforeUpload={handleImageUpload} // 处理单个图片上传\n                                                                  onDrop={(e) => {\n                                                                        const file = e.dataTransfer.files[0];\n                                                                        if (file) {\n                                                                              handleImageUpload(file);\n                                                                        }\n                                                                  }}\n                                                            >\n                                                                  <div style={{ textAlign: 'center', cursor: 'pointer' }}>\n                                                                        <UploadOutlined style={{ fontSize: '24px', marginBottom: '8px' }} />\n                                                                        <p>点击或拖拽上传图片</p>\n                                                                  </div>\n                                                            </Upload>\n                                                      </div>\n                                                )}\n                                          </div>\n                                          <div className=\"detection-progress\">\n                                                <span>检测进度:</span>\n                                                <div style={{\n                                                      display: 'flex',\n                                                      alignItems: 'center',\n                                                      marginTop: '5px',\n                                                      gap: '10px'\n                                                }}>\n                                                      <div style={{ flex: 1, position: 'relative' }}>\n                                                            <Progress\n                                                                  percent={detectionProgress}\n                                                                  showInfo={false}\n                                                            />\n                                                      </div>\n                                                      <span style={{\n                                                            fontSize: '14px',\n                                                            color: '#1890ff',\n                                                            fontWeight: '500'\n                                                      }}>\n                                                            {detectionProgress}%\n                                                      </span>\n                                                </div>\n                                          </div>\n                                          {imageList.length > 1 && (\n                                                <div className=\"image-pagination\">\n                                                      <Pagination\n                                                            current={currentImageIndex + 1}\n                                                            total={imageList.length}\n                                                            pageSize={1}\n                                                            onChange={handlePageChange}\n                                                            size=\"small\"\n                                                            showQuickJumper\n                                                            showSizeChanger={false}\n                                                      />\n                                                </div>\n                                          )}\n                                    </div>\n                              </div>\n\n                              <div className=\"results-section\" >\n                                    <div className=\"results-header\">\n                                          <h2>检测结果</h2>\n                                          <Select\n                                                style={{ width: '100%', marginTop: '8px' }}\n                                                value={defectFilter}\n                                                onChange={handleDefectFilterChange}\n                                          >\n                                                {defectTypes.map(type => (\n                                                      <Select.Option key={type} value={type}>\n                                                            {type === 'all' ? '全部缺陷' : type}\n                                                      </Select.Option>\n                                                ))}\n                                          </Select>\n                                    </div>\n                                    {/* 检测结果列表部分 */}\n                                    <div\n                                          className=\"defects-container\"\n                                          style={{\n                                                height: '350px', // 固定高度\n                                                overflow: 'auto',\n                                                marginBottom: '16px',\n                                          }}\n                                    >\n                                          <div\n                                                className=\"defects-list\"\n                                                ref={defectsListRef}\n                                          >\n                                                {processedResults.length > 0 ? (\n                                                      processedResults.map((defect, index) => (\n                                                            <div key={index} className=\"defect-item\">\n                                                                  <div className=\"defect-info\">\n                                                                        <h4><span className=\"label-width\">类别:</span> {defect.type}</h4>\n                                                                        {defect.bbox && (\n                                                                              <p className=\"coordinates-info\">\n                                                                                    <span className=\"coord-row\">\n                                                                                          <span className=\"label-width\">坐标:</span>\n                                                                                          <span className=\"coord-pair\">x1={defect.bbox.x1}</span>\n                                                                                          <span className=\"coord-pair\">y1={defect.bbox.y1}</span>\n                                                                                    </span>\n                                                                                    <span className=\"coord-row\">\n                                                                                          <span className=\"label-width\"></span>\n                                                                                          <span className=\"coord-pair\">x2={defect.bbox.x2}</span>\n                                                                                          <span className=\"coord-pair\">y2={defect.bbox.y2}</span>\n                                                                                    </span>\n                                                                              </p>\n                                                                        )}\n                                                                        {defect.confidence && <p><span className=\"label-width\">置信度:</span> {defect.confidence}%</p>}\n                                                                  </div>\n                                                            </div>\n                                                      ))\n                                                ) : (\n                                                      <div className=\"defect-item empty-defect\">\n                                                            <div className=\"defect-info\">\n                                                                  <h4>暂无检测结果</h4>\n                                                                  <p>开始检测后将在此显示详细信息</p>\n                                                            </div>\n                                                      </div>\n                                                )}\n                                          </div>\n                                    </div>\n                                    {/* 饼图和图例部分 */}\n                                    <div className=\"statistics-section\" style={{ flex: '2', minHeight: '300px', display: 'flex', flexDirection: 'column' }}>\n                                          {detectionResults.statistics.defect_types && Object.keys(detectionResults.statistics.defect_types).length > 0 ? (\n                                                <ReactECharts\n                                                      option={getChartOption()}\n                                                      style={{ height: '100%', flex: 1 }}\n                                                      notMerge={true}\n                                                />\n                                          ) : (\n                                                <div style={{\n                                                      display: 'flex',\n                                                      flexDirection: 'column',\n                                                      justifyContent: 'center',\n                                                      alignItems: 'center',\n                                                      height: '100%',\n                                                      color: '#aaa'\n                                                }}>\n                                                      <p style={{ margin: 0 }}>检测完成后将在此显示统计数据</p>\n                                                      <p style={{ margin: 0 }}>\n                                                            可检测: 鼠咬, 开路, 短路, 毛刺和杂铜等\n                                                      </p>\n                                                </div>\n                                          )}\n                                    </div>\n                              </div>\n\n                              <div className=\"model-section\">\n                                    <div className=\"model-header\">\n                                          <h2>模型管理</h2>\n                                          <Select\n                                                value={selectedModel}\n                                                onChange={handleModelChange}\n                                                style={{ width: '100%' }}\n                                          >\n                                                <Select.Option value=\"yolov11\">Yolov11</Select.Option>\n                                                <Select.Option value=\"yolov11-vote2\">Yolov11-vote2</Select.Option>\n                                                <Select.Option value=\"yolov11-vote4\">Yolov11-vote4</Select.Option>\n                                          </Select>\n                                    </div>\n                                    <div className=\"metrics\">\n                                          <div className=\"metric-item\">\n                                                <span>Precision</span>\n                                                <span className=\"metric-value\">\n                                                      {selectedModel === 'yolov11' ? '97.72%' :\n                                                            selectedModel === 'yolov11-vote2' ? '97.45%' :\n                                                                  '96.99%'}\n                                                </span>\n                                          </div>\n                                          <div className=\"metric-item\">\n                                                <span>Recall</span>\n                                                <span className=\"metric-value\">\n                                                      {selectedModel === 'yolov11' ? '84.41%' :\n                                                            selectedModel === 'yolov11-vote2' ? '85.97%' :\n                                                                  '87.32%'}\n                                                </span>\n                                          </div>\n                                          <div className=\"metric-item\">\n                                                <span>mAP@0.5</span>\n                                                <span className=\"metric-value\">\n                                                      {selectedModel === 'yolov11' ? '92.39%' :\n                                                            selectedModel === 'yolov11-vote2' ? '93.02%' :\n                                                                  '93.58%'}\n                                                </span>\n                                          </div>\n                                          <div className=\"metric-item\">\n                                                <span>mAP@0.5:0.95</span>\n                                                <span className=\"metric-value\">\n                                                      {selectedModel === 'yolov11' ? '68.18%' :\n                                                            selectedModel === 'yolov11-vote2' ? '69.20%' :\n                                                                  '69.49%'}\n                                                </span>\n                                          </div>\n                                    </div>\n                                    <div className=\"threshold-settings\">\n                                          <h3>阈值设置</h3>\n                                          <div className=\"threshold-item\">\n                                                <span>IoU 阈值</span>\n                                                <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                                                      {/* 左侧显示当前值并支持用户输入 */}\n                                                      <div className=\"custom-input-number\">\n                                                            <InputNumber\n                                                                  min={0.1}\n                                                                  max={1.0}\n                                                                  step={0.01}\n                                                                  value={iouThreshold}\n                                                                  onChange={(value) => setIouThreshold(value || 0.1)} // 防止输入为空\n                                                                  style={{ width: '80px' }}\n                                                                  controls={false}\n                                                                  className=\"threshold-input\"\n                                                            />\n                                                            <div className=\"custom-controls\">\n                                                                  <div className=\"control-up\" onClick={() => {\n                                                                        const newValue = parseFloat((iouThreshold + 0.01).toFixed(2));\n                                                                        if (newValue <= 1.0) setIouThreshold(newValue);\n                                                                  }}>\n                                                                        <div className=\"control-icon\">+</div>\n                                                                  </div>\n                                                                  <div className=\"control-down\" onClick={() => {\n                                                                        const newValue = parseFloat((iouThreshold - 0.01).toFixed(2));\n                                                                        if (newValue >= 0.1) setIouThreshold(newValue);\n                                                                  }}>\n                                                                        <div className=\"control-icon\">-</div>\n                                                                  </div>\n                                                            </div>\n                                                      </div>\n                                                      {/* 右侧滑动条 */}\n                                                      <Slider\n                                                            min={0.1}\n                                                            max={1.0}\n                                                            step={0.01}\n                                                            value={iouThreshold}\n                                                            onChange={(value) => setIouThreshold(value)}\n                                                            tooltip={{ formatter: (value) => `IoU: ${value.toFixed(2)}` }}\n                                                            style={{ flex: 1 }}\n                                                      />\n                                                </div>\n                                          </div>\n                                          <div className=\"threshold-item\">\n                                                <span>置信度阈值</span>\n                                                <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                                                      {/* 左侧显示当前值并支持用户输入 */}\n                                                      <div className=\"custom-input-number\">\n                                                            <InputNumber\n                                                                  min={0.1}\n                                                                  max={1.0}\n                                                                  step={0.01}\n                                                                  value={confThreshold}\n                                                                  onChange={(value) => setConfThreshold(value || 0.1)} // 防止输入为空\n                                                                  style={{ width: '80px' }}\n                                                                  controls={false}\n                                                                  className=\"threshold-input\"\n                                                            />\n                                                            <div className=\"custom-controls\">\n                                                                  <div className=\"control-up\" onClick={() => {\n                                                                        const newValue = parseFloat((confThreshold + 0.01).toFixed(2));\n                                                                        if (newValue <= 1.0) setConfThreshold(newValue);\n                                                                  }}>\n                                                                        <div className=\"control-icon\">+</div>\n                                                                  </div>\n                                                                  <div className=\"control-down\" onClick={() => {\n                                                                        const newValue = parseFloat((confThreshold - 0.01).toFixed(2));\n                                                                        if (newValue >= 0.1) setConfThreshold(newValue);\n                                                                  }}>\n                                                                        <div className=\"control-icon\">-</div>\n                                                                  </div>\n                                                            </div>\n                                                      </div>\n                                                      {/* 右侧滑动条 */}\n                                                      <Slider\n                                                            min={0.1}\n                                                            max={1.0}\n                                                            step={0.01}\n                                                            value={confThreshold}\n                                                            onChange={(value) => setConfThreshold(value)}\n                                                            tooltip={{ formatter: (value) => `Conf: ${value.toFixed(2)}` }}\n                                                            style={{ flex: 1 }}\n                                                      />\n                                                </div>\n                                          </div>\n                                    </div>\n                              </div>\n                        </div>\n                  </Layout>\n            </Layout>\n      );\n}\n\nexport default App","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport 'antd/dist/antd.css';\r\n\r\nReactDOM.render(\r\n      <React.StrictMode>\r\n            <App />\r\n      </React.StrictMode>,\r\n      document.getElementById('root')\r\n);"],"sourceRoot":""}